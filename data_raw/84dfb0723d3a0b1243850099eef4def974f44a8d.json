{
    "paper_id": "84dfb0723d3a0b1243850099eef4def974f44a8d",
    "metadata": {
        "title": "Mapping the drivers of within-host pathogen evolution using massive data sets: Supplementary Information",
        "authors": [
            {
                "first": "Palmer",
                "middle": [],
                "last": "",
                "suffix": "",
                "affiliation": {},
                "email": "duncan.stuart.palmer@gmail.com"
            }
        ]
    },
    "abstract": [
        {
            "text": "We perform inference via Markov chain Monte-Carlo (MCMC) using the Li and Stephens approximation to the coalescent with recombination [1], with one further key approximation. Consider two data sets:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Abstract"
        }
    ],
    "body_text": [
        {
            "text": "1. D = viral sequences for which host HLA data is also available.",
            "cite_spans": [],
            "ref_spans": [],
            "section": ""
        },
        {
            "text": "2. D B = viral sequences for which host HLA data is not available.",
            "cite_spans": [],
            "ref_spans": [],
            "section": ""
        },
        {
            "text": "As D B is very large, we can assume that D B represents the collection of viral sequences (subject to recombination) that a host can be infected with. A large number of sequences in D B results in short coalescence times between any given member of D and D B , increasing our power to estimate parameters. By making this approximation, we may then assume that selection along the lineage joining a given member d of D to its nearest neighbour in D B occurred within the individual from whom the virus d was sampled. We have associated host HLA profiles for D, and so may then estimate HLA-associated selection conditional on this HLA information. A cartoon of this model is shown in Figure 1b .",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 683,
                    "end": 692,
                    "text": "Figure 1b",
                    "ref_id": "FIGREF0"
                }
            ],
            "section": ""
        },
        {
            "text": "The Li and Stephens approximation allows us to evaluate the probability that a member of D arises as an imperfect mosaic of sequences in D B using a hidden Markov model (HMM). To model this process, we must specify a recombination model, and model of sequence evolution. We assume that recombination is site dependent, and occurs with probability r i between site i \u2212 1 and i to any other member of D B uniformly at random. We model sequence change using the NY98 codon model [2] (which distinguishes transitions from transversions via the transition/transversion ratio; \u03ba, and nonsynonymous changes from synonymous changes via the dN dS ratio; \u03c9), with some modifications. To incorporate HLA-associated selection for escape, we define a consensus non-escaped strain C for the region to be analysed. A scaling, h\u2208H \u03b3 h,i , dependent on the host's HLA profile, H, then modifies any non-synonymous codon change from this consensus strain. We model reversion in a similar manner: a boost in codon substitution rate towards the consensus codon C at each site, \u03b6 i . Note that reversion only acts on non-synonymous changes toward the consensus codon C , and as such the parameterisation is identifiable. To switch from rates to probabilities we integrate over the length of a lineage connecting a member of D to D B assuming a standard coalescent. For example for a non-synonymous transition from C i to some codon C,",
            "cite_spans": [
                {
                    "start": 4,
                    "end": 10,
                    "text": "Li and",
                    "ref_id": null
                },
                {
                    "start": 476,
                    "end": 479,
                    "text": "[2]",
                    "ref_id": "BIBREF1"
                }
            ],
            "ref_spans": [],
            "section": ""
        },
        {
            "text": "where \u03c6 is the empirically estimated probability of observing a single codon change along the lineage joining D to D B , A is the total codon substitution rate out of C i , a i is the number of non-synonymous transitions from C i , k is the number of sequences in D B and \u03c0 C is the empirical probability of observing C given a \u2265 2 step codon change. We approximate the probability in this manner to avoid computationally expensive matrix exponentiation. Given recombination probabilities and codon transition probabilities for all possible codon changes and the Li and Stephens approximation, we are armed with an HMM to describe an approximation to the process generating members of D. We can therefore use the forwards and backwards algorithms to integrate over all paths through D B to generate each member of D in turn. We then take the product over all members of D to approximate the likelihood:",
            "cite_spans": [
                {
                    "start": 563,
                    "end": 569,
                    "text": "Li and",
                    "ref_id": null
                }
            ],
            "ref_spans": [],
            "section": ""
        },
        {
            "text": "where H denotes HLA information (across members of D and D B ), H j is the collection of HLA types of the host associated to viral sample D j \u2208 D, and\u03c0 is the function describing the Li and Stephens approximation with our model of recombination and codon evolution.",
            "cite_spans": [
                {
                    "start": 183,
                    "end": 189,
                    "text": "Li and",
                    "ref_id": null
                }
            ],
            "ref_spans": [],
            "section": ""
        },
        {
            "text": "Evaluating D j \u2208D\u03c0 (D j |D B , H j , \u0398) in practice becomes computationally difficult as D B increases in size, as it involves the evaluation of arrays of dimension |D B | \u00d7 |D| \u00d7 |codon sequence|. To increase computational efficiency, we restrict D B to a subset D B j for each member of D. In our simulations and analyses we use a simple Hamming distance restriction: the closest n sequences by Hamming distance to define each D B j . Now that we are able to evaluate approximate likelihoods rapidly, we can perform MCMC to obtain posterior distributions for our parameters of interest:",
            "cite_spans": [],
            "ref_spans": [],
            "section": ""
        },
        {
            "text": "\u2022 dN dS at each site, \u03c9 i . \u2022 HLA-associated selection at each site, \u03b3 h,i .",
            "cite_spans": [],
            "ref_spans": [],
            "section": ""
        },
        {
            "text": "\u2022 Recombination probabilities between neighbouring sites, r i .",
            "cite_spans": [],
            "ref_spans": [],
            "section": ""
        },
        {
            "text": "\u2022 Synonymous transversion rate, \u00b5.",
            "cite_spans": [],
            "ref_spans": [],
            "section": ""
        },
        {
            "text": "We use the Li and Stephens [1] approximation, as it captures many of the properties of the coalescent with recombination in a computationally efficient manner. We describe the approximation and explain our modifications.",
            "cite_spans": [
                {
                    "start": 27,
                    "end": 30,
                    "text": "[1]",
                    "ref_id": "BIBREF0"
                }
            ],
            "ref_spans": [],
            "section": "The Li and Stephens approximation and the forwards-backwards algorithms"
        },
        {
            "text": "Let \u0398 denote a collection of parameters governing codon substitution and let D = {D 1 , D 2 , . . . , D n } denote a collection of sequences from n samples. The approximation follows from observing that the likelihood P (D 1 , D 2 , . . . , D n |\u0398) may be written as a product of conditional likelihoods, each of which is then approximated by a function which we denote\u03c0. I.e.: P (D 1 , D 2 , . . . , D n |\u0398) = P (D 1 |\u0398)P (D 2 |D 1 , \u0398) . . . P (D n |D 1 , D 2 , . . . , D n\u22121 , \u0398)",
            "cite_spans": [],
            "ref_spans": [],
            "section": "The Li and Stephens approximation and the forwards-backwards algorithms"
        },
        {
            "text": "(3) \u2248\u03c0(D 1 |\u0398)\u03c0(D 2 |D 1 , \u0398) . . .\u03c0(D n |D 1 , D 2 , . . . , D n\u22121 , \u0398).",
            "cite_spans": [],
            "ref_spans": [],
            "section": "The Li and Stephens approximation and the forwards-backwards algorithms"
        },
        {
            "text": "The right hand side of (4) is known as the product of approximate conditionals (PAC) likelihood as each conditional likelihood P (D k+1 |D 1 , D 2 , . . . , D k , \u0398) is approximated using the function\u03c0. Li and Stephens [1] use a hidden Markov model (HMM) for\u03c0 that captures a collection of desirable properties of the true likelihood function, but is computationally tractable, because that the (k + 1) th sequence is an imperfect mosaic of the first k sequences due to mutation and recombination. For the (k + 1) th sequence, the hidden states are the first k sequences. We denote X 1 , X 2 , . . . , X m as the hidden Markov chain that emits the sequence D k+1 , where X j is the sequence being copied from (SCF) at position j and m is the length of the sequence. Between each site, the SCF switches to a new sequence l with probability q x,i (j) (which may depend on the current SCF; x, the new SCF; i, and the current site; j). Given a hidden state at position j, the probability of observing the codon in the observed sequence D k+1 is generated by a model of codon substitution. To generate\u03c0(D k+1 |D 1 , D 2 , . . . , D k , \u0398) we integrate over all possible paths through sequences D 1 , D 2 , . . . , D k that can generate the sequence D k+1 through a combination of jumping between these k sequences (recombination) and error in copying (mutation), as illustrated in Figure 1b .",
            "cite_spans": [
                {
                    "start": 203,
                    "end": 209,
                    "text": "Li and",
                    "ref_id": null
                },
                {
                    "start": 219,
                    "end": 222,
                    "text": "[1]",
                    "ref_id": "BIBREF0"
                }
            ],
            "ref_spans": [
                {
                    "start": 1376,
                    "end": 1385,
                    "text": "Figure 1b",
                    "ref_id": "FIGREF0"
                }
            ],
            "section": "The Li and Stephens approximation and the forwards-backwards algorithms"
        },
        {
            "text": "As the approximation to the process generating sequence D k is an HMM, we can appeal to the forwards and backwards algorithms [3] to evaluate\u03c0(D k+1 |D 1 , D 2 , . . . , D k , \u0398) for each k. The forwards algorithm proceeds as follows:",
            "cite_spans": [
                {
                    "start": 126,
                    "end": 129,
                    "text": "[3]",
                    "ref_id": "BIBREF2"
                }
            ],
            "ref_spans": [],
            "section": "The Li and Stephens approximation and the forwards-backwards algorithms"
        },
        {
            "text": "Let D k+1 [1 : j] denote the codons at the first j sites of sequence k +1 and let f i,j denote the probability of observing all codons in D k+1 up to site j \u2212 1 and copying the codon in position j from sequence i.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "The Li and Stephens approximation and the forwards-backwards algorithms"
        },
        {
            "text": ". Let the probability of copying the codon at position j from sequence i be denoted \u03b5 i,j . This is the probability of an observed state given a hidden state, and is known as an emission probability in the language of HMMs. Then f i,1 is just an emission probability and easily computed if we have a uniform prior on the SCF at the first position. We then calculate f i,j for j \u2265 2 recursively as follows:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "The Li and Stephens approximation and the forwards-backwards algorithms"
        },
        {
            "text": "where, as defined earlier, q x,i (j) is the combined probability of recombination and the destination sequence being sequence i. Note that we make the implicit assumption that recombination events may only occur between codons and not within them. If we assume that all sequences are equally likely to recombine (as in [1] and [4] ) then (5) may be simplified to",
            "cite_spans": [
                {
                    "start": 319,
                    "end": 322,
                    "text": "[1]",
                    "ref_id": "BIBREF0"
                },
                {
                    "start": 327,
                    "end": 330,
                    "text": "[4]",
                    "ref_id": "BIBREF3"
                }
            ],
            "ref_spans": [],
            "section": "The Li and Stephens approximation and the forwards-backwards algorithms"
        },
        {
            "text": "where r j is the probability of recombination between the (j \u2212 1) th and j th position.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "The Li and Stephens approximation and the forwards-backwards algorithms"
        },
        {
            "text": "For the (k + 1) th sequence,\u03c0",
            "cite_spans": [],
            "ref_spans": [],
            "section": "The Li and Stephens approximation and the forwards-backwards algorithms"
        },
        {
            "text": "We may similarly run the backwards algorithm, starting at the last site and evaluating iteratively towards the first site. Let D k",
            "cite_spans": [],
            "ref_spans": [],
            "section": "The Li and Stephens approximation and the forwards-backwards algorithms"
        },
        {
            "text": "where the last implication is a consequence of the Markov property. The b i,j s for the (k +1) th sequence can then be generated iteratively as follows",
            "cite_spans": [],
            "ref_spans": [],
            "section": "The Li and Stephens approximation and the forwards-backwards algorithms"
        },
        {
            "text": "Hence we can calculate",
            "cite_spans": [],
            "ref_spans": [],
            "section": "The Li and Stephens approximation and the forwards-backwards algorithms"
        },
        {
            "text": "Note that the approximation of P (D 1 , D 2 , . . . , D n |\u0398) using this HMM is dependent upon the ordering of {D 1 , D 2 , . . . , D k }. This is often resolved by randomly permuting the ordering some fixed number of times and determining an average [4] , or by letting the order be an unknown parameter [5] . Here we remove the ordering issue by considering each query sample independently.",
            "cite_spans": [
                {
                    "start": 251,
                    "end": 254,
                    "text": "[4]",
                    "ref_id": "BIBREF3"
                },
                {
                    "start": 305,
                    "end": 308,
                    "text": "[5]",
                    "ref_id": "BIBREF4"
                }
            ],
            "ref_spans": [],
            "section": "The Li and Stephens approximation and the forwards-backwards algorithms"
        },
        {
            "text": "In our inference problem we have two data sets. One query data set; D for which we have associated host HLA information and another larger reference data set; D B without host HLA information. Recall from our model summary that we make two important assumptions:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "The Li and Stephens approximation and the forwards-backwards algorithms"
        },
        {
            "text": "1. All selection along the lineages connecting a member of D to D B occurred within the host of the member of D.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "The Li and Stephens approximation and the forwards-backwards algorithms"
        },
        {
            "text": "2. The reference data set D B is a good approximation of the distribution of viruses an individual can be infected with (which is reasonable when |D B | 0).",
            "cite_spans": [],
            "ref_spans": [],
            "section": "The Li and Stephens approximation and the forwards-backwards algorithms"
        },
        {
            "text": "These two assumptions allow us to apply the Li and Stephens approximation. In the HMM we require emission probabilities. For our model these will be probabilities of codon substitutions in the presence of some HLA profile. Making assumption 1 allows us to approximate P (D|D B , \u0398). This is because we have HLA genotype information for the members of D = {D 1 , D 2 , . . . , D n } which we can use to determine the relevant emission probabilities. I.e. The first assumption allows us to use the sequence data in D B :",
            "cite_spans": [],
            "ref_spans": [],
            "section": "The Li and Stephens approximation and the forwards-backwards algorithms"
        },
        {
            "text": "Using assumption 2, we may write",
            "cite_spans": [],
            "ref_spans": [],
            "section": "The Li and Stephens approximation and the forwards-backwards algorithms"
        },
        {
            "text": "In other words, assumption 2 results in the approximation that D is generated by independent realisations of recombination and mutation through D B . This avoids any need for averaging over orderings of D, allowing rapid evaluation of the approximate likelihood.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "The Li and Stephens approximation and the forwards-backwards algorithms"
        },
        {
            "text": "Within the MCMC, we have three main classes of move. Moves to alter a parameter at a single site or window of sites, moves to merge or split windows, and moves to expand and contract selection windows to push them around the genome. When adding HLA-associated selection to our codon model of substitution, we considered separate parameters to scale selection away from consensus in the presence of each host HLA type at each site (\u03b3 h,i ), and parameters to model reversion towards consensus at each site (\u03b6 i ). In order to increase speed we alter these parameters within selection windows in our MCMC scheme. The selection windows that we discuss are analogous to the selection windows and recombination windows described in [4] . We now introduce some notation:",
            "cite_spans": [
                {
                    "start": 727,
                    "end": 730,
                    "text": "[4]",
                    "ref_id": "BIBREF3"
                }
            ],
            "ref_spans": [],
            "section": "MCMC moves"
        },
        {
            "text": "Let S := {s 1 , s 2 , . . . , s S } be a collection of sites that split windows, and let |S| = S. We may then alter parameters occurring within selection windows [s k , s k+1 ), s k \u2208 S \u222a {1, l} (defining s 0 = 1, s S+1 = l). The number of selection windows is S + 1, and parameters are constant across these windows.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "MCMC moves"
        },
        {
            "text": "For recombination and selection, the parameters r i and \u03c9 i are estimated between each pair of neighbouring sites (i \u2212 1, i), and at each site i respectively. For HLA associated selection and reversion parameter changes, moves are applied to a window of these parameters. Note, for each HLA type h we assign a distinct collection of selection windows.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "MCMC moves"
        },
        {
            "text": "Selection parameters \u03c9 i . We only use a single type of MCMC move to alter \u03c9 i across the codon sequence: changing \u03c9 i at a given site i. We assume an exponential prior with parameter \u03bb \u03c9 for \u03c9 i . Following the existing model [4] , a new value \u03c9 i is chosen such that \u03c9 i = \u03c9 i exp(U ), where U \u223c Uniform(\u22121, 1) and the acceptance probability is",
            "cite_spans": [
                {
                    "start": 227,
                    "end": 230,
                    "text": "[4]",
                    "ref_id": "BIBREF3"
                }
            ],
            "ref_spans": [],
            "section": "MCMC moves"
        },
        {
            "text": "\u21d2 \u03b1 \u03c9 (\u0398 \u2192 \u0398 ) = min 1,",
            "cite_spans": [],
            "ref_spans": [],
            "section": "MCMC moves"
        },
        {
            "text": "Here, L(\u0398|D) is the likelihood of \u0398 given the data, P (x) is the prior on x, and q(x \u2192 x ) is the proposal distribution. The MCMC move to alter \u00b5 is identical.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "MCMC moves"
        },
        {
            "text": "A truncated normal, gamma, or uniform prior can also be chosen as a prior for \u03c9 i in our program.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "MCMC moves"
        },
        {
            "text": "Recombination Probabilities r i . Assuming independence between sites, and a distinct recombination rate at each site, we must vary r i for i \u2208 {2, 3, . . . , m}, where m is the number of codon sites in the sequence. We do this by perturbing the recombination rate at a given site in exactly the same way as for the selection parameters (\u03c9 i ) through a shift on the log scale. The recombination rate is related to the probability of recombination through the relation",
            "cite_spans": [],
            "ref_spans": [],
            "section": "MCMC moves"
        },
        {
            "text": "where \u03bd i is the recombination rate between sites i \u2212 1 and i, and k is the number of sequences. We allow moves to alter the recombination rate in the same way as the selection parameters, \u03c9 i . A new value \u03bd is chosen such that \u03bd = \u03bd exp(U ), where U \u223c Uniform(\u22121, 1). We have an exponential prior for \u03bd with rate parameter \u03bb \u03bd . The acceptance probability is identical to that of the selection parameters, with \u03c9 i and \u03bb \u03c9 replaced with \u03bd i and \u03bb \u03bd respectively.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "MCMC moves"
        },
        {
            "text": "Window Moves. Here, we consider only escape parameters (moves associated to reversion parameters are completely analogous) and for notational convenience we let \u03b3 h,i = \u03b3 i , and allow i to now enumerate windows rather than sites.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "MCMC moves"
        },
        {
            "text": "Moves are proposed in the same way as for selection parameters, \u03c9 i , but across a window rather than at a specific site. The window is chosen uniformly at random from the current collection of windows. We use a log-normal distribution, log N \u223c (0, \u03c3 2 \u03b3 ) for the prior on HLA dependent scaling of selection parameters, and the resulting acceptance ratio is",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Changes of selection parameters"
        },
        {
            "text": "2. Extension of a window in the 3 or 5 direction",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Changes of selection parameters"
        },
        {
            "text": "Choose a window to extend uniformly at random, with 5 or 3 direction chosen with equal probability. Choose the number of sites to extend g \u2208 [1, \u221e) from a geometric distribution. Any proposal that results in a window being merged is rejected, as is the proposal to extend the 5 -most or 3 -most block in the 5 or 3 direction respectively. Otherwise, the acceptance probability is",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Changes of selection parameters"
        },
        {
            "text": "These final two moves are complementary reversible jump MCMC moves. A site s * is chosen uniformly from the collection of available splitting sites, and with probability 1 splits an existing window, [s i , s i+1 ) say. New HLA dependent selection parameters within these new selection windows [s i , s * ) and [s * , s i+1 ) are defined as \u03b3 i 1 and \u03b3 i 2 where",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Split a window"
        },
        {
            "text": "It then follows that the acceptance ratio is",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Split a window"
        },
        {
            "text": "6 where c S := min 1, P (S + 1) P (S) and d S := min 1, P (S \u2212 1) P (S) (28) are the probability of proposing a split and merge move respectively when the current number of splitting sites is S.",
            "cite_spans": [
                {
                    "start": 72,
                    "end": 76,
                    "text": "(28)",
                    "ref_id": "BIBREF26"
                }
            ],
            "ref_spans": [],
            "section": "Split a window"
        },
        {
            "text": "Merge a window. Pick a splitting site s i+1 , i \u2208 {0, 1, . . . , S \u2212 1} at random to remove, resulting in a merge of windows [s i , s i+1 ) and [s i+1 , s i+2 ). Let",
            "cite_spans": [],
            "ref_spans": [],
            "section": "4."
        },
        {
            "text": "and accept with probability",
            "cite_spans": [],
            "ref_spans": [],
            "section": "4."
        },
        {
            "text": "A truncated Normal, Gamma, or uniform prior can also be chosen as a prior for the escape and reversion parameters in our software.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "4."
        },
        {
            "text": "As part of the burn in period during MCMC runs, we perform simulated annealing. This allows us to explore the parameter space as much as possible during these early stages. Doing so is very simple within an MCMC framework. At earlier steps in the MCMC the chain is 'hotter'. This simply means that the likelihood portion of the posterior carries less weight in the posterior and thus flattens the posterior density, allowing for greater exploration of the parameter space. We do this by raising the likelihood ratio to the power T where T > 1. Note that, as T \u2192 \u221e we are effectively sampling from the prior. We then let T be a function of the MCMC step t, such that T (t) \u2192 1 as t \u2192 \u221e. The functional form that we choose is",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Simulated annealing during burn-in"
        },
        {
            "text": "Note that T (0) = T 0 . We set \u03b1 = 0.999, and T 0 = 500.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Simulated annealing during burn-in"
        },
        {
            "text": "Six methods are applied to the sequence and HLA information simulated under 100 independent birth-death processes (described in the Methods subsection Simulation study 2: A sampled birth death process): 6. Our methodology as described in the Methods section of the main text.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Simulation study 2: methods comparison"
        },
        {
            "text": "In each case, we assume that the consensus 'wild type' strain is correctly defined and set any nonsynonymous difference from consensus as escape. For methods 2, 4 and 5, we determine a maximum likelihood estimate of the underlying genealogy using RAxML version 8.2.11 [11] . Methods 1, 3 and 6 do not require an estimate of the genealogy. We now briefly summarise each of the compared methods.",
            "cite_spans": [
                {
                    "start": 268,
                    "end": 272,
                    "text": "[11]",
                    "ref_id": "BIBREF10"
                }
            ],
            "ref_spans": [],
            "section": "Simulation study 2: methods comparison"
        },
        {
            "text": "Fisher's exact test A simple Fisher's exact test is applied by splitting the query sequences according to the following 2 \u00d7 2 contingency ",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Simulation study 2: methods comparison"
        },
        {
            "text": "where \u03bb esc and \u03bb esc , \u03b2, c and f HLA are estimates of the population escape and reversion rates, transmission probability, contact rate, and proportion of individuals in the population with the HLA type under investigation. \u039b 0 and \u039b 1 are the proportion of HLA mismatched hosts with an escape mutant at the investigated site, and proportion of HLA matched hosts with an escape mutant at the investigated site. We note that neither \u03b2 nor c are required to preserve the ordering of escape and reversion rates, and as such do not affect the associated ROC curves. The ordering is also preserved at the stationary phase [8] . In cases where the resultant escape or reversion rate estimate is negative, we set the escape rate estimate at zero under the assumption that the model does not fit the simulated data.",
            "cite_spans": [
                {
                    "start": 619,
                    "end": 622,
                    "text": "[8]",
                    "ref_id": "BIBREF7"
                }
            ],
            "ref_spans": [],
            "section": "Simulation study 2: methods comparison"
        },
        {
            "text": "PhyloD We implement the methods of Carlson et al. as described in [9] . As described above, we determine an estimate of the maximum likelihood tree, G max using RAxML [11] before using likelihood ratio tests to compare models conditional on the maximum likelihood tree. The initial null model at each site is a simple two state model described by two parameters -the mutation rate; \u03bb, and the stationary probability of observing the wild-type amino acid; \u03c0. The associated instantaneous rate matrix is",
            "cite_spans": [
                {
                    "start": 66,
                    "end": 69,
                    "text": "[9]",
                    "ref_id": "BIBREF8"
                },
                {
                    "start": 167,
                    "end": 171,
                    "text": "[11]",
                    "ref_id": "BIBREF10"
                }
            ],
            "ref_spans": [],
            "section": "Simulation study 2: methods comparison"
        },
        {
            "text": "Felsenstein's peeling algorithm [13] is then used to evaluate the likelihood L(\u03bb, \u03c0|D, G max ) and maximised, where D is the combination of simulated query sequences and associated host HLA data. So called 'leaf-distributions' are then potentially added using forward selection. This involves the inclusion of further hidden states -estimates of the transmitted sequence for each subsequently sampled member of the query sequences set. This transmitted sequence is then potentially modified conditional on the hosts' HLA. In the case of escape, the probability of an instantaneous switch from wild-type to escape is parameterised by a probability; p. Thus, given Q above for the remainder of the tree, and probabilities of switching between states between the hidden 'transmitted sequence' and the query sequences at the leaves, we can evaluate L(\u03bb, \u03c0, p|D, G max ) using tree peeling. Maximising this likelihood and comparing to the current null model, parameters are added if the p-value for the associated likelihood ratio test is lower than 0.05. Whereas in Carlson et al. maximum likelihood parameterisations are obtained by either coordinate descent [14] or expectation-maximisation [9] , we take a pragmatic approach, as often certain optimisation schemes fail under different scenarios. To this end, we simultaneously run six different optimisation schemes built into the optimx R package [15] : Nelder-Mead [16] , L-BFGS-B [17] , ucminf [18] , nmkb [19] , newuoa [20] , bobyqa [21] . We stipulate that at least two schemes must converge, and choose the likelihood parameterisation of the scheme with the highest likelihood. If less than two schemes converge, new starting parameters are chosen at random and estimates are re-evaluated.",
            "cite_spans": [
                {
                    "start": 32,
                    "end": 36,
                    "text": "[13]",
                    "ref_id": "BIBREF12"
                },
                {
                    "start": 1156,
                    "end": 1160,
                    "text": "[14]",
                    "ref_id": "BIBREF13"
                },
                {
                    "start": 1189,
                    "end": 1192,
                    "text": "[9]",
                    "ref_id": "BIBREF8"
                },
                {
                    "start": 1397,
                    "end": 1401,
                    "text": "[15]",
                    "ref_id": "BIBREF14"
                },
                {
                    "start": 1416,
                    "end": 1420,
                    "text": "[16]",
                    "ref_id": "BIBREF15"
                },
                {
                    "start": 1432,
                    "end": 1436,
                    "text": "[17]",
                    "ref_id": "BIBREF16"
                },
                {
                    "start": 1446,
                    "end": 1450,
                    "text": "[18]",
                    "ref_id": "BIBREF17"
                },
                {
                    "start": 1458,
                    "end": 1462,
                    "text": "[19]",
                    "ref_id": "BIBREF18"
                },
                {
                    "start": 1472,
                    "end": 1476,
                    "text": "[20]",
                    "ref_id": null
                },
                {
                    "start": 1486,
                    "end": 1490,
                    "text": "[21]",
                    "ref_id": "BIBREF20"
                }
            ],
            "ref_spans": [],
            "section": "Simulation study 2: methods comparison"
        },
        {
            "text": "PhyloD OR A slight modification of PhyloD, PhyloD OR also involves a simple alteration of the standard peeling algorithm, but instead of a 'leaf-distribution' being added at the leaves, a logistic regression is applied between the hidden transmitted states and the observed sequence data at the leaves -see Carlson et al. for some details [10] . Likelihoods can then be evaluated based on the probabilities associated to this logistic regression fit using a peeling algorithm [13] . E.g. Rearranging",
            "cite_spans": [
                {
                    "start": 339,
                    "end": 343,
                    "text": "[10]",
                    "ref_id": "BIBREF9"
                },
                {
                    "start": 476,
                    "end": 480,
                    "text": "[13]",
                    "ref_id": "BIBREF12"
                }
            ],
            "ref_spans": [],
            "section": "Simulation study 2: methods comparison"
        },
        {
            "text": "where P is the probability of observing an escape mutation, X i are binary variables taking the value 0 or 1 (for presence/absence of HLA i) depending on the HLA status of the host associated to a given leaf sequence. T is a further binary variable, which takes the value -1 if the state at the hidden transmitted state is wild-type, and 1 if it is escape. Given that these transmitted states are unknown, they are summed over using tree peeling. a i s and c are fitted using maximum likelihood optimisation schemes as for PhyloD. Following Carlson et al. we again use forward selection and likelihood ratio tests and add parameters to the model if p < 0.05.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Simulation study 2: methods comparison"
        },
        {
            "text": "Using each of the five methods described above, plus our new approach as described in detail in the methods section of the main text, we obtain p-values or parameter estimates which provide a metric for the strength of selection for escape at each site, conditional on each of the HLA types. We use the p-value, p-value, escape rate estimate, probability estimate, strength of selection; a i , and median HLA associated selection parameters; \u03b3 h for each of the six methods respectively to determine ROC curves for each of the 100 simulated sequence and host HLA data sets, displayed in Figure 2 of the main text. We also examined the effect of increasing the query sequence set with associated host HLA information to 3000. The resultant ROC curves for each of the five methods are shown in Supplementary Figure  7 .",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 587,
                    "end": 595,
                    "text": "Figure 2",
                    "ref_id": "FIGREF1"
                },
                {
                    "start": 806,
                    "end": 815,
                    "text": "Figure  7",
                    "ref_id": null
                }
            ],
            "section": "Simulation study 2: methods comparison"
        },
        {
            "text": "To examine the impact of a reduced reference data set D B upon parameter estimates, we subset to 100%, 10% and 1% of the reference sets in Simulation Study 2. We then performed inference and determined the impact of a smaller D B on the accuracy of our results. ROC curves for our method with different reference data sets sizes are shown in Supplementary Figure 8 .",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 342,
                    "end": 364,
                    "text": "Supplementary Figure 8",
                    "ref_id": "FIGREF5"
                }
            ],
            "section": "Simulation study 2: methods comparison"
        },
        {
            "text": "Drug associated selection analysis",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Query and reference data set preparation"
        },
        {
            "text": "All sequences and their associated host drug regime data were downloaded from the Stanford drug resistance database [22] . We used the alignments provided, though sites at which there was \u22655% ambiguity were removed, followed by sequences for which there was \u22655% nucleotide ambiguity across the region of interest. In reverse transcriptase a \u223c550 nucleotide region is sequenced much more frequently than the remainder of the gene and we wish to retain power to estimate parameters. One sequence per patient was included in the combined alignment of reference and query data sets by removing repeat entries of any given patient identifier uniformly at random (assuming unique patient identifiers \u21d2 unique patients).",
            "cite_spans": [
                {
                    "start": 116,
                    "end": 120,
                    "text": "[22]",
                    "ref_id": null
                }
            ],
            "ref_spans": [],
            "section": "Query and reference data set preparation"
        },
        {
            "text": "The data set was then split in two, sequences for which the host was not receiving any drugs D B , and sequences for which the host was receiving drugs D. 1,000 sequences were then randomly chosen from D B and placed in D. As described in the text, this step was included to guarantee variation within the query data set in drug associated selection. D B defines our reference data set. We perform some further data cleaning steps to create the query data set from D.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Query and reference data set preparation"
        },
        {
            "text": "Sequences were removed from D if RTI, NNRTI, NRTI or PI was used as a descriptor of one of the drugs in a patients drug regime, as this was not specific enough for our purposes. Finally, any sequences which were associated to a drug present in D fewer than 10 times were removed. Drug information associated to the query sequences was reformatted into a .csv file with binary entries so that it could be read by our program.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Query and reference data set preparation"
        },
        {
            "text": "The resulting collections of reference and query data sets consisted of 49,721 reference sequences and 6,130 query sequences with associated drug regime data for the protease data set, and 54,663 and 13,885 query sequences with associated drug regime data for the reverse transcriptase data set.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Query and reference data set preparation"
        },
        {
            "text": "To investigate HLA-associated selection was more cumbersome, we wished to incorporate as much data as was publicly available into our analyses. To achieve this, we focused on the most highly sequenced portions of the viral genome: protease and reverse transcriptase. To create the reference data sets we concentrated on three major sequence resources:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "HLA associated selection analysis"
        },
        {
            "text": "1. Los Alamos HIV sequence database.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "HLA associated selection analysis"
        },
        {
            "text": "2. Stanford Drug resistance database.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "HLA associated selection analysis"
        },
        {
            "text": "3. UCLA HIV positive selection mutation database.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "HLA associated selection analysis"
        },
        {
            "text": "Before filtering, the combination of these three databases represented a total of 119, 878 + 81, 533 + 45, 161 = 246, 572 and 148, 866 + 88, 780 + 45, 161 = 282, 807 sequences in protease and reverse transcriptase respectively. For the Los Alamos HIV sequence database portion of the reverse transcriptase reference data set, we allow sequence chunks of length >500 nucleotides.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "HLA associated selection analysis"
        },
        {
            "text": "To create the query data sets, we combined viral sequence data with associated host HLA information from the following sources (see also Table 1 in the main text):",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 137,
                    "end": 144,
                    "text": "Table 1",
                    "ref_id": null
                }
            ],
            "section": "HLA associated selection analysis"
        },
        {
            "text": "\u2022 Swiss Spanish intermittent treatment trial (SSITT) data set [23, 24] : Swiss portion of this data set.",
            "cite_spans": [
                {
                    "start": 62,
                    "end": 66,
                    "text": "[23,",
                    "ref_id": "BIBREF21"
                },
                {
                    "start": 67,
                    "end": 70,
                    "text": "24]",
                    "ref_id": "BIBREF22"
                }
            ],
            "ref_spans": [],
            "section": "HLA associated selection analysis"
        },
        {
            "text": "\u2022 Durban data set [25, 26] .",
            "cite_spans": [
                {
                    "start": 18,
                    "end": 22,
                    "text": "[25,",
                    "ref_id": "BIBREF23"
                },
                {
                    "start": 23,
                    "end": 26,
                    "text": "26]",
                    "ref_id": "BIBREF24"
                }
            ],
            "ref_spans": [],
            "section": "HLA associated selection analysis"
        },
        {
            "text": "\u2022 Mma Bana (mother and child) study [27] : adult portion of this study.",
            "cite_spans": [
                {
                    "start": 36,
                    "end": 40,
                    "text": "[27]",
                    "ref_id": "BIBREF25"
                }
            ],
            "ref_spans": [],
            "section": "HLA associated selection analysis"
        },
        {
            "text": "\u2022 Bloemfontein data set [28, 29] .",
            "cite_spans": [
                {
                    "start": 24,
                    "end": 28,
                    "text": "[28,",
                    "ref_id": "BIBREF26"
                },
                {
                    "start": 29,
                    "end": 32,
                    "text": "29]",
                    "ref_id": "BIBREF27"
                }
            ],
            "ref_spans": [],
            "section": "HLA associated selection analysis"
        },
        {
            "text": "\u2022 The short pulse antiretroviral therapy at seroconversion (SPARTAC) data set [30] : UK portion of this data set.",
            "cite_spans": [
                {
                    "start": 78,
                    "end": 82,
                    "text": "[30]",
                    "ref_id": "BIBREF28"
                }
            ],
            "ref_spans": [],
            "section": "HLA associated selection analysis"
        },
        {
            "text": "\u2022 All remaining sequences with associated host HLA data available in the Los Alamos HIV sequence database [31] which were not present in the above studies.",
            "cite_spans": [
                {
                    "start": 106,
                    "end": 110,
                    "text": "[31]",
                    "ref_id": null
                }
            ],
            "ref_spans": [],
            "section": "HLA associated selection analysis"
        },
        {
            "text": "In order to arrive at the final collection of reference and query sequences combined with HLA information we applied a number of filtering steps.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "HLA associated selection analysis"
        },
        {
            "text": "Creating the reference sequence data set.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "HLA associated selection analysis"
        },
        {
            "text": "1. Remove overlap between the Stanford drug resistance database and Los Alamos HIV sequence database: for any patient identifiers present in both databases, we remove all sequences corresponding to that patient from the Los Alamos database sequences.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Filtering steps"
        },
        {
            "text": "2. Remove sequences with associated host HLA information from both the Stanford drug resistance database and Los Alamos HIV sequence database sequences: this was achieved by comparing patient identifiers. The appropriate sequences were removed from the Stanford drug resistance database and Los Alamos HIV sequence database sequences.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Filtering steps"
        },
        {
            "text": "3. Remove repeat patient entries: again, this was achieved using patient identifiers. For any repeated patient identifier, one sequence was kept (chosen uniformly at random from among the sequences with the same patient identifier).",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Filtering steps"
        },
        {
            "text": "We next aligned the collection of sequences; a non-trivial task given the vast amount of sequence data. The alignment of protease in the Stanford drug resistance database is well maintained, so we assumed that this portion of the alignment is accurate. Note that this is why we remove the Los Alamos database copy where there is overlap between the Stanford drug resistance database and Los Alamos sequence databases. In the case of the sequences taken from the Los Alamos HIV sequence database, we find that attempting to generate an alignment when downloading \u223c70,000 sequences yields nonsensensical results. However, there is a lack of indels in the protease region. We therefore simply considered sequences of exactly 297 nucleotides for the alignment (after removal of gaps from the alignment proposed using the Los Alamos database default alignment software). Performing this step led to a loss of <500 sequences out of a total of \u223c70,000. We then checked the resulting distribution of nucleotides across the region. Finally, the UCLA positive selection database was assumed to be aligned correctly.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Sequence alignment"
        },
        {
            "text": "Such a simple alignment procedure was not available to us for the reverse transcriptase sequences due to the increased prevalence of indels within reverse transcriptase, coupled with the longer sequence length. We reduced the size of the collection of sequences to be aligned by assuming sequences taken from the Stanford drug resistance database were correctly aligned. Aligning all the remaining sequences at once using MUSCLE [32] was prohibitive computationally, as was using the align option in MUSCLE (which can be used to combine alignments: this procedure also tended to produce artefacts in the overall alignment). We therefore considered the approach of aligning subsets of 5000 sequences and comparing these sub-alignments. We found that although more common than within protease, indels are rare. Removing them resulted in a collection of sub-alignments that aligned with both each other and the consensus sequences for both the Stanford drug resistance database and UCLA positive selection database alignments.",
            "cite_spans": [
                {
                    "start": 429,
                    "end": 433,
                    "text": "[32]",
                    "ref_id": "BIBREF30"
                }
            ],
            "ref_spans": [],
            "section": "Sequence alignment"
        },
        {
            "text": "We removed ambiguous codons and sequences from both the protease and reverse transcriptase alignments by first deleting codons with > 5% ambiguity and then sequences with > 5% sequence ambiguity as in our data set prepartion for the drug associated selection analysis. Removal of sequence ambiguity resulted in a total of 162, 901 and 184, 817 reference sequences for protease and reverse transcriptase respectively.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Quality control"
        },
        {
            "text": "Creating the query data set",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Quality control"
        },
        {
            "text": "As in the reference sequence filtering step, we remove repeat patient entries using patient identifiers: For any repeated patient identifier, one sequence was kept (chosen uniformly at random from among the sequences with the same patient identifier).",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Filtering steps"
        },
        {
            "text": "We aligned the query sequences using MUSCLE [32] . We found that no gaps were introduced (aside from at the beginning and end of the sequences). Both the protease and reverse transcriptase query sequences align with their respective reference sequence data sets.",
            "cite_spans": [
                {
                    "start": 44,
                    "end": 48,
                    "text": "[32]",
                    "ref_id": "BIBREF30"
                }
            ],
            "ref_spans": [],
            "section": "Sequence alignment"
        },
        {
            "text": "We checked ambiguity of codons and sequences within the query data sets using the same criteria as in our reference data set preparation, removing codon positions and sequences as required.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Quality control"
        },
        {
            "text": "Throughout, HLA typing was restricted to two digits and HLA-A, B, and C alleles were analysed jointly. We truncated to two-digits in the interests of power: although the most common 4 digit HLAs could be considered separately, the majority are rare at 4 digit resolution in our data set (60.5% of 4-digit HLAs have a count of < 10, compared to 30.2% at 2-digit resolution). Moreover, 27.3% of the individuals were only typed at 2-digit resolution. However, this should be feasible in the future as sample sizes of viral sequence data with associated host HLA types increase.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Quality control"
        },
        {
            "text": "In both the query and reference data sets after filtering we obtain a relatively constant sequence ambiguity across the newly defined regions of protease and reverse transcriptase, with slight increases at the start and end of the region as we would expect. Consensus nucleotide proportion across both newly defined regions averaged across all sites is 0.941 and 0.943 for protease and reverse transcriptase respectively, with any large drop below this coinciding with a subtype B/C consensus sequence difference at the nucleotide level.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Quality control"
        },
        {
            "text": "The resulting cleaned data sets consist of:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Quality control"
        },
        {
            "text": "\u2022 A reference data set D B consisting of sequences taken from Los Alamos sequence database, the Stanford Drug resistance database and the UCLA positive selection database for which no host HLA information was available.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Quality control"
        },
        {
            "text": "\u2022 A query data set which consists of:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Quality control"
        },
        {
            "text": "1. Viral sequence data D.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Quality control"
        },
        {
            "text": "2. Host 2 digit HLA genotype data H for the three HLA class I alleles associated to the viral sequences in D.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Quality control"
        },
        {
            "text": "We determine whether HLA alleles with similar sequences, or drug with similar modes of action lead to selection responses that are similar. To obtain dendrograms of drug selection profiles and HLA selection profiles we first assign estimated per-site selection coefficients to one of four broad classes, based on the median of the selection profile at that site:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Dendrograms of selection profiles and comparing topologies"
        },
        {
            "text": "We avoid considering lower quantiles due to potential biases which would be induced by drug/HLA specific sample sizes. We then perform hierarchical clustering on assigned selection classes using hclust (in the R stats library), using the complete linkage method. The resultant dendrograms for drug associated selection are shown in Supplementary Figure 13 .",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 332,
                    "end": 355,
                    "text": "Supplementary Figure 13",
                    "ref_id": "FIGREF0"
                }
            ],
            "section": "Dendrograms of selection profiles and comparing topologies"
        },
        {
            "text": "We compare the topology of dendrograms obtained from HLA selection profiles to dendrograms obtained from human HLA protein sequence information from the IMGT database [33] . To obtain a dendrogram based on host HLA sequence information for comparison, we first remove identical HLA protein sequences in the available sequenced region and restrict analysis to the first four members of each 2-digit HLA type for which we have estimated an HLA selection profile for HIV-1. We use RaxML [11] to obtain maximum likelihood trees for each of the three class I molecules. As we expect, members of the same 2-digit HLA type cluster together.",
            "cite_spans": [
                {
                    "start": 167,
                    "end": 171,
                    "text": "[33]",
                    "ref_id": "BIBREF31"
                },
                {
                    "start": 484,
                    "end": 488,
                    "text": "[11]",
                    "ref_id": "BIBREF10"
                }
            ],
            "ref_spans": [],
            "section": "Dendrograms of selection profiles and comparing topologies"
        },
        {
            "text": "To compare dendrogram topologies, we determine the number of 2-digit HLA types which share closest neighbours (closest leaf within the dendrogram) across the 2 dendrogram topologies. As a permutation test, we shuffle tip labellings to obtain a distribution on this metric. As HLA alleles with the same first two digits lie at slightly different positions in the host HLA protein dendrogram, we randomly restrict to one representative of each 2-digit HLA 100 times, and perform 10,000 label shuffles for each of these restrictions to obtain the distribution for our nearest neighbour metric. From this distribution, we calculate p-values and odds ratios.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Dendrograms of selection profiles and comparing topologies"
        },
        {
            "text": "Derivation of expected divergence time to closest relative in a coalescent tree with k leaves Consider adding a new lineage to an existing tree with k lineages. We are interested in the the distribution of the time, t, at which it first coalesces with an ancestral lineage within the existing genealogy. To derive the mean, let T k be the total tree length of a coalescent tree with k lineages. Then,",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Supplementary Notes"
        },
        {
            "text": "Thus, since t = T k+1 \u2212 T k ,",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Supplementary Notes"
        },
        {
            "text": "To approximate the distribution of the time to coalescence between a lineage and the rest of the tree, we use an exponential distribution with parameter k 2 .",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Supplementary Notes"
        },
        {
            "text": "We compare inference within our study (summarised in Figure 5b) to previous results at a series of well-studied epitopes. Putative CTL escape sites within HLA-B associated A-list epitopes are highlighted in yellow. Notice that many A-list epitopes are not variable.",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 53,
                    "end": 63,
                    "text": "Figure 5b)",
                    "ref_id": null
                }
            ],
            "section": "Comparison of results at well-studied epitopes"
        },
        {
            "text": "B * 07 epitope SPAIFQSSM (sites 156-164 in reverse transcriptase). We detect strong B * 07-dependent selection at the known escape site (position 162) [34, 35] . We also find two more top-tier sites and several second-tier sites within the epitope. On further investigation of the literature we find that many variants exist for this epitope, which result in non-susceptible forms in some individuals and susceptible forms in others [36] .",
            "cite_spans": [
                {
                    "start": 151,
                    "end": 155,
                    "text": "[34,",
                    "ref_id": "BIBREF32"
                },
                {
                    "start": 156,
                    "end": 159,
                    "text": "35]",
                    "ref_id": "BIBREF33"
                },
                {
                    "start": 433,
                    "end": 437,
                    "text": "[36]",
                    "ref_id": "BIBREF34"
                }
            ],
            "ref_spans": [],
            "section": "Comparison of results at well-studied epitopes"
        },
        {
            "text": "B * 18 epitope NETPGIRYQY (sites 137-146 in reverse transcriptase). We detect strong B * 18-dependent selection at the first anchor residue of NETPGIRYQY (site 138) [35, 37] . We do not detect selection at the other escape site. Further investigation of the literature reveals that the 'diminished response' induced by a variant at this site is actually recognised to much the same levels as the wild type epitope, and precedes outgrowth of the single variant at the first anchor residue in the single patient studied [38] . Moving on to protease in Supplementary Figure 15 , we detect a strong signal of selection within the B * 44 epitope EEMNLPGRW. This signal is particularly strong at the first anchor residue (site 35) where escape is known to occur [39, 40] .",
            "cite_spans": [
                {
                    "start": 165,
                    "end": 169,
                    "text": "[35,",
                    "ref_id": "BIBREF33"
                },
                {
                    "start": 170,
                    "end": 173,
                    "text": "37]",
                    "ref_id": "BIBREF35"
                },
                {
                    "start": 518,
                    "end": 522,
                    "text": "[38]",
                    "ref_id": "BIBREF36"
                },
                {
                    "start": 756,
                    "end": 760,
                    "text": "[39,",
                    "ref_id": "BIBREF37"
                },
                {
                    "start": 761,
                    "end": 764,
                    "text": "40]",
                    "ref_id": "BIBREF38"
                }
            ],
            "ref_spans": [
                {
                    "start": 550,
                    "end": 573,
                    "text": "Supplementary Figure 15",
                    "ref_id": "FIGREF0"
                }
            ],
            "section": "Comparison of results at well-studied epitopes"
        },
        {
            "text": "We now consider well-studied HLA-A epitopes, again starting with reverse transcriptase. See Supplementary Figures 17 (note there are no HLA-C epitopes in our well-studied list):",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Comparison of results at well-studied epitopes"
        },
        {
            "text": "A * 02 epitope YTAFTIPSV (sites 127-135 in reverse transcriptase). We do not detect A * 02-associated selection in YTAFTIPSV. The subtype B and C consensus residue at the escape site (position 135) is the defined escape allele [41] , explaining why we do not detect a signal. However, we notice that a signal at the escape site is picked up when considering subtype B viruses (see the fifth and sixth A * 02 strips of Supplementary Figure 17 ). This suggests that other mutations at the same residue can also result in a diminished CTL response.",
            "cite_spans": [
                {
                    "start": 227,
                    "end": 231,
                    "text": "[41]",
                    "ref_id": "BIBREF39"
                }
            ],
            "ref_spans": [
                {
                    "start": 418,
                    "end": 441,
                    "text": "Supplementary Figure 17",
                    "ref_id": "FIGREF0"
                }
            ],
            "section": "Comparison of results at well-studied epitopes"
        },
        {
            "text": "A * 03 epitope AIFQSSMTK (sites 158-166 in reverse transcriptase).",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Comparison of results at well-studied epitopes"
        },
        {
            "text": "Escape is known to occur at the second anchor residue (site 166) [42, 43] . This site is in our collection of second tier candidates, see Supplementary Figure 17 , with much of the signal coming from the subtype C viruses. However, we do not detect any A * 03-associated selection elsewhere in the epitope.",
            "cite_spans": [
                {
                    "start": 65,
                    "end": 69,
                    "text": "[42,",
                    "ref_id": "BIBREF40"
                },
                {
                    "start": 70,
                    "end": 73,
                    "text": "43]",
                    "ref_id": "BIBREF41"
                }
            ],
            "ref_spans": [
                {
                    "start": 152,
                    "end": 161,
                    "text": "Figure 17",
                    "ref_id": "FIGREF0"
                }
            ],
            "section": "Comparison of results at well-studied epitopes"
        },
        {
            "text": "A * 11 epitope AIFQSSMTK (sites 158-166 in reverse transcriptase).",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Comparison of results at well-studied epitopes"
        },
        {
            "text": "We do not detect A * 11 dependent selection in this epitope. A * 11 is a relatively rare HLA allele in our query data set.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Comparison of results at well-studied epitopes"
        },
        {
            "text": "A * 02 epitope LVGPTPVNI (sites 76-84 in protease).",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Comparison of results at well-studied epitopes"
        },
        {
            "text": "Finally, looking at Supplementary Figure 14 we see that A * 02-dependent selection is detected in LVGPTPVNI, but not at the reported escape site. We detect strong selection at the first anchor residue, and slightly upstream of the epitope. Interestingly, some literature suggests that the wild type sequence is not recognised, and a drug induced mutation at the escape site (position 82) results in epitope recognition [44] . These conflicting signals may explain why we do not detect A * 02-associated selection at the known escape site.",
            "cite_spans": [
                {
                    "start": 419,
                    "end": 423,
                    "text": "[44]",
                    "ref_id": "BIBREF42"
                }
            ],
            "ref_spans": [
                {
                    "start": 34,
                    "end": 43,
                    "text": "Figure 14",
                    "ref_id": "FIGREF0"
                }
            ],
            "section": "Comparison of results at well-studied epitopes"
        },
        {
            "text": "These findings demonstrate the ability of our method to accurately identify many sites known to be under HLA associated selection, and highlight the nuanced effects of many putative escape variants. N (0, 4) . \u00b5 was set at 40, and \u03ba was set at 7.60. The recombination probability between sites, r i , was set at a constant across the region, which we varied between collections of runs (r \u2208 {0, 0.01, 0.05}). Figure 5 : Simulation Study 1: comparison of estimates obtained using the closest 100 sequences by Hamming distance to the sequences actually copied from in the simulation, r = 0.05. Averages are taken over 100 independent MCMC runs on independent simulated data with the same underlying parameters. Plotting for the first three rows is as in Figure 3 . The first row shows inference results for HLA 3 associated selection and reversion using sequences copied from in the restriction of D B , the second row shows the corresponding inference results when restricting D B is restricted using the closest 100 sequences by Hamming distance. The third row displays the coverage using the different restrictions. The final two rows display recombination estimates, and an example of inference of \u03c9 across the region for the restriction using the sequences copied from and the closest 100 by Hamming distance respectively. Source data are provided as a Source Data file. 1) . For Fryer Approx this is because we stop our threshold for estimated rates at 0. For PhyloD and PhyloD OR, it is because many sites will not be included in leaf distribution or logistic regression respectively. Source data are provided as a Source Data file. (1, 1) . For Fryer Approx this is because we stop our threshold for estimated rates at 0. For PhyloD and PhyloD OR, it is because many sites will not be included in leaf distribution or logistic regression respectively. Pink to red lines and dashed lines show the ROC curves for our approach, using different D B . From light to dark, we sampled 100%, 10% and 1% of D B from each independent run in Simulation Study 2 and estimated HLA-associated selection. Dashed lines of the same colour also include D in D B using a leave one out approach. The black ROC curve shows the results of considering only D using a leave one out approach. Source data are provided as a Source Data file. Grey and white bands display the 5% -95% and 25% -75% credible intervals. In the third row, we display the coverage for the 95% and 50% credible intervals in blue and black respectively. The solid lines are using the gold standard reference set, and the dotted lines are using reference data from all public databases. In each of the fourth rows we display the average RMSE at each site for different D B as defined in the key. Source data are provided as a Source Data file. Grey and white bands display the 5% -95% and 25% -75% credible intervals. In the third row, we display the coverage for the 95% and 50% credible intervals in blue and black respectively. The solid lines are using the gold standard reference set, and the dotted lines are using reference data from all public databases. In each of the fourth rows we display the average RMSE at each site for different D B as defined in the key. Source data are provided as a Source Data file. Grey and white bands display the 5% -95% and 25% -75% credible intervals. In the third row, we display the coverage for the 95% and 50% credible intervals in blue and black respectively. The solid lines are using the gold standard reference set, and the dotted lines are using reference data from all public databases. In each of the fourth rows we display the average RMSE at each site for different D B as defined in the key. Source data are provided as a Source Data file. We display a summary of all the results of each of our MCMC runs applied to protease. Inference results on the grey horizontal strips are coloured as shown in the key. Two grey strips per HLA show selection away from C = B and C = C respectively. Bar plots to the right show HLA frequencies. The two lowest strips summarise median \u03c9 according to the colour bar. Blue vertical lines denote drug resistance sites. Green vertical lines denote sites at which there is an amino acid difference between the subtype B and subtype C consensus viral sequence. Colouring of epitopes plotted above the grey lines refers to the A-list [45] and B-list [46] which are coloured purple and pink respectively. In addition, we colour sites of known escape variants within the A-list epitopes in yellow. Figure 15 : Summary of HLA-B associated selection in protease. We display a summary of all the results of each of our MCMC runs applied to protease. Inference results on the grey horizontal strips are coloured as shown in the key. Two grey strips per HLA show selection away from C = B and C = C respectively. Bar plots to the right show HLA frequencies. The two lowest strips summarise median \u03c9 according to the colour bar. Blue vertical lines denote drug resistance sites. Green vertical lines denote sites at which there is an amino acid difference between the subtype B and subtype C consensus viral sequence. Colouring of epitopes plotted above the grey lines refers to the A-list [45] and B-list [46] which are coloured purple and pink respectively. In addition, we colour sites of known escape variants within the A-list epitopes in yellow. Source data are provided as a Source Data file. Figure 16 : Summary of HLA-C associated selection in protease. We display a summary of all the results of each of our MCMC runs applied to protease. Inference results on the grey horizontal strips are coloured as shown in the key. Two grey strips per HLA show selection away from C = B and C = C respectively. Bar plots to the right show HLA frequencies. The two lowest strips summarise median \u03c9 according to the colour bar. Blue vertical lines denote drug resistance sites. Green vertical lines denote sites at which there is an amino acid difference between the subtype B and subtype C consensus viral sequence. Colouring of epitopes plotted above the grey lines refers to the A-list [45] and B-list [46] which are coloured purple and pink respectively. In addition, we colour sites of known escape variants within the A-list epitopes in yellow. Source data are provided as a Source Data file. Figure 17 : Summary of HLA-A associated selection in reverse transcriptase. We display a summary of all the results of each of our MCMC runs applied to protease. Inference results on the grey horizontal strips are coloured as shown in the key. Two grey strips per HLA show selection away from C = B and C = C respectively. Bar plots to the right show HLA frequencies. The two lowest strips summarise median \u03c9 according to the colour bar. Blue vertical lines denote drug resistance sites. Green vertical lines denote sites at which there is an amino acid difference between the subtype B and subtype C consensus viral sequence. Colouring of epitopes plotted above the grey lines refers to the A-list [45] and B-list [46] which are coloured purple and pink respectively. In addition, we colour sites of known escape variants within the A-list epitopes in yellow. Source data are provided as a Source Data file. Figure 18 : Summary of HLA-C associated selection in reverse transcriptase. We display a summary of all the results of each of our MCMC runs applied to protease. Inference results on the grey horizontal strips are coloured as shown in the key. Two grey strips per HLA show selection away from C = B and C = C respectively. Bar plots to the right show HLA frequencies. The two lowest strips summarise median \u03c9 according to the colour bar. Blue vertical lines denote drug resistance sites. Green vertical lines denote sites at which there is an amino acid difference between the subtype B and subtype C consensus viral sequence. Colouring of epitopes plotted above the grey lines refers to the A-list [45] and B-list [46] which are coloured purple and pink respectively. In addition, we colour sites of known escape variants within the A-list epitopes in yellow. Source data are provided as a Source Data file. Figure 19 : Estimated recombination probabilities between sites across protease and reverse transcriptase. The mean estimate is plotted in black, the median is plotted in red. The white band denotes the 50% credible interval within the 95% credible interval denoted by the grey band. Blue vertical lines denote drug resistance sites. Green vertical lines denote sites at which there is an amino acid difference between the subtype B and subtype C consensus viral sequence. Source data are provided as a Source Data file. The impact of HLA alleles on differentiation between HIV-1 subtypes. Let C B and C B be the subtype B and subtype C viral sequence consensus respectively. Let H B and H C be the distribution of HLA types in individuals harbouring subtype B and subtype C viruses as defined by RIP [47] in the query data set. The panels display comparisons of HLA-associated selection pressure away from C B and C C by H B and H C . The first row shows results for protease, and the second row shows results for reverse transcriptase. Sites that distinguish subtype B and subtype C at the amino acid level are highlighted in red. Source data are provided as a Source Data file.",
            "cite_spans": [
                {
                    "start": 1638,
                    "end": 1641,
                    "text": "(1,",
                    "ref_id": "BIBREF0"
                },
                {
                    "start": 1642,
                    "end": 1644,
                    "text": "1)",
                    "ref_id": "BIBREF0"
                },
                {
                    "start": 4373,
                    "end": 4377,
                    "text": "[45]",
                    "ref_id": "BIBREF43"
                },
                {
                    "start": 5221,
                    "end": 5225,
                    "text": "[45]",
                    "ref_id": "BIBREF43"
                },
                {
                    "start": 6117,
                    "end": 6121,
                    "text": "[45]",
                    "ref_id": "BIBREF43"
                },
                {
                    "start": 7026,
                    "end": 7030,
                    "text": "[45]",
                    "ref_id": "BIBREF43"
                },
                {
                    "start": 7935,
                    "end": 7939,
                    "text": "[45]",
                    "ref_id": "BIBREF43"
                },
                {
                    "start": 8946,
                    "end": 8950,
                    "text": "[47]",
                    "ref_id": null
                }
            ],
            "ref_spans": [
                {
                    "start": 199,
                    "end": 207,
                    "text": "N (0, 4)",
                    "ref_id": "FIGREF3"
                },
                {
                    "start": 409,
                    "end": 417,
                    "text": "Figure 5",
                    "ref_id": null
                },
                {
                    "start": 752,
                    "end": 760,
                    "text": "Figure 3",
                    "ref_id": "FIGREF2"
                },
                {
                    "start": 1374,
                    "end": 1376,
                    "text": "1)",
                    "ref_id": "FIGREF0"
                },
                {
                    "start": 4535,
                    "end": 4544,
                    "text": "Figure 15",
                    "ref_id": "FIGREF0"
                },
                {
                    "start": 5431,
                    "end": 5440,
                    "text": "Figure 16",
                    "ref_id": "FIGREF0"
                },
                {
                    "start": 6327,
                    "end": 6336,
                    "text": "Figure 17",
                    "ref_id": "FIGREF0"
                },
                {
                    "start": 7236,
                    "end": 7245,
                    "text": "Figure 18",
                    "ref_id": "FIGREF0"
                },
                {
                    "start": 8145,
                    "end": 8154,
                    "text": "Figure 19",
                    "ref_id": "FIGREF0"
                }
            ],
            "section": "Comparison of results at well-studied epitopes"
        },
        {
            "text": "Parameter Prior Selection due to H B > H C C C p = 0.70 p = 0.0058 Table 9 : Summary of reference data sets for simulation study 3. Source data are provided as a Source Data file.",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 67,
                    "end": 74,
                    "text": "Table 9",
                    "ref_id": null
                }
            ],
            "section": "Supplementary Tables"
        }
    ],
    "bib_entries": {
        "BIBREF0": {
            "ref_id": "b0",
            "title": "Modeling Linkage Disequilibrium and Identifying Recombination Hotspots Using Single-Nucleotide Polymorphism Data",
            "authors": [
                {
                    "first": "N",
                    "middle": [],
                    "last": "Li",
                    "suffix": ""
                },
                {
                    "first": "M",
                    "middle": [],
                    "last": "Stephens",
                    "suffix": ""
                }
            ],
            "year": 2003,
            "venue": "Genetics",
            "volume": "165",
            "issn": "",
            "pages": "1943--2631",
            "other_ids": {}
        },
        "BIBREF1": {
            "ref_id": "b1",
            "title": "Likelihood Models for Detecting Positively Selected Amino Acid Sites and Applications to the HIV-1 Envelope Gene",
            "authors": [
                {
                    "first": "R",
                    "middle": [],
                    "last": "Nielsen",
                    "suffix": ""
                },
                {
                    "first": "Z",
                    "middle": [],
                    "last": "Yang",
                    "suffix": ""
                }
            ],
            "year": 1998,
            "venue": "Genetics",
            "volume": "148",
            "issn": "",
            "pages": "1943--2631",
            "other_ids": {}
        },
        "BIBREF2": {
            "ref_id": "b2",
            "title": "A tutorial on hidden Markov models and selected applications in speech recognition",
            "authors": [
                {
                    "first": "L",
                    "middle": [
                        "R"
                    ],
                    "last": "Rabiner",
                    "suffix": ""
                }
            ],
            "year": 1989,
            "venue": "PROCEEDINGS OF THE IEEE",
            "volume": "77",
            "issn": "",
            "pages": "257--286",
            "other_ids": {}
        },
        "BIBREF3": {
            "ref_id": "b3",
            "title": "Estimating diversifying selection and functional constraint in the presence of recombination",
            "authors": [
                {
                    "first": "D",
                    "middle": [
                        "J"
                    ],
                    "last": "Wilson",
                    "suffix": ""
                },
                {
                    "first": "G",
                    "middle": [],
                    "last": "Mcvean",
                    "suffix": ""
                }
            ],
            "year": 2006,
            "venue": "Genetics",
            "volume": "172",
            "issn": "",
            "pages": "16--6731",
            "other_ids": {}
        },
        "BIBREF4": {
            "ref_id": "b4",
            "title": "Evidence for substantial fine-scale variation in recombination rates across the human genome",
            "authors": [
                {
                    "first": "D",
                    "middle": [
                        "C"
                    ],
                    "last": "Crawford",
                    "suffix": ""
                }
            ],
            "year": 2004,
            "venue": "Nature Genetics",
            "volume": "36",
            "issn": "",
            "pages": "1061--4036",
            "other_ids": {}
        },
        "BIBREF5": {
            "ref_id": "b5",
            "title": "Evidence of HIV-1 adaptation to HLA-restricted immune responses at a population level",
            "authors": [
                {
                    "first": "C",
                    "middle": [
                        "B"
                    ],
                    "last": "Moore",
                    "suffix": ""
                }
            ],
            "year": 2002,
            "venue": "Science",
            "volume": "296",
            "issn": "",
            "pages": "1095--9203",
            "other_ids": {}
        },
        "BIBREF6": {
            "ref_id": "b6",
            "title": "Founder Effects in the Assessment of HIV Polymorphisms and HLA Allele Associations",
            "authors": [
                {
                    "first": "T",
                    "middle": [],
                    "last": "Bhattacharya",
                    "suffix": ""
                }
            ],
            "year": 2007,
            "venue": "Science",
            "volume": "315",
            "issn": "",
            "pages": "1583--1586",
            "other_ids": {}
        },
        "BIBREF7": {
            "ref_id": "b7",
            "title": "Cytotoxic T-lymphocyte escape mutations identified by HLA association favor those which escape and revert rapidly",
            "authors": [
                {
                    "first": "H",
                    "middle": [
                        "R"
                    ],
                    "last": "Fryer",
                    "suffix": ""
                }
            ],
            "year": 2012,
            "venue": "Journal of virology",
            "volume": "86",
            "issn": "",
            "pages": "1098--5514",
            "other_ids": {}
        },
        "BIBREF8": {
            "ref_id": "b8",
            "title": "Phylogenetic dependency networks: inferring patterns of CTL escape and codon covariation in HIV-1 Gag",
            "authors": [
                {
                    "first": "J",
                    "middle": [
                        "M"
                    ],
                    "last": "Carlson",
                    "suffix": ""
                }
            ],
            "year": 2008,
            "venue": "PLoS computational biology",
            "volume": "4",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF9": {
            "ref_id": "b9",
            "title": "Widespread Impact of HLA Restriction on Immune Control and Escape Pathways of HIV-1",
            "authors": [
                {
                    "first": "J",
                    "middle": [
                        "M"
                    ],
                    "last": "Carlson",
                    "suffix": ""
                }
            ],
            "year": 2012,
            "venue": "Journal of Virology",
            "volume": "86",
            "issn": "",
            "pages": "1098--5514",
            "other_ids": {}
        },
        "BIBREF10": {
            "ref_id": "b10",
            "title": "RAxML-III: a fast program for maximum likelihoodbased inference of large phylogenetic trees",
            "authors": [
                {
                    "first": "A",
                    "middle": [],
                    "last": "Stamatakis",
                    "suffix": ""
                },
                {
                    "first": "T",
                    "middle": [],
                    "last": "Ludwig",
                    "suffix": ""
                },
                {
                    "first": "H",
                    "middle": [],
                    "last": "Meier",
                    "suffix": ""
                }
            ],
            "year": 2005,
            "venue": "Bioinformatics",
            "volume": "21",
            "issn": "",
            "pages": "1367--4803",
            "other_ids": {}
        },
        "BIBREF11": {
            "ref_id": "b11",
            "title": "Modelling the Evolution and Spread of HIV Immune Escape Mutants",
            "authors": [
                {
                    "first": "H",
                    "middle": [
                        "R"
                    ],
                    "last": "Fryer",
                    "suffix": ""
                }
            ],
            "year": 2010,
            "venue": "PLoS Pathog",
            "volume": "6",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF12": {
            "ref_id": "b12",
            "title": "Evolutionary trees from DNA sequences: a maximum likelihood approach",
            "authors": [
                {
                    "first": "J",
                    "middle": [],
                    "last": "Felsenstein",
                    "suffix": ""
                }
            ],
            "year": 1981,
            "venue": "Journal of molecular evolution",
            "volume": "17",
            "issn": "",
            "pages": "22--2844",
            "other_ids": {}
        },
        "BIBREF13": {
            "ref_id": "b13",
            "title": "Leveraging Hierarchical Population Structure in Discrete Association Studies",
            "authors": [
                {
                    "first": "J",
                    "middle": [],
                    "last": "Carlson",
                    "suffix": ""
                },
                {
                    "first": "C",
                    "middle": [],
                    "last": "Kadie",
                    "suffix": ""
                },
                {
                    "first": "S",
                    "middle": [],
                    "last": "Mallal",
                    "suffix": ""
                },
                {
                    "first": "D",
                    "middle": [],
                    "last": "Heckerman",
                    "suffix": ""
                }
            ],
            "year": 2007,
            "venue": "PLoS ONE",
            "volume": "2",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF14": {
            "ref_id": "b14",
            "title": "Unifying Optimization Algorithms to Aid Software System Users: optimx for R",
            "authors": [
                {
                    "first": "J",
                    "middle": [
                        "C"
                    ],
                    "last": "Nash",
                    "suffix": ""
                },
                {
                    "first": "R",
                    "middle": [],
                    "last": "Varadhan",
                    "suffix": ""
                }
            ],
            "year": 2011,
            "venue": "Journal of Statistical Software",
            "volume": "43",
            "issn": "",
            "pages": "1--14",
            "other_ids": {}
        },
        "BIBREF15": {
            "ref_id": "b15",
            "title": "A Simplex Method for Function Minimization",
            "authors": [
                {
                    "first": "J",
                    "middle": [
                        "A"
                    ],
                    "last": "Nelder",
                    "suffix": ""
                },
                {
                    "first": "R",
                    "middle": [],
                    "last": "Mead",
                    "suffix": ""
                }
            ],
            "year": 1965,
            "venue": "The Computer Journal",
            "volume": "7",
            "issn": "",
            "pages": "1460--2067",
            "other_ids": {}
        },
        "BIBREF16": {
            "ref_id": "b16",
            "title": "A Limited Memory Algorithm for Bound Constrained Optimization",
            "authors": [
                {
                    "first": "R",
                    "middle": [
                        "H"
                    ],
                    "last": "Byrd",
                    "suffix": ""
                },
                {
                    "first": "P",
                    "middle": [],
                    "last": "Lu",
                    "suffix": ""
                },
                {
                    "first": "J",
                    "middle": [],
                    "last": "Nocedal",
                    "suffix": ""
                },
                {
                    "first": "C",
                    "middle": [],
                    "last": "Zhu",
                    "suffix": ""
                }
            ],
            "year": 1995,
            "venue": "SIAM J. Sci. Comput",
            "volume": "16",
            "issn": "",
            "pages": "1064--8275",
            "other_ids": {}
        },
        "BIBREF17": {
            "ref_id": "b17",
            "title": "& for Matematisk Modellering, I. Ucminf -an algorithm for unconstrained",
            "authors": [
                {
                    "first": "H",
                    "middle": [],
                    "last": "Bruun Nielsen",
                    "suffix": ""
                },
                {
                    "first": "D",
                    "middle": [
                        "T"
                    ],
                    "last": "Universitet",
                    "suffix": ""
                }
            ],
            "year": 2000,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF18": {
            "ref_id": "b18",
            "title": "Iterative Methods for Optimization",
            "authors": [
                {
                    "first": "C",
                    "middle": [
                        "T"
                    ],
                    "last": "Kelley",
                    "suffix": ""
                }
            ],
            "year": 1987,
            "venue": "Applied Mathematics)",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF20": {
            "ref_id": "b20",
            "title": "The BOBYQA algorithm for bound constrained optimization without derivatives",
            "authors": [
                {
                    "first": "M",
                    "middle": [
                        "J"
                    ],
                    "last": "Powell",
                    "suffix": ""
                }
            ],
            "year": 2009,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF21": {
            "ref_id": "b21",
            "title": "A prospective trial of structured treatment interruptions in human immunodeficiency virus infection",
            "authors": [
                {
                    "first": "C",
                    "middle": [],
                    "last": "Fagard",
                    "suffix": ""
                }
            ],
            "year": 2003,
            "venue": "Archives of internal medicine",
            "volume": "163",
            "issn": "",
            "pages": "3--9926",
            "other_ids": {}
        },
        "BIBREF22": {
            "ref_id": "b22",
            "title": "Effective T-Cell Responses Select Human Immunodeficiency Virus Mutants and Slow Disease Progression",
            "authors": [
                {
                    "first": "A",
                    "middle": [
                        "J"
                    ],
                    "last": "Frater",
                    "suffix": ""
                }
            ],
            "year": 2007,
            "venue": "Journal of Virology",
            "volume": "81",
            "issn": "",
            "pages": "1098--5514",
            "other_ids": {}
        },
        "BIBREF23": {
            "ref_id": "b23",
            "title": "Additive Contribution of HLA Class I Alleles in the Immune Control of HIV-1 Infection",
            "authors": [
                {
                    "first": "A",
                    "middle": [],
                    "last": "Leslie",
                    "suffix": ""
                }
            ],
            "year": 2010,
            "venue": "Journal of Virology",
            "volume": "84",
            "issn": "",
            "pages": "1098--5514",
            "other_ids": {}
        },
        "BIBREF24": {
            "ref_id": "b24",
            "title": "Central Role of Reverting Mutations in HLA Associations with Human Immunodeficiency Virus Set Point",
            "authors": [
                {
                    "first": "P",
                    "middle": [
                        "C"
                    ],
                    "last": "Matthews",
                    "suffix": ""
                }
            ],
            "year": 2008,
            "venue": "Journal of Virology",
            "volume": "82",
            "issn": "",
            "pages": "1098--5514",
            "other_ids": {}
        },
        "BIBREF25": {
            "ref_id": "b25",
            "title": "Antiretroviral Regimens in Pregnancy and Breast-Feeding in Botswana",
            "authors": [
                {
                    "first": "R",
                    "middle": [
                        "L"
                    ],
                    "last": "Shapiro",
                    "suffix": ""
                }
            ],
            "year": 2010,
            "venue": "N Engl J Med",
            "volume": "362",
            "issn": "",
            "pages": "2282--2294",
            "other_ids": {}
        },
        "BIBREF26": {
            "ref_id": "b26",
            "title": "Prevalence of HIV type-1 drug-associated mutations in pre-therapy patients in the Free State",
            "authors": [
                {
                    "first": "K.-H",
                    "middle": [
                        "G H"
                    ],
                    "last": "Huang",
                    "suffix": ""
                }
            ],
            "year": 2009,
            "venue": "South Africa. Antiviral therapy",
            "volume": "14",
            "issn": "",
            "pages": "1359--6535",
            "other_ids": {}
        },
        "BIBREF27": {
            "ref_id": "b27",
            "title": "Progression to AIDS in South Africa Is Associated with both Reverting and Compensatory Viral Mutations",
            "authors": [
                {
                    "first": "K.-H",
                    "middle": [
                        "G"
                    ],
                    "last": "Huang",
                    "suffix": ""
                }
            ],
            "year": 2011,
            "venue": "PLoS ONE",
            "volume": "6",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF28": {
            "ref_id": "b28",
            "title": "Antiretroviral Therapy in Primary HIV Infection",
            "authors": [
                {
                    "first": "",
                    "middle": [],
                    "last": "Short-Course",
                    "suffix": ""
                }
            ],
            "year": 2013,
            "venue": "N Engl J Med",
            "volume": "368",
            "issn": "",
            "pages": "207--217",
            "other_ids": {}
        },
        "BIBREF30": {
            "ref_id": "b30",
            "title": "MUSCLE: a multiple sequence alignment method with reduced time and space complexity",
            "authors": [
                {
                    "first": "R",
                    "middle": [
                        "C"
                    ],
                    "last": "Edgar",
                    "suffix": ""
                }
            ],
            "year": 2004,
            "venue": "BMC bioinformatics",
            "volume": "5",
            "issn": "",
            "pages": "1471--2105",
            "other_ids": {}
        },
        "BIBREF31": {
            "ref_id": "b31",
            "title": "The IMGT/HLA database",
            "authors": [
                {
                    "first": "J",
                    "middle": [],
                    "last": "Robinson",
                    "suffix": ""
                }
            ],
            "year": 2013,
            "venue": "Nucleic Acids Research",
            "volume": "41",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF32": {
            "ref_id": "b32",
            "title": "Identification of HLA class I-associated amino acid polymorphisms in the HIV-1C proteome",
            "authors": [
                {
                    "first": "C",
                    "middle": [
                        "L"
                    ],
                    "last": "Boutwell",
                    "suffix": ""
                },
                {
                    "first": "M",
                    "middle": [],
                    "last": "Essex",
                    "suffix": ""
                }
            ],
            "year": 2007,
            "venue": "AIDS research and human retroviruses",
            "volume": "23",
            "issn": "",
            "pages": "889--2229",
            "other_ids": {}
        },
        "BIBREF33": {
            "ref_id": "b33",
            "title": "Marked epitope-and allele-specific differences in rates of mutation in human immunodeficiency type 1 (HIV-1) Gag, Pol, and Nef cytotoxic T-lymphocyte epitopes in acute/early HIV-1 infection",
            "authors": [
                {
                    "first": "Z",
                    "middle": [
                        "L"
                    ],
                    "last": "Brumme",
                    "suffix": ""
                }
            ],
            "year": 2008,
            "venue": "Journal of virology",
            "volume": "82",
            "issn": "",
            "pages": "1098--5514",
            "other_ids": {}
        },
        "BIBREF34": {
            "ref_id": "b34",
            "title": "Interdisciplinary analysis of HIV-specific CD8+ T cell responses against variant epitopes reveals restricted TCR promiscuity",
            "authors": [
                {
                    "first": "I",
                    "middle": [],
                    "last": "Hoof",
                    "suffix": ""
                }
            ],
            "year": 1950,
            "venue": "Journal of immunology",
            "volume": "184",
            "issn": "",
            "pages": "1550--6606",
            "other_ids": {}
        },
        "BIBREF35": {
            "ref_id": "b35",
            "title": "CD8+ T-cell responses to different HIV proteins have discordant associations with viral load",
            "authors": [
                {
                    "first": "P",
                    "middle": [],
                    "last": "Kiepiela",
                    "suffix": ""
                }
            ],
            "year": 2007,
            "venue": "Nature medicine",
            "volume": "13",
            "issn": "",
            "pages": "1078--8956",
            "other_ids": {}
        },
        "BIBREF36": {
            "ref_id": "b36",
            "title": "Dynamics of viral evolution and CTL responses in HIV-1 infection",
            "authors": [
                {
                    "first": "Y",
                    "middle": [],
                    "last": "Liu",
                    "suffix": ""
                },
                {
                    "first": "J",
                    "middle": [
                        "P"
                    ],
                    "last": "Mcnevin",
                    "suffix": ""
                },
                {
                    "first": "S",
                    "middle": [],
                    "last": "Holte",
                    "suffix": ""
                },
                {
                    "first": "M",
                    "middle": [
                        "J"
                    ],
                    "last": "Mcelrath",
                    "suffix": ""
                },
                {
                    "first": "J",
                    "middle": [
                        "I"
                    ],
                    "last": "Mullins",
                    "suffix": ""
                }
            ],
            "year": 2011,
            "venue": "PloS one",
            "volume": "6",
            "issn": "",
            "pages": "1932--6203",
            "other_ids": {}
        },
        "BIBREF37": {
            "ref_id": "b37",
            "title": "Dual selection pressure by drugs and HLA class I-restricted immune responses on human immunodeficiency virus type 1 protease",
            "authors": [
                {
                    "first": "S",
                    "middle": [
                        "M"
                    ],
                    "last": "Mueller",
                    "suffix": ""
                }
            ],
            "year": 2007,
            "venue": "Journal of virology",
            "volume": "81",
            "issn": "",
            "pages": "22--538",
            "other_ids": {}
        },
        "BIBREF38": {
            "ref_id": "b38",
            "title": "Relationship between functional profile of HIV-1 specific CD8 T cells and epitope variability with the selection of escape mutants in acute HIV-1 infection",
            "authors": [
                {
                    "first": "G",
                    "middle": [],
                    "last": "Ferrari",
                    "suffix": ""
                }
            ],
            "year": 2011,
            "venue": "PLoS pathogens",
            "volume": "7",
            "issn": "",
            "pages": "1553--7374",
            "other_ids": {
                "DOI": [
                    "10.1371/journal.ppat.1001273"
                ]
            }
        },
        "BIBREF39": {
            "ref_id": "b39",
            "title": "Constraints on HIV-1 evolution and immunodominance revealed in monozygotic adult twins infected with the same virus",
            "authors": [
                {
                    "first": "R",
                    "middle": [],
                    "last": "Draenert",
                    "suffix": ""
                }
            ],
            "year": 2006,
            "venue": "The Journal of experimental medicine",
            "volume": "203",
            "issn": "",
            "pages": "22--1007",
            "other_ids": {}
        },
        "BIBREF40": {
            "ref_id": "b40",
            "title": "Limited sequence evolution within persistently targeted CD8 epitopes in chronic human immunodeficiency virus type 1 infection",
            "authors": [
                {
                    "first": "T",
                    "middle": [],
                    "last": "Koibuchi",
                    "suffix": ""
                }
            ],
            "year": 2005,
            "venue": "Journal of virology",
            "volume": "79",
            "issn": "",
            "pages": "22--538",
            "other_ids": {}
        },
        "BIBREF41": {
            "ref_id": "b41",
            "title": "Cytotoxic T-lymphocyte responses to HIV-1 reverse transcriptase (review)",
            "authors": [
                {
                    "first": "L",
                    "middle": [],
                    "last": "Men\u00e9ndez-Arias",
                    "suffix": ""
                },
                {
                    "first": "A",
                    "middle": [],
                    "last": "Mas",
                    "suffix": ""
                },
                {
                    "first": "E",
                    "middle": [],
                    "last": "Domingo",
                    "suffix": ""
                }
            ],
            "year": 1998,
            "venue": "Viral immunology",
            "volume": "11",
            "issn": "",
            "pages": "882--8245",
            "other_ids": {}
        },
        "BIBREF42": {
            "ref_id": "b42",
            "title": "Induction of T-cell immunity to antiretroviral drug-resistant human immunodeficiency virus type 1",
            "authors": [
                {
                    "first": "I",
                    "middle": [],
                    "last": "Stratov",
                    "suffix": ""
                },
                {
                    "first": "C",
                    "middle": [
                        "J"
                    ],
                    "last": "Dale",
                    "suffix": ""
                },
                {
                    "first": "S",
                    "middle": [],
                    "last": "Chea",
                    "suffix": ""
                },
                {
                    "first": "J",
                    "middle": [],
                    "last": "Mccluskey",
                    "suffix": ""
                },
                {
                    "first": "S",
                    "middle": [
                        "J"
                    ],
                    "last": "Kent",
                    "suffix": ""
                }
            ],
            "year": 2005,
            "venue": "Journal of virology",
            "volume": "79",
            "issn": "",
            "pages": "22--538",
            "other_ids": {}
        },
        "BIBREF43": {
            "ref_id": "b43",
            "title": "Best-Characterized HIV-1 CTL Epitopes: The 2013 Update tech. rep",
            "authors": [
                {
                    "first": "A",
                    "middle": [],
                    "last": "Llano",
                    "suffix": ""
                },
                {
                    "first": "A",
                    "middle": [],
                    "last": "Williams",
                    "suffix": ""
                },
                {
                    "first": "A",
                    "middle": [],
                    "last": "Olvera",
                    "suffix": ""
                },
                {
                    "first": "S",
                    "middle": [],
                    "last": "Silva-Arrieta",
                    "suffix": ""
                },
                {
                    "first": "C",
                    "middle": [],
                    "last": "Brander",
                    "suffix": ""
                }
            ],
            "year": 2013,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF44": {
            "ref_id": "b44",
            "title": "Impact of pre-adapted HIV transmission",
            "authors": [
                {
                    "first": "J",
                    "middle": [
                        "M"
                    ],
                    "last": "Carlson",
                    "suffix": ""
                }
            ],
            "year": 2016,
            "venue": "Nature medicine",
            "volume": "22",
            "issn": "",
            "pages": "1546--170",
            "other_ids": {}
        }
    },
    "ref_entries": {
        "FIGREF0": {
            "text": "Simulation study 1: summary of the selection profiles used. Each subplot on the left-hand side indicates the HLA allele associated selection intensity away from the consensus codon, \u03b3, with the number denoting the name of that HLA. The table on the right indicates the HLA allele count in the simulated data for the HLA profiles shown on the left. Where HLA selection intensity exceeded 1, reversion \u03b6 i was set at 2 3 this intensity, and 1 otherwise. Non-HLA-associated selection, \u03c9 i , was sampled from log",
            "latex": null,
            "type": "figure"
        },
        "FIGREF1": {
            "text": "Simulation study 1: parameter estimates, no recombination (r = 0). Odd rows show the average estimates and credible intervals. Averages are taken over 100 independent MCMC runs on independent simulated data with the same underlying parameters. The true underlying value is shown in blue, the mean and median estimates are displayed in black and white respectively. The 50% credible interval is enclosed by the white band, which is in turn enclosed by the grey 95% credible interval. Even rows (except for the final panel) show coverage plots for the two credible intervals: the black line tracks the proportion of the time the truth lies within the 95% credible interval for the 100 independent simulations and MCMC runs. The blue line tracks the proportion of runs in which the truth lies within the 50% credible interval. The final panel shows an example of inference of \u03c9 across the region in one of the 100 simulations. Averages, truth, and credible intervals are coloured as in the odd rows. Source data are provided as a Source Data file.",
            "latex": null,
            "type": "figure"
        },
        "FIGREF2": {
            "text": "Simulation Study 1: comparison of estimates obtained using the closest 10 sequences by Hamming distance to the closest 100 sequences for r = 0 and r = 0.01. Averages are taken over 100 independent MCMC runs on independent simulated data with the same underlying parameters. The first two rows show results obtained using the closest 10 and 100 sequences by Hamming distance respectively. Columns show the results for r = 0 and r = 0.01 across the region respectively. The mean estimate is plotted in black, the median is plotted in red, and the true underlying parameter value is plotted in blue. The white band denotes the 50% credible interval within the 95% credible interval denoted by the grey band. The third panel displays the coverage. The black and grey lines display the proportion of the simulations for which the true underlying parameter lies within the 95% credible interval for each run when considering the closest 10 and 100 sequences by Hamming distance respectively. The dark and light blue lines display the proportion of the simulations for which the true underlying parameter lies within the 50% credible interval for each run when considering the closest 10 and 100 sequences by Hamming distance respectively. Source data are provided as a Source Data file.",
            "latex": null,
            "type": "figure"
        },
        "FIGREF3": {
            "text": "Simulation Study 1: parameter estimates, r = 0.01. Odd rows show the average estimates and credible intervals. Averages are taken over 100 independent MCMC runs on independent simulated data with the same underlying parameters. The true underlying value is shown in blue, the mean and median estimates are displayed in black and white respectively. The 50% credible interval is enclosed by the white band, which is in turn enclosed by the grey 95% credible interval. Even rows (except for the final panel) show coverage plots for the two credible intervals: the black line tracks the proportion of the time the truth lies within the 95% credible interval for the 100 independent simulations and MCMC runs. The blue line tracks the proportion of runs in which the truth lies within the 50% credible interval. The final panel shows an example of inference of \u03c9 across the region in one of the 100 simulations. Averages, truth, and credible intervals are coloured as in the odd rows. Source data are provided as a Source Data file.",
            "latex": null,
            "type": "figure"
        },
        "FIGREF4": {
            "text": "Simulation Study 2: parameter estimates. 100 independent birth-death processes were simulated. followed by 10% sampling and subsequent parameter inference. Estimates of HLA-associated scaling and posterior coverage are shown. Odd rows show the average estimates and credible intervals. Averages are taken over 100 independent MCMC runs on independent simulated data with the same underlying parameters. The true underlying value is shown in blue, the mean and median estimates are displayed in black and white respectively. The 50% credible interval is enclosed by the white band, which is in turn enclosed by the grey 95% credible interval. Even rows (except for the final panel) show coverage plots for the two credible intervals: the black line tracks the proportion of the time the truth lies within the 95% credible interval for the 100 independent simulations and MCMC runs. The blue line tracks the proportion of runs in which the truth lies within the 50% credible interval. The final panel shows an example of inference of \u03c9 across the region in one of the 100 simulations. Averages, truth, and credible intervals are coloured as in the odd rows. Source data are provided as a Source Data file. Simulation Study 2: sample size of 3000, results summary. Six methods used to identify HLA associated selection on viral sequence are applied to data simulated under the birth-death process used in simulation study 2. The second panel zooms in to the rectangle shown in the first panel. Coloured lines represent averages across 100 independent simulation runs. ROC curves for Fryer Approx, PhyloD and PhyloD OR do not extend to(1,",
            "latex": null,
            "type": "figure"
        },
        "FIGREF5": {
            "text": "Simulation Study 2: impact of reduced reference sequence set, results summary. The second panel zooms in to the rectangle shown in the first panel. Coloured lines represent averages across 100 independent simulation runs. ROC curves for Fryer Approx, PhyloD and PhyloD OR do not extend to",
            "latex": null,
            "type": "figure"
        },
        "FIGREF6": {
            "text": "Simulation Study 3: example results for HLA-A alleles. We show results for one rare and one common allele for each of HLA-A. The first panel for each shows the gold standard -if we knew the sequences copied from to create D and included them in D B . The second shows the results if we let D B be all sequences without associated host HLA information. The red line displays the true underlying HLA associated selection of the parametric bootstrap. The blue line displays the median estimate.",
            "latex": null,
            "type": "figure"
        },
        "FIGREF7": {
            "text": "Simulation Study 3: example results for HLA-B alleles. We show results for one rare and one common allele for each of HLA-B. The first panel for each shows the gold standard -if we knew the sequences copied from to create D and included them in D B . The second shows the results if we let D B be all sequences without associated host HLA information. The red line displays the true underlying HLA associated selection of the parametric bootstrap. The blue line displays the median estimate.",
            "latex": null,
            "type": "figure"
        },
        "FIGREF8": {
            "text": "Simulation Study 3: example results for HLA-C alleles. We show results for one rare and one common allele for each of HLA-C. The first panel for each shows the gold standard -if we knew the sequences copied from to create D and included them in D B . The second shows the results if we let D B be all sequences without associated host HLA information. The red line displays the true underlying HLA associated selection of the parametric bootstrap. The blue line displays the median estimate.",
            "latex": null,
            "type": "figure"
        },
        "FIGREF9": {
            "text": "Drug associated selection analysis: Reverse transcriptase results summary. Grey bars highlight the region analysed. Codon position is measured relative to the HXB2 from the start of reverse transcriptase. Rows summarise drug-associated selection -drugs are shown to the left. Purple bars show the number of individuals prescribed the drug at viral sampling. Red and orange indicate our median estimate is > 2 and > 1.5 respectively. Sites are outlined in Black and grey if in addition the 2.5% and 10% quantile is > 1 respectively. Green and blue lines at the top of the plots highlight differences between subtype B/C at the amino-acid level, and sites of DRMs[22] respectively. Classes of DRM are displayed: solid white lines tag sites of DRMs which confer the highest levels of resistance for that drug, dashed white lines tag major DRMs, and dotted white lines tag DRMs when combined with other mutations [22]. Drugs highlighted red do not have major DRMs in the Stanford drug resistance database. The different classes of reverse transcriptase inhibitor are separated by black boxes and labelled. ADV is the only nucleotide reverse transcriptase inhibitor (ntRTI). Median \u03c9 is displayed at the foot of the figure, according to the colourbar. Key: 3TC = Lamivudine; ABC = Abacavir; AZT = Zidovudine; D4T = Stavudine; DDC = Zalcitabine; DDI = Didanosine; FTC = Emtricitabine; TDF = Tenofovir; \u03b1APA = Alphaanilinophenylacetamide; DLV = Delavirdine; EFV = Efavirenz; NVP = Nevirapine; ADV = Adefovir. Source data are provided as a Source Data file.",
            "latex": null,
            "type": "figure"
        },
        "FIGREF10": {
            "text": "Hierarchical clustering of drug selection profiles. In the reverse transcriptase dendrogram, nNRTIs are highlighted in red, and NRTIs are shown in black. The number of sampled individuals taking each drug as part of their treatment regime are shown to the right of the drug abbreviation. Drug abbreviations are as in Figure 3 and 12 for protease and reverse transcriptase inhibitors respectively. Methods are provided in the Supplementary Methods; Dendrograms of selection profiles and comparing topologies. Source data are provided as a Source Data file.",
            "latex": null,
            "type": "figure"
        },
        "FIGREF11": {
            "text": "Summary of HLA-A associated selection in protease.",
            "latex": null,
            "type": "figure"
        },
        "FIGREF12": {
            "text": "away from C B log(selection away from C B by H B ) log(selection away from away from C C log(selection away from C C by H B ) log(selection away fromC C by H C )",
            "latex": null,
            "type": "figure"
        },
        "TABREF1": {
            "text": "table, from which p-values are determined at each site and each HLA type, independently. Approximate escape rate estimate Assuming the model of Fryer et al. [12] has reached stationarity in the exponential growth phase, Fryer et al. write down simple formulae to determine estimates of host population rates of escape and reversion.",
            "latex": null,
            "type": "table"
        },
        "TABREF2": {
            "text": "* 35 epitope HPDIVIYQY (or NPDIVIYQY, sites 175-183 in reverse transcriptase). We do not detect B * 35-dependent selection in this epitope when considering all of our query sequences. However, we identify second-tier sites within HPDIVIYQY when considering only subtype C sequences in our query data set and setting C as the subtype B consensus sequence.",
            "latex": null,
            "type": "table"
        },
        "TABREF3": {
            "text": "Table 1: Priors on parameters of the model. l is the length of analysed sequences in codons, i and h enumerate codon site and HLA type respectively.",
            "latex": null,
            "type": "table"
        },
        "TABREF4": {
            "text": "The collection of 'false positive' associations are interrogated. We find that many of these associations, though not in the collection of major drug resistance mutations[22], are documented to be under selection.",
            "latex": null,
            "type": "table"
        },
        "TABREF5": {
            "text": "The collection of apparent false negative associations are interrogated. We can explain most false negatives -either due to our modelling regime, or lack of evidence for a true selective effect.37,38,39,40,41,42,43,44,45,46 16,17,18,19,20,39,40,41,42,43,44,45,46,89 A*31 35,55,56,57 19,20,35,55,56,57,58,59,60,61,62,63,64,65 11,12,16,17,18,19 B*44 35,37,38,39,40,41,43,44,45,46 35,36,37,38,39,40,41,92,93",
            "latex": null,
            "type": "table"
        },
        "TABREF6": {
            "text": "The collection of top-tier and second-tier sites in protease. Top-tier sites -median \u03b3 h,i > 2 and with the lower 2.5% quantile > 1 are underlined. The remainder are second-tier sites, with the lower 10% quantile > 1. Source data are provided as a Source Data file. 03 135,136,137,138,139,166,167 60,134,135,136,137,138,139,166 A*11 68 68,124,125,126,127 A*23 60,61,62,63,203,204,205 60,78,79,80,81 A*24 133,142 142,143 A*26 131,132,134,135,142,196 195,196,197 A*29 60,90,118,119,120,121,122,123,213,214 88,89,90,118,134,135,136,137,138,139,140, 88,89,90,93,95,96,112,116,117,118,122,123, 141,142,143,144 124,125,134,135,139,140,141,142,143,144 A*66 123,124,125,135,136,139,140,141,142,171 135,136,137,138,139,140,141,142,170,171",
            "latex": null,
            "type": "table"
        },
        "TABREF7": {
            "text": "The collection of top-tier and second tier sites in reverse-transcriptase. Top-tier sites -median \u03b3 h,i > 2 and with the lower 2.5% quantile > 1 are underlined. The remainder are second-tier sites, with the lower 10% quantile > 1. Source data are provided as a Source Data file.",
            "latex": null,
            "type": "table"
        },
        "TABREF8": {
            "text": "Overlap between studies. We compare our top-tier sites in Protease to those found in Carlson et al.[48] with q < 0.2. The both column denotes sites that were found in both studies. Sites that lie within known A or B-list epitopes are underlined. Source data are provided as a Source Data file.",
            "latex": null,
            "type": "table"
        },
        "TABREF9": {
            "text": "Overlap between studies. We compare our top-tier sites in Reverse Transcriptase to those found in Carlson et al.[48] with q < 0.2. The both column denotes sites that were found in both studies. Sites that lie within known A or B-list epitopes[49] are underlined. Source data are provided as a Source Data file.Selection due to H C > H B C B p = 2.8 \u00d7 10 \u22125 p = 2.0 \u00d7 10 \u22126",
            "latex": null,
            "type": "table"
        },
        "TABREF10": {
            "text": "Table ofp-values for differences between H B and H C associated selection at sites that distinguish subtype B and subtype C at the amino acid level in protease and reverse transcriptase. Source data are provided as a Source Data file.",
            "latex": null,
            "type": "table"
        }
    },
    "back_matter": []
}