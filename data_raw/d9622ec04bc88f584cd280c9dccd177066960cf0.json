{
    "paper_id": "d9622ec04bc88f584cd280c9dccd177066960cf0",
    "metadata": {
        "title": "Modeling site-specific amino-acid preferences deepens phylogenetic estimates of viral sequence divergence",
        "authors": [
            {
                "first": "Sarah",
                "middle": [
                    "K"
                ],
                "last": "Hilton",
                "suffix": "",
                "affiliation": {
                    "laboratory": "",
                    "institution": "Fred Hutchinson Cancer Research Center",
                    "location": {}
                },
                "email": ""
            },
            {
                "first": "Jesse",
                "middle": [
                    "D"
                ],
                "last": "Bloom",
                "suffix": "",
                "affiliation": {
                    "laboratory": "",
                    "institution": "Fred Hutchinson Cancer Research Center",
                    "location": {}
                },
                "email": ""
            }
        ]
    },
    "abstract": [
        {
            "text": "Molecular phylogenetics is often used to estimate the time since the divergence of modern gene sequences. For highly diverged sequences, such phylogenetic techniques sometimes estimate surprisingly recent divergence times. In the case of viruses, independent evidence indicates that the estimates of deep divergence times from molecular phylogenetics are sometimes too recent. This discrepancy is caused in part by inadequate models of purifying selection leading to branchlength underestimation. Here we examine the effect on branch-length estimation of using models that incorporate experimental measurements of purifying selection. We find that models informed by experimentally measured site-specific amino-acid preferences estimate longer deep branches on phylogenies of influenza virus hemagglutinin. This lengthening of branches is due to more realistic stationary states of the models, and is mostly independent of the branch-length extension from modeling site-to-site variation in amino-acid substitution rate. The branch-length extension from experimentally informed site-specific models is similar to that achieved by other approaches that allow the stationary state to vary across sites. However, the improvements from all of these site-specific but time homogeneous and site independent models are limited by the fact that a protein's amino-acid preferences gradually shift as it evolves. Overall, our work underscores the importance of modeling site-specific amino-acid preferences when estimating deep divergence times-but also shows the inherent limitations of approaches that fail to account for how these preferences shift over time.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Abstract"
        }
    ],
    "body_text": [
        {
            "text": "Molecular phylogenetics is commonly used to estimate the historical timing of evolutionary events (Yang and Rannala 2012) . This is done by estimating branch lengths based on the inferred number of substitutions, and then converting these branch lengths into units of time under the assumption of a molecular clock (Zuckerkandl and Pauling 1965; Drummond et al. 2006) . However, phylogenetic estimates of the divergence times of many viral lineages are clearly too recent (Duch\u00eane, Holmes, and Ho 2014; Ho et al. 2015; Aiewsakun and Katzourakis 2016) . For example, the integration of filoviruses into their host genomes indicate that Ebola and Marburg virus diverged from their common ancestor 7 to 12 million years ago-but the estimate of this divergence time based on phylogenetic analyses of the viral sequences is only $10,000 years ago (Carroll et al. 2013; Taylor et al. 2014) . Similarly, the phylogenetic estimate of when major simian immunodeficiency virus groups diverged is almost 100 times more recent than the estimate based on the geographic isolation of their host species (Wertheim and Worobey 2009; Worobey et al. 2010) . These examples, along with other similar discrepancies with measles virus (Furuse, Suzuki, and Oshitani 2010) , coronavirus (Wertheim et al. 2013) , and hepatitis B virus (Fares and Holmes 2002; Holmes 2003) , indicate that phylogenetic methods have a systematic bias toward underestimation of deep branches.",
            "cite_spans": [
                {
                    "start": 98,
                    "end": 121,
                    "text": "(Yang and Rannala 2012)",
                    "ref_id": null
                },
                {
                    "start": 315,
                    "end": 345,
                    "text": "(Zuckerkandl and Pauling 1965;",
                    "ref_id": "BIBREF68"
                },
                {
                    "start": 346,
                    "end": 367,
                    "text": "Drummond et al. 2006)",
                    "ref_id": "BIBREF10"
                },
                {
                    "start": 482,
                    "end": 502,
                    "text": "Holmes, and Ho 2014;",
                    "ref_id": "BIBREF12"
                },
                {
                    "start": 503,
                    "end": 518,
                    "text": "Ho et al. 2015;",
                    "ref_id": "BIBREF26"
                },
                {
                    "start": 519,
                    "end": 550,
                    "text": "Aiewsakun and Katzourakis 2016)",
                    "ref_id": "BIBREF0"
                },
                {
                    "start": 842,
                    "end": 863,
                    "text": "(Carroll et al. 2013;",
                    "ref_id": "BIBREF7"
                },
                {
                    "start": 864,
                    "end": 883,
                    "text": "Taylor et al. 2014)",
                    "ref_id": "BIBREF58"
                },
                {
                    "start": 1089,
                    "end": 1116,
                    "text": "(Wertheim and Worobey 2009;",
                    "ref_id": null
                },
                {
                    "start": 1117,
                    "end": 1137,
                    "text": "Worobey et al. 2010)",
                    "ref_id": "BIBREF64"
                },
                {
                    "start": 1214,
                    "end": 1249,
                    "text": "(Furuse, Suzuki, and Oshitani 2010)",
                    "ref_id": "BIBREF17"
                },
                {
                    "start": 1264,
                    "end": 1286,
                    "text": "(Wertheim et al. 2013)",
                    "ref_id": "BIBREF62"
                },
                {
                    "start": 1311,
                    "end": 1334,
                    "text": "(Fares and Holmes 2002;",
                    "ref_id": "BIBREF14"
                },
                {
                    "start": 1335,
                    "end": 1347,
                    "text": "Holmes 2003)",
                    "ref_id": "BIBREF27"
                }
            ],
            "ref_spans": [],
            "section": "Introduction"
        },
        {
            "text": "This underestimation occurs in part because phylogenetic models do a poor job of describing the real natural selection on protein-coding genes. These genes evolve under purifying selection to maintain the structure and function of the proteins they encode. In general, these constraints are highly idiosyncratic among sites (Echave, Spielman, and Wilke 2016) . However, most phylogenetic models try to account for these constraints using relatively simple approaches such as allowing the rate of substitution to vary across sites according to some statistical distribution Yang et al. 2000) . These models of purifying selection are usually inadequate (Duch\u00ea ne et al. 2015a; Duch\u00ea ne, Di Giallonardo, and Holmes 2015b) , potentially causing branch lengths to be severely underestimated (Halpern and Bruno 1998; Wertheim and Kosakovsky Pond 2011) .",
            "cite_spans": [
                {
                    "start": 324,
                    "end": 358,
                    "text": "(Echave, Spielman, and Wilke 2016)",
                    "ref_id": "BIBREF13"
                },
                {
                    "start": 573,
                    "end": 590,
                    "text": "Yang et al. 2000)",
                    "ref_id": "BIBREF66"
                },
                {
                    "start": 652,
                    "end": 675,
                    "text": "(Duch\u00ea ne et al. 2015a;",
                    "ref_id": "BIBREF11"
                },
                {
                    "start": 676,
                    "end": 719,
                    "text": "Duch\u00ea ne, Di Giallonardo, and Holmes 2015b)",
                    "ref_id": "BIBREF12"
                },
                {
                    "start": 787,
                    "end": 811,
                    "text": "(Halpern and Bruno 1998;",
                    "ref_id": "BIBREF22"
                },
                {
                    "start": 812,
                    "end": 846,
                    "text": "Wertheim and Kosakovsky Pond 2011)",
                    "ref_id": "BIBREF62"
                }
            ],
            "ref_spans": [],
            "section": "Introduction"
        },
        {
            "text": "More recent work has used mutation-selection models to better account for purifying selection (Halpern and Bruno 1998; Yang and Nielsen 2008; Rodrigue, Philippe, and Lartillot 2010; Tamuri, dos Reis, and Goldstein 2012; McCandlish and Stoltzfus 2014) . These models explicitly incorporate the fact that different protein sites prefer different amino acids, and so can improve phylogenetic estimates when there are deep branches (Philippe and Laurent 1998; Lartillot, Brinkmann, and Philippe 2007; Le, Lartillot, and Gascuel 2008; Quang, Gascuel, and Lartillot 2008; Wang et al. 2008; Susko, Lincker, and Roger 2018) . However, these approaches require inferring the site-specific purifying selection from natural sequence data.",
            "cite_spans": [
                {
                    "start": 94,
                    "end": 118,
                    "text": "(Halpern and Bruno 1998;",
                    "ref_id": "BIBREF22"
                },
                {
                    "start": 119,
                    "end": 141,
                    "text": "Yang and Nielsen 2008;",
                    "ref_id": "BIBREF66"
                },
                {
                    "start": 142,
                    "end": 181,
                    "text": "Rodrigue, Philippe, and Lartillot 2010;",
                    "ref_id": "BIBREF47"
                },
                {
                    "start": 182,
                    "end": 219,
                    "text": "Tamuri, dos Reis, and Goldstein 2012;",
                    "ref_id": "BIBREF57"
                },
                {
                    "start": 220,
                    "end": 250,
                    "text": "McCandlish and Stoltzfus 2014)",
                    "ref_id": "BIBREF33"
                },
                {
                    "start": 428,
                    "end": 455,
                    "text": "(Philippe and Laurent 1998;",
                    "ref_id": "BIBREF41"
                },
                {
                    "start": 456,
                    "end": 496,
                    "text": "Lartillot, Brinkmann, and Philippe 2007;",
                    "ref_id": "BIBREF29"
                },
                {
                    "start": 497,
                    "end": 529,
                    "text": "Le, Lartillot, and Gascuel 2008;",
                    "ref_id": "BIBREF30"
                },
                {
                    "start": 530,
                    "end": 565,
                    "text": "Quang, Gascuel, and Lartillot 2008;",
                    "ref_id": "BIBREF45"
                },
                {
                    "start": 566,
                    "end": 583,
                    "text": "Wang et al. 2008;",
                    "ref_id": "BIBREF61"
                },
                {
                    "start": 584,
                    "end": 615,
                    "text": "Susko, Lincker, and Roger 2018)",
                    "ref_id": "BIBREF56"
                }
            ],
            "ref_spans": [],
            "section": "Introduction"
        },
        {
            "text": "Even more recently, it has become possible to directly measure purifying selection on proteins using deep mutational scanning. This high-throughput approach involves experimentally measuring how each amino-acid mutation affects protein function in the lab (Fowler and Fields 2014) . The resulting experimental measurements of which amino acids are preferred at each protein site can be used to inform phylogenetic substitution models (Bloom 2014a) . These experimentally informed codon models (ExpCMs) generally exhibit much better phylogenetic fit than standard substitution models (Doud, Ashenberg, and Bloom 2015; Hilton, Doud, and Bloom 2017; Haddox et al. 2018; Lee et al. 2018 ).",
            "cite_spans": [
                {
                    "start": 256,
                    "end": 280,
                    "text": "(Fowler and Fields 2014)",
                    "ref_id": "BIBREF16"
                },
                {
                    "start": 434,
                    "end": 447,
                    "text": "(Bloom 2014a)",
                    "ref_id": "BIBREF5"
                },
                {
                    "start": 583,
                    "end": 616,
                    "text": "(Doud, Ashenberg, and Bloom 2015;",
                    "ref_id": "BIBREF9"
                },
                {
                    "start": 617,
                    "end": 646,
                    "text": "Hilton, Doud, and Bloom 2017;",
                    "ref_id": "BIBREF25"
                },
                {
                    "start": 647,
                    "end": 666,
                    "text": "Haddox et al. 2018;",
                    "ref_id": "BIBREF21"
                },
                {
                    "start": 667,
                    "end": 682,
                    "text": "Lee et al. 2018",
                    "ref_id": "BIBREF31"
                }
            ],
            "ref_spans": [],
            "section": "Introduction"
        },
        {
            "text": "Here we examine how ExpCMs and other models of purifying selection estimate branch lengths on a phylogenetic tree of influenza virus hemagglutinin (HA). We find that ExpCMs estimate longer deep branches, and show that this extension of branch length is mostly independent and additive with that achieved by the more conventional approach of modeling rate variation. We also show that ExpCMs estimate similar branch lengths to a mutation-selection model that infers the aminoacid preferences from the natural sequence data rather than using values obtained in experiments. However, all of these mutation-selection models are limited by their failure to account for another feature of purifying selection: the fact that a site's amino-acid preferences shift over time due to epistasis. Therefore, truly accurate analyses of deep phylogenies need to account for the fact that amino-acid preferences vary across time as well as across sites.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Introduction"
        },
        {
            "text": "Here we consider how purifying selection is handled by codon models, which are the most sophisticated of the three classes (nucleotide, codon, and amino acid) of phylogenetic substitution models in widespread use for protein-coding genes (Arenas 2015) . Standard codon models distinguish between two types of substitutions: synonymous and nonsynonymous. The relative rate of these substitutions is referred to as dN/dS or x. In their simplest form, codon substitution models fit a single x that represents the gene-wide average fixation rate of nonsynonymous mutations relative to synonymous ones. Here we will use such substitution models in the form proposed by Goldman and Yang (1994) . When these models have a single gene-wide x they are classified as M0 by Yang et al. (2000) . We will refer to M0 Goldman-Yang models simply as GY94 models (Equation 1). The gene-wide x is usually < 1 (Murrell et al. 2015) , and crudely represents the fact that many amino-acid substitutions are under purifying selection.",
            "cite_spans": [
                {
                    "start": 238,
                    "end": 251,
                    "text": "(Arenas 2015)",
                    "ref_id": "BIBREF1"
                },
                {
                    "start": 664,
                    "end": 687,
                    "text": "Goldman and Yang (1994)",
                    "ref_id": "BIBREF18"
                },
                {
                    "start": 763,
                    "end": 781,
                    "text": "Yang et al. (2000)",
                    "ref_id": "BIBREF66"
                },
                {
                    "start": 891,
                    "end": 912,
                    "text": "(Murrell et al. 2015)",
                    "ref_id": "BIBREF34"
                }
            ],
            "ref_spans": [],
            "section": "Different ways substitution models account for purifying selection"
        },
        {
            "text": "A single gene-wide x ignores the fact that purifying selection is heterogeneous across sites. The most common strategy to ameliorate this defect is to allow x to vary among sites according to some statistical distribution Yang et al. 2000) . For instance, in the M5 variant of the GY94 model (Yang et al. 2000 ), x follows a gamma distribution as shown in Fig. 1a . We will denote this model as GY94\u00feCx. A GY94\u00feCx captures the fact that the rate of nonsynonymous substitution can vary across sites. However, these models do not capture the fact that the same amino-acid mutation can have very different effects at different sites.",
            "cite_spans": [
                {
                    "start": 222,
                    "end": 239,
                    "text": "Yang et al. 2000)",
                    "ref_id": "BIBREF66"
                },
                {
                    "start": 292,
                    "end": 309,
                    "text": "(Yang et al. 2000",
                    "ref_id": "BIBREF66"
                }
            ],
            "ref_spans": [
                {
                    "start": 356,
                    "end": 363,
                    "text": "Fig. 1a",
                    "ref_id": null
                }
            ],
            "section": "Different ways substitution models account for purifying selection"
        },
        {
            "text": "Mutation-selection models account for the fact that purifying selection depends idiosyncratically on the specific aminoacid mutation at each site (Halpern and Bruno 1998; Yang and Nielsen 2008; Rodrigue, Philippe, and Lartillot 2010; Tamuri, dos Reis, and Goldstein 2012; McCandlish and Stoltzfus 2014) . Here we will consider mutation-selection models where the sitespecific selection is assumed to act solely at the protein level (different codons for the same amino acid are treated as selectively equivalent). Such models explicitly define a different set of amino-acid preferences at each site in the protein. This more mechanistic formulation results in a site-specific stationary state (Fig. 1b) . These models capture the site-to-site variation in amino-acid composition that is an obvious features of real proteins, and usually better describe actual evolution than models with only rate variation as assessed by Bayesian or maximumlikelihood criteria (Lartillot and Philippe 2004; Le, Lartillot, and Gascuel 2008; Quang, Gascuel, and Lartillot 2008; Wang et al. 2008; Rodrigue, Philippe, and Lartillot 2010; Bloom 2014a,b; Hilton, Doud, and Bloom 2017) .",
            "cite_spans": [
                {
                    "start": 146,
                    "end": 170,
                    "text": "(Halpern and Bruno 1998;",
                    "ref_id": "BIBREF22"
                },
                {
                    "start": 171,
                    "end": 193,
                    "text": "Yang and Nielsen 2008;",
                    "ref_id": "BIBREF66"
                },
                {
                    "start": 194,
                    "end": 233,
                    "text": "Rodrigue, Philippe, and Lartillot 2010;",
                    "ref_id": "BIBREF47"
                },
                {
                    "start": 234,
                    "end": 271,
                    "text": "Tamuri, dos Reis, and Goldstein 2012;",
                    "ref_id": "BIBREF57"
                },
                {
                    "start": 272,
                    "end": 302,
                    "text": "McCandlish and Stoltzfus 2014)",
                    "ref_id": "BIBREF33"
                },
                {
                    "start": 961,
                    "end": 990,
                    "text": "(Lartillot and Philippe 2004;",
                    "ref_id": "BIBREF29"
                },
                {
                    "start": 991,
                    "end": 1023,
                    "text": "Le, Lartillot, and Gascuel 2008;",
                    "ref_id": "BIBREF30"
                },
                {
                    "start": 1024,
                    "end": 1059,
                    "text": "Quang, Gascuel, and Lartillot 2008;",
                    "ref_id": "BIBREF45"
                },
                {
                    "start": 1060,
                    "end": 1077,
                    "text": "Wang et al. 2008;",
                    "ref_id": "BIBREF61"
                },
                {
                    "start": 1078,
                    "end": 1117,
                    "text": "Rodrigue, Philippe, and Lartillot 2010;",
                    "ref_id": "BIBREF47"
                },
                {
                    "start": 1118,
                    "end": 1132,
                    "text": "Bloom 2014a,b;",
                    "ref_id": null
                },
                {
                    "start": 1133,
                    "end": 1162,
                    "text": "Hilton, Doud, and Bloom 2017)",
                    "ref_id": "BIBREF25"
                }
            ],
            "ref_spans": [
                {
                    "start": 693,
                    "end": 702,
                    "text": "(Fig. 1b)",
                    "ref_id": null
                }
            ],
            "section": "Different ways substitution models account for purifying selection"
        },
        {
            "text": "However, the increased realism of mutation-selection models comes at the cost of an increased number of parameters. Codon substitution models with uniform stationary states have only a modest number of parameters that must be fit from the phylogenetic data. For instance, a GY94\u00feCx model with the commonly used F3X4 stationary state has 12 parameters: two describing the shape of the gamma distribution over x, a transitiontransversion rate, and nine parameters describing the nucleotide composition of the stationary state. However, mutation-selection models must additionally specify 19 parameters defining the amino-acid preferences for each site (there are 20 amino acids whose preferences are constrained to sum to one). This corresponds to 19 \u00c2 L parameters for a protein of length L, or 9,500 parameters for a 500-residue protein. It is challenging to obtain values for these amino-acid preference parameters in a maximum-likelihood framework without overfitting the data (Rodrigue 2013) . Here we will primarily use ExpCMs, which define the site-specific amino-acid preference parameters a priori from deep mutational scanning experiments so that they do not need to be fit from phylogenetic data (see Section 4 and Bloom 2014a Bloom , 2017 Hilton, Doud, and Bloom 2017) . Because the amino-acid preference parameters in an ExpCM are obtained from experiments, the number of ExpCM free parameters is similar to a nonsite-specific substitution model. An alternative strategy to account for site-specific amino-acid preferences is to formally consider them as random effects across sites, rather than parameters, and infer them using Bayesian methods (Lartillot and Philippe 2004; Rodrigue and Lartillot 2014) . This strategy is discussed in Section 2.6. Importantly, these two strategies for modeling purifying selection are not mutually exclusive. Mutation-selection models such as an ExpCM can still incorporate an x parameter, which now represents the relative rate of nonsynonymous to synonymous substitution after accounting for the constraints due to the site-specific amino-acid preferences (Bloom 2017; Rodrigue and Lartillot 2017) . This x parameter for an ExpCM can be drawn from a statistical distribution (e.g., a gamma distribution) just like for GY94-style models (Rodrigue and Lartillot 2014; Haddox et al. 2018 ). We will denote such models as ExpCM\u00feCx. Figure 1c shows the full spectrum of models that incorporate all combinations of gamma-distributed x and site-specific stationary states.",
            "cite_spans": [
                {
                    "start": 979,
                    "end": 994,
                    "text": "(Rodrigue 2013)",
                    "ref_id": "BIBREF47"
                },
                {
                    "start": 1224,
                    "end": 1235,
                    "text": "Bloom 2014a",
                    "ref_id": "BIBREF5"
                },
                {
                    "start": 1236,
                    "end": 1248,
                    "text": "Bloom , 2017",
                    "ref_id": "BIBREF5"
                },
                {
                    "start": 1249,
                    "end": 1278,
                    "text": "Hilton, Doud, and Bloom 2017)",
                    "ref_id": "BIBREF25"
                },
                {
                    "start": 1657,
                    "end": 1686,
                    "text": "(Lartillot and Philippe 2004;",
                    "ref_id": "BIBREF29"
                },
                {
                    "start": 1687,
                    "end": 1715,
                    "text": "Rodrigue and Lartillot 2014)",
                    "ref_id": "BIBREF47"
                },
                {
                    "start": 2105,
                    "end": 2117,
                    "text": "(Bloom 2017;",
                    "ref_id": "BIBREF5"
                },
                {
                    "start": 2118,
                    "end": 2146,
                    "text": "Rodrigue and Lartillot 2017)",
                    "ref_id": "BIBREF47"
                },
                {
                    "start": 2285,
                    "end": 2314,
                    "text": "(Rodrigue and Lartillot 2014;",
                    "ref_id": "BIBREF47"
                },
                {
                    "start": 2315,
                    "end": 2333,
                    "text": "Haddox et al. 2018",
                    "ref_id": "BIBREF21"
                }
            ],
            "ref_spans": [
                {
                    "start": 2377,
                    "end": 2386,
                    "text": "Figure 1c",
                    "ref_id": null
                }
            ],
            "section": "Different ways substitution models account for purifying selection"
        },
        {
            "text": "Given a single branch, a substitution model transforms sequence divergence into branch length. Under a molecular-clock assumption, this branch length is proportional to time. The transformation from sequence divergence to branch length is trivial when the sequence identity is high. For instance, when there has only been one substitution, then the sequence identity will simply be \u00f0L \u00c0 1\u00de=L for a gene of L sites, and even a simple exponential model (Zuckerkandl and Pauling 1965) will correctly infer the short branch length of 1=L substitutions per site. However, as substitutions accumulate it becomes progressively more likely for multiple changes to occur at the same site. In this regime, the accuracy of the substitution model becomes critical for transforming sequence divergence into branch length. Any time-homogenous substitution model predicts that after a very large number of substitutions, two related sequences will approach some asymptotic amino-acid sequence identity. For instance, if all 20 amino acids are equally likely in the stationary state, then this asymptotic sequence identity will be 1 20 \u00bc 0:05. If the substitution model underestimates the asymptotic sequence identity then it will also underestimate long-branch lengths, since it will predict that sequences that have evolved for a very long time should be more diverged than is actually the case. Figure 2 shows how different substitution models predict amino-acid sequence identity to decrease as a function of branch length using model parameters fit to a phylogeny of H1 influenza HA genes. The GY94 model predicts the same behavior for all sites, since it does not have any site-specific parameters, with an asymptotic sequence identity of 0.062. While this predicted sequence identity is higher than 1 20 \u00bc 0:05 due to redundant codon and nucleotide biases favoring certain amino acids, it is much lower than the pairwise identity of even the most diverged HAs in nature. While it is of course possible that the identity of HAs in nature would become even lower given more time, it seems biochemically improbable that it would ever become as low as 0.062. The reason is that like many proteins HA has a highly conserved structure and function that imposes constraints that cause many sites to sample only a small subset of the 20 amino acids among all known HA homologs (Nobusawa et al. 1991) .",
            "cite_spans": [
                {
                    "start": 451,
                    "end": 481,
                    "text": "(Zuckerkandl and Pauling 1965)",
                    "ref_id": "BIBREF68"
                },
                {
                    "start": 2360,
                    "end": 2382,
                    "text": "(Nobusawa et al. 1991)",
                    "ref_id": "BIBREF36"
                }
            ],
            "ref_spans": [
                {
                    "start": 1382,
                    "end": 1390,
                    "text": "Figure 2",
                    "ref_id": null
                }
            ],
            "section": "Effect of stationary state and rate variation on branch-length estimation"
        },
        {
            "text": "Accounting for site-to-site dN/dS rate variation in GY94 models affects the rate at which the asymptotic sequence identity is approached, but not the actual value of this asymptote. For instance, Fig. 2 shows that the GY94\u00feCx model takes longer to reach the asymptote than GY94, but that the asymptote is identical for both models. This fact holds true even if we use experimental measurements of HA's site-specific amino-acid preferences (Doud and Bloom 2016) to calculate a different x r value for each site using the method of Spielman and Wilke (2015b) (see Equation 7). Specifically, this GY94\u00fex r model predicts that different sites will approach the asymptote at different rates, but the asymptote is always the same (Fig. 2) . The invariance of the asymptotic sequence identity under different schemes for modeling x is a fundamental feature of the mathematics of this type of reversible substitution model. These models are reversible stochastic matrices, which can be decomposed into stationary states and symmetric exchangeability matrices (Nielsen 2006) . The stationary state is invariant with respect to multiplication of the symmetric exchangeability matrix by any nonzero number. Different schemes for modeling (a) ( b) ( c) Figure 1 . Different ways codon models account for purifying selection. (a) The dN/dS parameter, x, can be defined as one gene-wide average (orange triangle) or allowed to vary according to some statistical distribution (blue line). For computational tractability, the distribution is discretized into K bins and x takes on the mean of each bin (blue circles) Yang et al. 2000) . A gamma distribution (denoted by C) with K \u00bc 4 bins is shown here. (b) A substitution model's stationary state defines the expected sequence composition after a very long evolutionary time. Most substitution models have stationary states that are uniform across sites.",
            "cite_spans": [
                {
                    "start": 439,
                    "end": 460,
                    "text": "(Doud and Bloom 2016)",
                    "ref_id": "BIBREF9"
                },
                {
                    "start": 1051,
                    "end": 1065,
                    "text": "(Nielsen 2006)",
                    "ref_id": "BIBREF35"
                },
                {
                    "start": 1601,
                    "end": 1618,
                    "text": "Yang et al. 2000)",
                    "ref_id": "BIBREF66"
                }
            ],
            "ref_spans": [
                {
                    "start": 196,
                    "end": 202,
                    "text": "Fig. 2",
                    "ref_id": null
                },
                {
                    "start": 724,
                    "end": 732,
                    "text": "(Fig. 2)",
                    "ref_id": null
                },
                {
                    "start": 1241,
                    "end": 1249,
                    "text": "Figure 1",
                    "ref_id": null
                }
            ],
            "section": "Effect of stationary state and rate variation on branch-length estimation"
        },
        {
            "text": "However, substitution models can have site-specific stationary states. In the logo plots, each column is a site in the protein and the height of each letter is the frequency of that amino acid at stationary state. (c) Substitution models can incorporate neither, one, or both of these features. Here we will use substitution models from the Goldman-Yang (GY94; Goldman and Yang 1994; Yang et al. 2000) and ExpCM (Hilton, Doud, and Bloom 2017) families with and without gamma-distributed x to represent all possible combinations.",
            "cite_spans": [
                {
                    "start": 361,
                    "end": 383,
                    "text": "Goldman and Yang 1994;",
                    "ref_id": "BIBREF18"
                },
                {
                    "start": 384,
                    "end": 401,
                    "text": "Yang et al. 2000)",
                    "ref_id": "BIBREF66"
                },
                {
                    "start": 412,
                    "end": 442,
                    "text": "(Hilton, Doud, and Bloom 2017)",
                    "ref_id": "BIBREF25"
                }
            ],
            "ref_spans": [],
            "section": "Effect of stationary state and rate variation on branch-length estimation"
        },
        {
            "text": "x only multiply elements of the symmetric exchangeability matrix. Therefore, no matter how 'well' a model accounts for siteto-site variation in x, it will always have the same stationary state as a simple GY94 model. However, mutation-selection models such as ExpCMs have site-specific stationary states. They predict that different sites will have different asymptotic sequence identities (Fig. 2 )-a prediction that accords with the empirical observation that some sites are much more variable than others in alignments of highly diverged sequences. For instance, Fig. 2 shows that at sites such as 183 and 305 in the H1 HA, an ExpCM but not a GY94-style model predicts that the identity will always be relatively high. When sites with highly constrained amino-acid preferences such as these are common, an ExpCM can estimate a long-branch length at modest sequence identities that a GY94 model might attribute to a shorter branch.",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 390,
                    "end": 397,
                    "text": "(Fig. 2",
                    "ref_id": null
                },
                {
                    "start": 566,
                    "end": 572,
                    "text": "Fig. 2",
                    "ref_id": null
                }
            ],
            "section": "Effect of stationary state and rate variation on branch-length estimation"
        },
        {
            "text": "To directly demonstrate the effect of stationary state and Cx rate variation on branch-length estimation, we tested the ability of a variety of models to accurately infer branch lengths on simulated data (Fig. 3) . Specifically, we simulated alignments of sequences along the HA phylogenetic tree using an ExpCM parameterized by the amino-acid preferences of H1 HA as experimentally measured by deep mutational scanning (Doud and Bloom 2016) . We then estimated the branch lengths from the simulated sequences using all the substitution models in Fig. 1c , and compared these estimates to the actual branch lengths used in the simulations. Note that these simulations closely parallel those performed by Halpern and Bruno (1998) and Wertheim and Kosakovsky Pond (2011) .",
            "cite_spans": [
                {
                    "start": 420,
                    "end": 441,
                    "text": "(Doud and Bloom 2016)",
                    "ref_id": "BIBREF9"
                },
                {
                    "start": 704,
                    "end": 728,
                    "text": "Halpern and Bruno (1998)",
                    "ref_id": "BIBREF22"
                },
                {
                    "start": 733,
                    "end": 768,
                    "text": "Wertheim and Kosakovsky Pond (2011)",
                    "ref_id": "BIBREF62"
                }
            ],
            "ref_spans": [
                {
                    "start": 204,
                    "end": 212,
                    "text": "(Fig. 3)",
                    "ref_id": "FIGREF0"
                },
                {
                    "start": 547,
                    "end": 554,
                    "text": "Fig. 1c",
                    "ref_id": null
                }
            ],
            "section": "Simulations demonstrate how failure to model sitespecific amino-acid preferences leads to branch-length underestimation"
        },
        {
            "text": "The models with a uniform stationary state underestimated the lengths of long branches on the phylogenetic tree of the simulated sequences (Fig. 3 ). The GY94 model estimated branch lengths that are $60 per cent of the true values for the longest branches. Accounting for site-to-site variation in x did not fix the fundamental problem: the GY94\u00feCx did slightly better, but still substantially underestimated the longest branches. However, there was no systematic underestimation of long branches by the ExpCM and ExpCM\u00feCx models. The improved performance of the ExpCMs is due to their modeling of the sitespecific amino-acid preferences: if we parameterize ExpCMs by amino-acid preferences that have been averaged across HA sites (and so are no longer site-specific), then they perform no better than GY94 models (Fig. 3) . Therefore, models with uniform stationary states underestimate the length of long branches in phylogenies of sequences that have evolved under strong site-specific amino-acid preferences.",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 139,
                    "end": 146,
                    "text": "(Fig. 3",
                    "ref_id": "FIGREF0"
                },
                {
                    "start": 814,
                    "end": 822,
                    "text": "(Fig. 3)",
                    "ref_id": "FIGREF0"
                }
            ],
            "section": "Simulations demonstrate how failure to model sitespecific amino-acid preferences leads to branch-length underestimation"
        },
        {
            "text": "The foregoing section shows the superiority of ExpCMs to GY94 models for estimating long branches on phylogenies simulated with ExpCMs. But how do these models perform on real data? Real genes do evolve under functional constraint, but these constraints are almost certainly more complex than what is modeled by an ExpCM. However, if ExpCMs do a substantially better job than GY94 models of capturing the true constraints, then we might still expect them to estimate more accurate branch lengths.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Experimentally informed site-specific models estimate longer branches on real data"
        },
        {
            "text": "To test the models on real data, we used actual sequences of influenza HA. The topology of HA phylogenetic trees makes these sequences an interesting test case for branch-length estimation. HA consists of a number of different subtypes. Sequences within a subtype have >68 per cent amino-acid identity, but sequences in different subtypes have as little as 38 per cent identity. However, HA proteins from all subtypes have a highly conserved structure that performs a highly conserved function (Ha et al. 2002; Russell et al. 2004) . We used RAxML (Stamatakis 2006) with a nucleotide substitution model (GTRCAT) to infer a phylogenetic tree for 92 HA sequences drawn from 15 of the 18 subtypes (we excluded bat influenza and one other rare subtype). For the rest of this article, we fix the tree topology to this RAxML-inferred tree. Although the nucleotide model used with RAxML to infer this tree topology is probably less accurate than codon models, the modular subtype structure of the HA phylogeny (the tree is clearly divided into Figure 2 . Effect of stationary state and Cx rate variation on predicted asymptotic sequence divergence. The logo plots at top show the amino-acid preferences for some sites in an H1 influenza HA protein as experimentally measured by Doud and Bloom (2016) . The graphs show the expected amino-acid identity at that site for two sequences separated by a branch of the indicated length (Equation 9). For the GY94 model, the graphs are identical for all sites since this model does not have site-specific parameters; the same is true for GY94\u00feCx. The graphs do differ among sites if we calculate a different x r for each site r in the GY94 model using the amino-acid preferences (Equation 7; Spielman and Wilke 2015b). However, all GY94 models, including the one with site-specific x r values, approach the same asymptote since they all have the same stationary state. The ExpCM has different asymptotes for different sites since it accounts for how amino-acid preferences lead to site-specific stationary states.",
            "cite_spans": [
                {
                    "start": 494,
                    "end": 510,
                    "text": "(Ha et al. 2002;",
                    "ref_id": "BIBREF20"
                },
                {
                    "start": 511,
                    "end": 531,
                    "text": "Russell et al. 2004)",
                    "ref_id": "BIBREF48"
                },
                {
                    "start": 548,
                    "end": 565,
                    "text": "(Stamatakis 2006)",
                    "ref_id": "BIBREF52"
                },
                {
                    "start": 1271,
                    "end": 1292,
                    "text": "Doud and Bloom (2016)",
                    "ref_id": "BIBREF9"
                }
            ],
            "ref_spans": [
                {
                    "start": 1037,
                    "end": 1045,
                    "text": "Figure 2",
                    "ref_id": null
                }
            ],
            "section": "Experimentally informed site-specific models estimate longer branches on real data"
        },
        {
            "text": "widely separated clades) means that most of the phylogenetic uncertainty lies in the length of the long branches separating the subtypes rather than in the tree topology itself. We note that other genes may have phylogenetic structures that are more prone to topological uncertainty. In such cases, the accuracy of the substitution model may be important for avoiding topological errors such as long-branch attraction (Felsenstein 1978; Lartillot, Brinkmann, and Philippe 2007) .",
            "cite_spans": [
                {
                    "start": 418,
                    "end": 436,
                    "text": "(Felsenstein 1978;",
                    "ref_id": "BIBREF15"
                },
                {
                    "start": 437,
                    "end": 477,
                    "text": "Lartillot, Brinkmann, and Philippe 2007)",
                    "ref_id": "BIBREF29"
                }
            ],
            "ref_spans": [],
            "section": "Experimentally informed site-specific models estimate longer branches on real data"
        },
        {
            "text": "Deep mutational scanning has been used to measure the amino-acid preferences of all sites in two different HAs. One scan measured the preferences of an H1 HA (Doud and Bloom 2016) and the other measured the preferences of an H3 HA (Lee et al. 2018 ). The amino-acid preferences measured for these two HAs are shown in Supplementary Figs S1 and S2. The H1 and H3 HAs have only $42 per cent amino-acid identity. As described in Lee et al. (2018) , the amino-acid preferences clearly differ between the H1 and H3 HA at a substantial number of sites (these differences are apparent in a simple visual comparison of Supplementary Figs S1 and S2; see site 33 as an example). Therefore, we also created a third set of amino-acid preferences by averaging the measurements for the H1 and H3 HAs, under the conjecture that these averaged preferences might better describe the 'average' constraint on sites across the full HA tree ( Supplementary Fig. S3 ). These three sets of HA amino-acid preferences define three different ExpCMs.",
            "cite_spans": [
                {
                    "start": 158,
                    "end": 179,
                    "text": "(Doud and Bloom 2016)",
                    "ref_id": "BIBREF9"
                },
                {
                    "start": 231,
                    "end": 247,
                    "text": "(Lee et al. 2018",
                    "ref_id": "BIBREF31"
                },
                {
                    "start": 426,
                    "end": 443,
                    "text": "Lee et al. (2018)",
                    "ref_id": "BIBREF31"
                }
            ],
            "ref_spans": [
                {
                    "start": 922,
                    "end": 943,
                    "text": "Supplementary Fig. S3",
                    "ref_id": "FIGREF0"
                }
            ],
            "section": "Experimentally informed site-specific models estimate longer branches on real data"
        },
        {
            "text": "We fit the GY94 model and each of the three ExpCMs to the fixed HA tree topology estimated using RAxML, and also tested a version of each model with Cx rate variation. Table 1 shows that all ExpCMs fit the actual data much better than the GY94 models. The best fit was for the ExpCM informed by the average of the H1 and H3 deep mutational scans. For all models, incorporating Cx rate variation improved the fit, although even ExpCMs without Cx greatly outperformed the GY94\u00feCx model (Table 1) . As mentioned in the previous section, x is generally < 1 when a single value is fit to all sites in a gene (Murrell et al. 2015) , and this is the case for all the models we tested (Table 1) . However, the ExpCMs always fit an x greater than the GY94 model, suggesting that the site-specific amino-acid preferences capture some of the purifying selection that the GY94 models can represent only via a small x. Among the models with Cx, the GY94\u00feCx model fits all four x categories to values (1, but the ExpCM\u00feCx models fit one of the x categories to a value > 1. This increase in x values makes sense given the different interpretation of x for each family of models. The ExpCM x is the relative rate of fixation of nonsynonymous to synonymous mutations after accounting for the functional constraints described by the amino-acid preferences. This more realistic null model gives ExpCMs enhanced power to detect diversifying selection for amino-acid change (Bloom 2017; Rodrigue and Lartillot 2017) , which is known to occur at some sites in HA due to immune selection (Bedford et al. 2014) .",
            "cite_spans": [
                {
                    "start": 603,
                    "end": 624,
                    "text": "(Murrell et al. 2015)",
                    "ref_id": "BIBREF34"
                },
                {
                    "start": 1453,
                    "end": 1465,
                    "text": "(Bloom 2017;",
                    "ref_id": "BIBREF5"
                },
                {
                    "start": 1466,
                    "end": 1494,
                    "text": "Rodrigue and Lartillot 2017)",
                    "ref_id": "BIBREF47"
                },
                {
                    "start": 1565,
                    "end": 1586,
                    "text": "(Bedford et al. 2014)",
                    "ref_id": "BIBREF4"
                }
            ],
            "ref_spans": [
                {
                    "start": 168,
                    "end": 175,
                    "text": "Table 1",
                    "ref_id": "TABREF0"
                },
                {
                    "start": 484,
                    "end": 493,
                    "text": "(Table 1)",
                    "ref_id": "TABREF0"
                },
                {
                    "start": 677,
                    "end": 686,
                    "text": "(Table 1)",
                    "ref_id": "TABREF0"
                }
            ],
            "section": "Experimentally informed site-specific models estimate longer branches on real data"
        },
        {
            "text": "Importantly, models that account for purifying selection via either Cx rate variation or site-specific amino-acid preferences do not just exhibit better fit-they also estimate longer branches on the HA tree. Figure 4 shows the branch lengths optimized by each model on a common scale. The tree's deepest branches are shortest when they are optimized by the GY94 model, which lacks both Cx and site-specific amino-acid preferences. Adding either Cx rate variation or site-specific aminoacid preferences increases the length of the deep branches. Specifically, the tree's diameter (the distance between the two most divergent tips) for the GY94\u00feCx model is 159 per cent of the GY94 model tree diameter (Supplementary Table S1 ). The tree diameter is 122 per cent and 135 per cent of the GY94 model tree diameter for ExpCMs informed by H1 or H3 amino-acid preferences, respectively, and 160 per cent of the GY94 model for the ExpCM informed by the average of the H1 and H3 preferences (Supplementary Table S1 ).",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 208,
                    "end": 216,
                    "text": "Figure 4",
                    "ref_id": "FIGREF1"
                },
                {
                    "start": 700,
                    "end": 723,
                    "text": "(Supplementary Table S1",
                    "ref_id": "TABREF0"
                },
                {
                    "start": 997,
                    "end": 1005,
                    "text": "Table S1",
                    "ref_id": "TABREF0"
                }
            ],
            "section": "Experimentally informed site-specific models estimate longer branches on real data"
        },
        {
            "text": "The deepening of branch lengths that results from the Cx and site-specific amino-acid preference approaches to modeling purifying selection are largely independent. This can be seen by examining the ExpCM\u00feCx models, which combine Cx rate variation with site-specific amino-acid preferences. As shown in Fig. 4 , these ExpCM\u00feCx models estimate longer branches than models with just Cx rate variation (GY94\u00feCx) or just site-specific amino-acid preferences (ExpCMs). The near independence of these effects is quantified in Supplementary Table S1, which shows that 76 per cent of the tree diameter extension of ExpCM(H1\u00feH3 avg)\u00feCx versus can be explained by simply adding the extension from incorporating Cx (GY94\u00feCx versus GY94) to the extension from incorporating site-specific amino-acid preferences (compare ExpCM(H1\u00feH3 avg) to GY94).",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 303,
                    "end": 309,
                    "text": "Fig. 4",
                    "ref_id": "FIGREF1"
                }
            ],
            "section": "Experimentally informed site-specific models estimate longer branches on real data"
        },
        {
            "text": "However, while adding Cx rate variation increases the length of deep branches in a roughly uniform fashion across the tree, the branch lengthening from adding site-specific amino-acid preferences is not uniform across the tree (Figs 4 and 5) . Instead, the increase in branch length is most pronounced on branches leading to the HA sequence that was used in the deep mutational scanning experiment that informed the ExpCM. For instance, the ExpCM informed by the H1 data most dramatically lengthens branches near the H1 clade of the tree, while the ExpCM informed by the H3 data has the largest effect on branches near the H3 clade. The ExpCM informed by the average of the H1 and H3 data has a more uniform effect across the tree, but still most strongly extends branches leading to either the H1 or H3 clade. Therefore, Figs 4 and 5 show that ExpCMs estimate longer branches, but that the effect is shaped by the set of amino-acid preferences used to inform the model.",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 227,
                    "end": 241,
                    "text": "(Figs 4 and 5)",
                    "ref_id": "FIGREF1"
                }
            ],
            "section": "Experimentally informed site-specific models estimate longer branches on real data"
        },
        {
            "text": "2.5 Shifting amino-acid preferences limit the benefits of models with site-specific stationary states for estimating long-branch lengths",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Experimentally informed site-specific models estimate longer branches on real data"
        },
        {
            "text": "The fact that an ExpCM leads to the most profound increase in branch length leading to the sequence used in the experiment can be rationalized in terms of existing knowledge about epistasis during protein evolution. Each ExpCM is informed by a single set of experimentally measured amino-acid preferences. But in reality, the effect of a mutation at one site in a protein can depend on the amino-acid identities of other sites in the protein 7,892 \u00c055,025 0.07 -Notes: All ExpCMs describe the evolution of HA better than the GY94 models, as evaluated by the Akaike information criteria (DAIC, Posada and Buckley 2004) . The models fit here are the same ones in Fig. 4 . The x value for each of the K \u00bc 4 bins is shown for the models with Cx rate variation. All ExpCMs fit a stringency parameter > 1. Because the deep mutational scanning experiments that inform our ExpCMs were each performed in the context of a single HA genetic background, their measurements do not account for the accumulation of epistatic shifts in amino-acid preferences as HA evolves. Therefore, an ExpCM is expected to most accurately describe the evolution of sequences closely related to the one used in the experiment. We can observe how shifting amino-acid preferences degrade the accuracy of an ExpCM by fitting the model to trees containing increasingly diverged sequences. For both H1 and H3 HAs, we created three phylogenetic trees ( Supplementary Fig.  S5 ): a 'low' divergence tree that contains sequences with !59 per cent amino-acid identity to the HA used in the experiment, an 'intermediate' divergence tree that contains sequences with !46 per cent amino-acid identity to the HA in the experiment, and a 'high' divergence tree that contains all HAs (which have as little as 38 per cent identity to the HA in the experiment). Figure 6 shows the subtrees containing each of these sets of HA sequences. For each subtree, we examined the congruence between site-specific natural selection and the amino-acid preferences measured in the deep mutational scanning experiment using the ExpCM stringency parameter b (Bloom 2014b; Hilton, Doud, and Bloom 2017) . Values of b that are >1 indicate that natural selection prefers the same amino acids as the experiments but with a greater stringency, suggesting strong congruence between natural selection and the experimental preferences. In contrast, values of b that are <1 flatten the preferences, suggesting that they provide a relatively poor description of natural selection on the protein.",
            "cite_spans": [
                {
                    "start": 593,
                    "end": 617,
                    "text": "Posada and Buckley 2004)",
                    "ref_id": "BIBREF44"
                },
                {
                    "start": 2096,
                    "end": 2109,
                    "text": "(Bloom 2014b;",
                    "ref_id": "BIBREF5"
                },
                {
                    "start": 2110,
                    "end": 2139,
                    "text": "Hilton, Doud, and Bloom 2017)",
                    "ref_id": "BIBREF25"
                }
            ],
            "ref_spans": [
                {
                    "start": 661,
                    "end": 667,
                    "text": "Fig. 4",
                    "ref_id": "FIGREF1"
                },
                {
                    "start": 1416,
                    "end": 1438,
                    "text": "Supplementary Fig.  S5",
                    "ref_id": "FIGREF2"
                },
                {
                    "start": 1814,
                    "end": 1822,
                    "text": "Figure 6",
                    "ref_id": null
                }
            ],
            "section": "Experimentally informed site-specific models estimate longer branches on real data"
        },
        {
            "text": "The value of b decreases as the divergence from the sequence used in the deep mutational scan increases Fig. 6 . This inverse relationship between b and overall divergence is seen for the ExpCMs informed by both the H1 and H3 experiments. As b decreases, the preferences 'flatten' and so the ExpCM draws less information from the experiment. At the most extreme value of b \u00bc 0, the preferences would be perfectly uniform and look similar to the GY94 preferences in Fig. 4 . In reality, b never reaches a value this low, indicating the deep mutational scanning experiments remain somewhat informative about real natural selection across the entire swath of HAs. However, Fig. 6 shows that the amino-acid preferences clearly become less informative about natural selection as we move away from the experimental sequence on the tree. This shifting of amino-acid preferences helps explain why the ExpCM informed by the average of the H1 and H3 experiments performs best (Table 1, Figs 4 and 5): averaging the measurements across these two HAs is a heuristic method of accounting for shifts in preferences during HA evolution.",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 104,
                    "end": 110,
                    "text": "Fig. 6",
                    "ref_id": null
                },
                {
                    "start": 465,
                    "end": 471,
                    "text": "Fig. 4",
                    "ref_id": "FIGREF1"
                },
                {
                    "start": 670,
                    "end": 676,
                    "text": "Fig. 6",
                    "ref_id": null
                }
            ],
            "section": "Experimentally informed site-specific models estimate longer branches on real data"
        },
        {
            "text": "The fact that amino-acid preferences shift as a protein evolves leaves us with an inherent tension: models with sitespecific amino-acid preferences only become important for accurate branch-length estimation as sequences become increasingly diverged, but this same divergence degrades the accuracy of extrapolating the amino-acid preferences from any given experiment across the phylogenetic tree. Crucially, this problem is more fundamental than the inability of a single deep mutational scanning experiment to measure amino-acid preferences in more than one genetic background. If amino-acid preferences shift during evolution, there simply will not be any single set of time-homogeneous site-specific preferences that accurately describes evolution along the entirety of a phylogenetic tree that covers a wide span of sequences.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Experimentally informed site-specific models estimate longer branches on real data"
        },
        {
            "text": "The previous sections used ExpCMs, which are mutationselection models that use site-specific amino-acid preferences that have been measured by experiments. However, there are other mathematically similar implementations of mutationselection models that infer the amino-acid preferences directly from the natural sequence data. When these models are designed for use in phylogenetic inference, they are generally implemented in a Bayesian framework, which avoids the overfitting problems associated with trying to make maximumlikelihood estimates of the thousands of amino-acid preference parameters . (Note that the maximum-likelihood implementations of Tamuri, dos Reis, and Goldstein (2012) and Tamuri, Goldman, and dos Reis (2014) are designed for estimating the amino-acid preferences, not for phylogenetic inference.) The model most comparable to our ExpCMs is the codon mutation-selection model implemented in PhyloBayes-MPI, which we will refer to as pbMutSel (Rodrigue and Lartillot 2014) . In the pbMutSel model, the amino-acid preferences are modeled using Dirichlet processes rather than derived from experiments. However, like an ExpCM, a pbMutSel model still assumes a single set of time-homogeneous site-specific amino-acid preferences for the entire tree.",
            "cite_spans": [
                {
                    "start": 654,
                    "end": 692,
                    "text": "Tamuri, dos Reis, and Goldstein (2012)",
                    "ref_id": "BIBREF57"
                },
                {
                    "start": 697,
                    "end": 733,
                    "text": "Tamuri, Goldman, and dos Reis (2014)",
                    "ref_id": "BIBREF57"
                },
                {
                    "start": 967,
                    "end": 996,
                    "text": "(Rodrigue and Lartillot 2014)",
                    "ref_id": "BIBREF47"
                }
            ],
            "ref_spans": [],
            "section": "A model with amino-acid preferences estimated from natural sequences gives similar results to an ExpCM"
        },
        {
            "text": "Comparing ExpCM and pbMutSel models can help determine the ultimate limits of mutation-selection models that assign each site a single set of amino-acid preferences. If the limitations of ExpCMs described above arise simply because the deep mutational scanning experiments do not correctly measure the 'true' amino-acid preferences across the entirety of a highly diverged phylogenetic tree, then we would expect the pbMutSel models (which infer these preferences from the entire tree) to perform better. On the other hand, if the major limitation is that no single set of time-homogenous amino-acid preferences can fully describe evolution over the entire tree, then we would expect ExpCM and pbMutSel models to perform similarly.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "A model with amino-acid preferences estimated from natural sequences gives similar results to an ExpCM"
        },
        {
            "text": "We fit a pbMutSel model to the entire HA phylogenetic tree, and compared the results to those from analyzing the same tree with the best ExpCM, which is the ExpCM(H1\u00feH3 avg)\u00feCx variant. This is a direct apple-to-apples comparison, since the pbMutSel model also draws x from a gamma-distribution (Rodrigue and Lartillot 2014) . First, we compared the amino-acid preferences inferred by the pbMutSel model to the preferences Figure 6 . The congruence between natural selection and the deep mutational scanning measurements decreases with sequence divergence. We fit an ExpCM informed by the H1 or H3 deep mutational scanning experiments to trees spanning sequences with low, intermediate, and high divergence from the sequence used in the experiment. The ExpCM stringency parameter (b) is a measure of the congruence between natural selection and the experimental measurements (Bloom 2014b; Hilton, Doud, and Bloom 2017) . Larger values of b indicate that natural selection prefers the same amino acids as the experiments but with greater stringency. As divergence increases between the HA used in the experiment and the other sequences in the tree, the b value decreases and the amino-acid preference 'flatten'. Therefore, the preferences measured in each experiment are progressively less congruent with natural selection as we include increasingly diverged sequences. measured in the experiments. Figure 7a shows that the preferences inferred by pbMutSel are quite similar to the (H1\u00fe H3 avg) obtained by averaging the deep mutational scanning measurements for the H1 and H3 HAs. Notably, the amino-acid preferences from the pbMutSel model are more correlated with the (H1\u00fe H3 avg) than the H1 and H3 measurements are with each other (Fig. 7a) . This strong correlation indicates that the ExpCM(H1\u00feH3 avg)\u00feCx is unlikely to be much different than a pbMutSel model that is parameterized only using the natural sequence data.",
            "cite_spans": [
                {
                    "start": 295,
                    "end": 324,
                    "text": "(Rodrigue and Lartillot 2014)",
                    "ref_id": "BIBREF47"
                },
                {
                    "start": 875,
                    "end": 888,
                    "text": "(Bloom 2014b;",
                    "ref_id": "BIBREF5"
                },
                {
                    "start": 889,
                    "end": 918,
                    "text": "Hilton, Doud, and Bloom 2017)",
                    "ref_id": "BIBREF25"
                }
            ],
            "ref_spans": [
                {
                    "start": 423,
                    "end": 431,
                    "text": "Figure 6",
                    "ref_id": null
                },
                {
                    "start": 1398,
                    "end": 1407,
                    "text": "Figure 7a",
                    "ref_id": null
                },
                {
                    "start": 1735,
                    "end": 1744,
                    "text": "(Fig. 7a)",
                    "ref_id": null
                }
            ],
            "section": "A model with amino-acid preferences estimated from natural sequences gives similar results to an ExpCM"
        },
        {
            "text": "We next compared the branch lengths estimated by using the ExpCM(H1\u00feH3 avg)\u00feCx and pbMutSel models. As shown in Fig. 7b , these two models estimated similar branch lengths across the entire HA phylogenetic tree. However, the estimates are not identical, and the tension between local and global accuracy of the amino-acid preferences is still apparent. Specifically, the branches leading to the H1 or H3 sequences used in the experiments were estimated to be slightly longer by the ExpCM, while some other branches were estimated to be slightly longer by the pbMutSel model. The relatively longer branches leading to the experimental sequences when using the ExpCM(H1\u00feH3 avg)\u00feCx suggests that the 'tree average' amino-acid preferences inferred by the pbMutSel model are not as accurate as the preferences from the deep mutational scanning for sequences close to those used in the experiments. However, for sequences distant from those used in the experiments, the 'tree average' preferences inferred by the pbMutSel model appear to be slightly better than the experimental values. Therefore, while the ExpCM and pbMutSel models differ slightly in the extent to which they lengthen different branches, neither model can avoid the tension between the local and global accuracy of amino-acid preferences.",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 112,
                    "end": 119,
                    "text": "Fig. 7b",
                    "ref_id": null
                }
            ],
            "section": "A model with amino-acid preferences estimated from natural sequences gives similar results to an ExpCM"
        },
        {
            "text": "We examined how estimates of deep branch lengths on phylogenetic trees are affected by accounting for the fact that proteins prefer specific amino acids at specific sites. We did this by comparing inferences from models informed by experimental measurements of site-specific amino-acid preferences with more conventional codon substitution models, as well as with models that infer the amino-acid preferences from the natural sequences. We found that models that account for site-specific amino-acid preferences estimated deeper long branches, regardless of whether these preferences are measured experimentally or inferred from the sequence alignment. Additionally, we showed that the extension in branch length from site-specific amino-acid preferences is mostly independent of the extension that results from simply modeling rate variation.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Discussion"
        },
        {
            "text": "Overall, our results underscore the importance of modeling purifying selection in a way that is more nuanced than simply allowing the substitution rate to vary across sites. Protein sites do not simply differ in their rates of substitution-different sites also prefer different amino acids. There are now two ways to account for this fact: using models informed by deep mutational scanning experiments, or using models that infer site-specific amino-acid preferences from the natural sequence alignment. Combining either type of model with rate variation increases the inferred length of deep branches relative to models that only incorporate rate variation. We expect that further improvements could be achieved by also incorporating other factors such as host-specific substitution rates (Worobey, Han, and Rambaut 2014) that are known to be important for modeling the evolution of viral genes such as HA.",
            "cite_spans": [
                {
                    "start": 790,
                    "end": 822,
                    "text": "(Worobey, Han, and Rambaut 2014)",
                    "ref_id": "BIBREF64"
                }
            ],
            "ref_spans": [],
            "section": "Discussion"
        },
        {
            "text": "However, assuming a single set of site-specific amino-acid preferences is still an imperfect way to model evolution over a highly diverged phylogenetic tree. In the case of the experimentally informed models, it is fairly obvious why this is true: the amino-acid preferences are measured in just one genetic background, and therefore provide only a single snapshot of preferences that shift over evolutionary time due to epistasis (Pollock, Thiltgen, and Goldstein 2012; Bazykin 2015; Doud, Ashenberg, and Bloom 2015; Shah, McCandlish, and Plotkin 2015; Haddox et al. 2018; Starr et al. 2018) . As a result, experimentally measured amino-acid preferences are most accurate for sequences similar to the one used in the experiment, and so cause the largest increases in branch length in that region of the phylogenetic tree. However, this limitation is not unique to experimentally informed models, but is a general limitation of describing purifying selection using a single set of site-independent and timehomogenous amino-acid preferences. For instance, we showed that averaging experimental measurements on two protein homologs does a somewhat better job of capturing the 'average' constraint across the tree, and performs similarly to approaches (a) ( b) Figure 7 . Models inferred from natural sequences have similar stationary states to models defined by experimental preferences and estimate similar branch lengths.",
            "cite_spans": [
                {
                    "start": 431,
                    "end": 470,
                    "text": "(Pollock, Thiltgen, and Goldstein 2012;",
                    "ref_id": "BIBREF42"
                },
                {
                    "start": 471,
                    "end": 484,
                    "text": "Bazykin 2015;",
                    "ref_id": "BIBREF3"
                },
                {
                    "start": 485,
                    "end": 517,
                    "text": "Doud, Ashenberg, and Bloom 2015;",
                    "ref_id": "BIBREF9"
                },
                {
                    "start": 518,
                    "end": 553,
                    "text": "Shah, McCandlish, and Plotkin 2015;",
                    "ref_id": "BIBREF50"
                },
                {
                    "start": 554,
                    "end": 573,
                    "text": "Haddox et al. 2018;",
                    "ref_id": "BIBREF21"
                },
                {
                    "start": 574,
                    "end": 592,
                    "text": "Starr et al. 2018)",
                    "ref_id": "BIBREF53"
                }
            ],
            "ref_spans": [
                {
                    "start": 1258,
                    "end": 1266,
                    "text": "Figure 7",
                    "ref_id": null
                }
            ],
            "section": "Discussion"
        },
        {
            "text": "We fit an ExpCM(H1\u00feH3 avg)\u00feCx and a pbMutSel to the full HA tree in Fig. 4 . The pbMutSel amino-acid preferences are inferred from the natural HA sequences, while the ExpCM amino-acid preferences are experimentally measured and then rescaled by the stringency parameter in Table 1 that infer the 'average' preferences from natural sequence data (Rodrigue, Philippe, and Lartillot 2010; Rodrigue and Lartillot 2014) . But even these 'average' preferences exhibit a trade-off between local and global accuracy for the inference of deep branch lengths. So while modeling site-specific amino-acid preferences is a clear improvement over most conventional models, the next step toward greater accuracy will require relaxing the assumption that these preferences are time homogeneous and site independent. Of course, many authors have pointed out the shortcomings of models that fail to account for the full siteinterdependent complexity of purifying selection (Rodrigue et al. 2005; Choi et al. 2007; Pollock, Thiltgen, and Goldstein 2012; Goldstein and Pollock 2017) . However, the challenge is to overcome these shortcomings with models that are tractable for real phylogenetic questions. There are two main issues: first, the Felsenstein pruning algorithm (Felsenstein 1981 ) that is typically used to evaluate phylogenetic likelihoods breaks down when sites are no longer treated independently. Some alternative algorithms have been proposed (Choi et al. 2007; Rodrigue et al. 2009 Rodrigue et al. , 2005 Bordner and Mittelmann 2014) , but they are still in their infancy. Second, site-interdependent models require a realistic 'fitness function' that describes the interactions among sites. It appears that typical structural modeling programs are insufficient for this purpose (Rodrigue et al. 2009 ). But hope comes from experimental progress in measuring actual siteinterdependent constraints on proteins (Olson, Wu, and Sun 2014; Li et al. 2016; Steinberg and Ostermeier 2016; Wu et al. 2016) , combined with new methods for using these measurements to parameterize fitness functions (Sailer and Harms 2017; Otwinowski, McCandlish, and Plotkin 2018) . Perhaps some day such truly realistic models might be useful for phylogenetic inference. Until that day, our work shows that modeling a single set of time homogenous amino-acid preferences provides at least some improvement.",
            "cite_spans": [
                {
                    "start": 345,
                    "end": 385,
                    "text": "(Rodrigue, Philippe, and Lartillot 2010;",
                    "ref_id": "BIBREF47"
                },
                {
                    "start": 386,
                    "end": 414,
                    "text": "Rodrigue and Lartillot 2014)",
                    "ref_id": "BIBREF47"
                },
                {
                    "start": 955,
                    "end": 977,
                    "text": "(Rodrigue et al. 2005;",
                    "ref_id": "BIBREF47"
                },
                {
                    "start": 978,
                    "end": 995,
                    "text": "Choi et al. 2007;",
                    "ref_id": "BIBREF8"
                },
                {
                    "start": 996,
                    "end": 1034,
                    "text": "Pollock, Thiltgen, and Goldstein 2012;",
                    "ref_id": "BIBREF42"
                },
                {
                    "start": 1035,
                    "end": 1062,
                    "text": "Goldstein and Pollock 2017)",
                    "ref_id": "BIBREF19"
                },
                {
                    "start": 1254,
                    "end": 1271,
                    "text": "(Felsenstein 1981",
                    "ref_id": "BIBREF15"
                },
                {
                    "start": 1441,
                    "end": 1459,
                    "text": "(Choi et al. 2007;",
                    "ref_id": "BIBREF8"
                },
                {
                    "start": 1460,
                    "end": 1480,
                    "text": "Rodrigue et al. 2009",
                    "ref_id": "BIBREF47"
                },
                {
                    "start": 1481,
                    "end": 1503,
                    "text": "Rodrigue et al. , 2005",
                    "ref_id": "BIBREF47"
                },
                {
                    "start": 1504,
                    "end": 1532,
                    "text": "Bordner and Mittelmann 2014)",
                    "ref_id": "BIBREF6"
                },
                {
                    "start": 1778,
                    "end": 1799,
                    "text": "(Rodrigue et al. 2009",
                    "ref_id": "BIBREF47"
                },
                {
                    "start": 1908,
                    "end": 1933,
                    "text": "(Olson, Wu, and Sun 2014;",
                    "ref_id": "BIBREF38"
                },
                {
                    "start": 1934,
                    "end": 1949,
                    "text": "Li et al. 2016;",
                    "ref_id": "BIBREF32"
                },
                {
                    "start": 1950,
                    "end": 1980,
                    "text": "Steinberg and Ostermeier 2016;",
                    "ref_id": "BIBREF55"
                },
                {
                    "start": 1981,
                    "end": 1996,
                    "text": "Wu et al. 2016)",
                    "ref_id": "BIBREF65"
                },
                {
                    "start": 2088,
                    "end": 2111,
                    "text": "(Sailer and Harms 2017;",
                    "ref_id": "BIBREF49"
                },
                {
                    "start": 2112,
                    "end": 2153,
                    "text": "Otwinowski, McCandlish, and Plotkin 2018)",
                    "ref_id": "BIBREF40"
                }
            ],
            "ref_spans": [
                {
                    "start": 68,
                    "end": 74,
                    "text": "Fig. 4",
                    "ref_id": "FIGREF1"
                },
                {
                    "start": 273,
                    "end": 280,
                    "text": "Table 1",
                    "ref_id": "TABREF0"
                }
            ],
            "section": "Discussion"
        },
        {
            "text": "All of the substitution models used in this paper have been described previously. However, here we briefly recap their exact mathematical implementations.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Substitution models"
        },
        {
            "text": "The GY94 model is M0 variant of the Goldman-Yang model described by Yang et al. (2000) . Specifically, the substitution rate P xy from codon x to codon y is",
            "cite_spans": [
                {
                    "start": 68,
                    "end": 86,
                    "text": "Yang et al. (2000)",
                    "ref_id": "BIBREF66"
                }
            ],
            "ref_spans": [],
            "section": "GY94 model"
        },
        {
            "text": "i f x and y differ by more than one nucleotide; Uy if A\u00f0x\u00de\u00bcA\u00f0y\u00de and x is converted to y by a single \u00c0 nucleotide transversion; xUy if A\u00f0x\u00de 6 \u00bc A\u00f0y\u00de and x is converted to y by a single \u00c0 nucleotide transversion; jUy",
            "cite_spans": [],
            "ref_spans": [],
            "section": "GY94 model"
        },
        {
            "text": "if A\u00f0x\u00de\u00bcA\u00f0y\u00de and x is converted to y by a single \u00c0 nucleotide transition; xjUy if A\u00f0x\u00de 6 \u00bc A\u00f0y\u00de and x is converted to y by asingle \u00c0 nucleotide transition;",
            "cite_spans": [],
            "ref_spans": [],
            "section": "GY94 model"
        },
        {
            "text": "where A\u00f0x\u00de is the amino-acid encoded by codon x, j is the transition-transversion rate, U y is the equilibrium frequency of codon y, and x is the relative rate of nonsynonymous and synonymous substitutions. We define the codon frequency parameters, U y , using the 'corrected F3X4' method from Pond et al. (2010) . There are nine parameters describing the nucleotide frequencies at each codon site (the nucleotides are constrained to sum to one at each codon position), and these parameter values are calculated from the empirical alignment frequencies. The 'corrected F3X4' method calculates the U y values from these nucleotide frequencies but corrects for the exclusion of sequences with premature stop codons from the analysis. The frequency p x of codon x in the stationary state of a GY94 model is simply",
            "cite_spans": [
                {
                    "start": 294,
                    "end": 312,
                    "text": "Pond et al. (2010)",
                    "ref_id": "BIBREF43"
                }
            ],
            "ref_spans": [],
            "section": "GY94 model"
        },
        {
            "text": "Overall, a GY94 model has eleven free parameters: j, x, and the nine nucleotide frequency parameters used to define U y .",
            "cite_spans": [],
            "ref_spans": [],
            "section": "GY94 model"
        },
        {
            "text": "The ExpCM models used in this paper are the ones described in Bloom (2017) . Briefly, the rate of substitution P r;xy of site r from codon x to y is",
            "cite_spans": [
                {
                    "start": 62,
                    "end": 74,
                    "text": "Bloom (2017)",
                    "ref_id": "BIBREF5"
                }
            ],
            "ref_spans": [],
            "section": "Experimentally informed codon model (ExpCM)"
        },
        {
            "text": "where Q xy is proportional to the rate of mutation from x to y, F r;xy is proportional to the probability that this mutation fixes, and the diagonal elements P xx are set by P xx \u00bc \u00c0 P z6 \u00bcx P xz . The rate of mutation Q xy is assumed to be uniform across sites, and takes an HKY85-like (Hasegawa, Kishino, and Yano 1985) form as",
            "cite_spans": [
                {
                    "start": 287,
                    "end": 321,
                    "text": "(Hasegawa, Kishino, and Yano 1985)",
                    "ref_id": "BIBREF24"
                }
            ],
            "ref_spans": [],
            "section": "Experimentally informed codon model (ExpCM)"
        },
        {
            "text": "i f x and y differ by more than one nucleotide; u w if x can be converted to y by a transversion of a nucleotide to w; j \u00c2 u w if x can be converted to y by a transition of a nucleotide to w 8 < :",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Experimentally informed codon model (ExpCM)"
        },
        {
            "text": "(4) where u w is the nucleotide frequency of nucleotide w and j is the transition-transversion rate.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Experimentally informed codon model (ExpCM)"
        },
        {
            "text": "The deep mutational scanning amino-acid preferences are incorporated into the ExpCM via the F r;xy terms. The experiments measure the preference p r;a of every site r for every amino acid a. F r;xy is defined in terms of these experimentally measured amino-acid preferences as F r;xy \u00bc 1 i f A\u00f0x\u00de\u00bcA\u00f0y\u00de;",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Experimentally informed codon model (ExpCM)"
        },
        {
            "text": "x \u00c2 ln p r;A\u00f0y\u00de =p r;A\u00f0x\u00de b 1 \u00c0 p r;A\u00f0x\u00de =p r;A\u00f0y\u00de b if A\u00f0x\u00de 6 \u00bc A\u00f0y\u00de;",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Experimentally informed codon model (ExpCM)"
        },
        {
            "text": "where b is the stringency parameter (Bloom 2014b; Hilton, Doud, and Bloom 2017 ) and x is the relative rate of nonsynonymous to synonymous substitutions after accounting for the amino-acid preferences. The stationary state of an ExpCM is",
            "cite_spans": [
                {
                    "start": 36,
                    "end": 49,
                    "text": "(Bloom 2014b;",
                    "ref_id": "BIBREF5"
                },
                {
                    "start": 50,
                    "end": 78,
                    "text": "Hilton, Doud, and Bloom 2017",
                    "ref_id": "BIBREF25"
                }
            ],
            "ref_spans": [],
            "section": "Experimentally informed codon model (ExpCM)"
        },
        {
            "text": "where u x1 ; u x2 , and u x3 are the nucleotides at position 1, 2, and 3 of codon x. An ExpCM has five free parameters: j, x, and the three independent u x values. The amino-acid preferences p r;a are not free parameters since they are determined a priori by an experiment independent of the sequence alignment being analyzed.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Experimentally informed codon model (ExpCM)"
        },
        {
            "text": "The GY94\u00feCx is equivalent to the M5 model in Yang et al. (2000) with x drawn from K \u00bc 4 categories. The ExpCM\u00feCx similarly draws x from a C distribution discretized into K \u00bc 4 bins. Each bin is equally weighted and x takes on the mean value of the bin. Because the C distribution is defined by two parameters, adding Cx to a model with a single x adds one free parameter. Therefore, the GY94\u00feCx model has twelve free parameters, and the ExpCM\u00feCx model has six free parameters.",
            "cite_spans": [
                {
                    "start": 45,
                    "end": 63,
                    "text": "Yang et al. (2000)",
                    "ref_id": "BIBREF66"
                }
            ],
            "ref_spans": [],
            "section": "Cx rate variation"
        },
        {
            "text": "4.1.4 GY94 with x r In Fig. 2 , we describe GY94 models where each site r has its own x r value that is calculated from the amino-acid preferences using the relationship described by Spielman and Wilke (2015b) . This relationship defines the expected rate of nonsynonymous to synonymous substitutions given the amino-acid preferences. We first fit an ExpCM to the 'low divergence' H1 subtree (parameter values in Supplementary Table S2) , which allows us to calculate P r;xy (Equation 3), Q xy (Equation 4), and p r;x (Equation 6). We then calculated x r using the equation of Spielman and Wilke (2015b) , normalizing by the gene-wide x fit by the ExpCM:",
            "cite_spans": [
                {
                    "start": 183,
                    "end": 209,
                    "text": "Spielman and Wilke (2015b)",
                    "ref_id": "BIBREF51"
                },
                {
                    "start": 577,
                    "end": 603,
                    "text": "Spielman and Wilke (2015b)",
                    "ref_id": "BIBREF51"
                }
            ],
            "ref_spans": [
                {
                    "start": 23,
                    "end": 29,
                    "text": "Fig. 2",
                    "ref_id": null
                },
                {
                    "start": 413,
                    "end": 436,
                    "text": "Supplementary Table S2)",
                    "ref_id": null
                }
            ],
            "section": "Cx rate variation"
        },
        {
            "text": "where N x is the set of codons that are nonsynonymous to codon x and differ from codon x by only one nucleotide.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Cx rate variation"
        },
        {
            "text": "We used amino-acid preferences measured in deep mutational scans of the A/WSN/1933 H1 HA (Doud and Bloom 2016) and the A/Perth/2009 H3 HA (Lee et al. 2018 ) to define the amino-acid preferences that inform the ExpCMs. We only used sites that can be unambiguously aligned in these H1 and H3 HAs. These alignable sites and their mapping to sequential numbering of the HA sequences used in the deep mutational scanning experiments are in Supplementary file 1. The experimentally measured amino-acid preferences masked to just include these alignable sites are in Supplementary files 2 and 3. For the average preference set, we took the pairwise average of the H1 and H3 preferences. The preference for every amino acid a at every site r in the average preference set is p r;a;\u00f0H1\u00feH3 avg\u00de \u00bc p r;a;H1 \u00fe p r;a;H3 2 (8)",
            "cite_spans": [
                {
                    "start": 89,
                    "end": 110,
                    "text": "(Doud and Bloom 2016)",
                    "ref_id": "BIBREF9"
                },
                {
                    "start": 138,
                    "end": 154,
                    "text": "(Lee et al. 2018",
                    "ref_id": "BIBREF31"
                }
            ],
            "ref_spans": [],
            "section": "HA amino-acid preferences from deep mutational scanning experiments"
        },
        {
            "text": "We downloaded all full-length, coding sequences for 15 of the 18 influenza A virus HA subtypes from the Influenza Virus Resource Database (Bao et al. 2008) in June 2017. We excluded rare subtypes 15, 17, and 18, which have few sequences in the database. We filtered and aligned the sequences using phydm-s_prepalignment (Hilton, Doud, and Bloom 2017) . Specifically, we used phydms_prepalignment with the flag -minidentity 0.3 to remove sequences with ambiguous nucleotides, premature stops, or frameshift mutations as well as redundant sequences. We also removed all codon sites which are not alignable between the H1 HA and H3 HA used in the deep mutational scanning experiments (these alignable sites are listed in Supplementary file 1). We subsampled the remaining sequences to five per subtype with 1 sequence per year per subtype. We also included a small number of sequences from the major human and equine influenza lineages to ensure representation of these well-studied lineages. The resulting alignment contains 92 sequences, and is provided in Supplementary file 4.",
            "cite_spans": [
                {
                    "start": 138,
                    "end": 155,
                    "text": "(Bao et al. 2008)",
                    "ref_id": "BIBREF2"
                },
                {
                    "start": 320,
                    "end": 350,
                    "text": "(Hilton, Doud, and Bloom 2017)",
                    "ref_id": "BIBREF25"
                }
            ],
            "ref_spans": [],
            "section": "HA sequences and tree topology"
        },
        {
            "text": "We created four subalignments with 'low' and 'intermediate' divergence from either the H1 or the H3 deep mutational scanning reference sequence for the analysis in Fig. 6 . The 'low divergence' alignments had ! 59% amino-acid identity to the sequence used in the deep mutational scanning, and the 'intermediate divergence' alignments had ! 46% identity from the reference sequence ( Supplementary Fig. S5) .",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 164,
                    "end": 170,
                    "text": "Fig. 6",
                    "ref_id": null
                },
                {
                    "start": 383,
                    "end": 405,
                    "text": "Supplementary Fig. S5)",
                    "ref_id": "FIGREF2"
                }
            ],
            "section": "HA sequences and tree topology"
        },
        {
            "text": "We inferred the tree topology of each alignment using RAxML (Stamatakis 2006 ) and the GTRCAT model. We estimated the branch lengths of this fixed topology using each ExpCM and GY94 models with phydms_comprehensive (Hilton, Doud, and Bloom 2017) .",
            "cite_spans": [
                {
                    "start": 60,
                    "end": 76,
                    "text": "(Stamatakis 2006",
                    "ref_id": "BIBREF52"
                },
                {
                    "start": 215,
                    "end": 245,
                    "text": "(Hilton, Doud, and Bloom 2017)",
                    "ref_id": "BIBREF25"
                }
            ],
            "ref_spans": [],
            "section": "HA sequences and tree topology"
        },
        {
            "text": "For the analysis in Fig. 2 , we fit models to the 'low divergence H1 subtree. This gave the parameter values in Supplementary  Table S2 .",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 20,
                    "end": 26,
                    "text": "Fig. 2",
                    "ref_id": null
                },
                {
                    "start": 112,
                    "end": 135,
                    "text": "Supplementary  Table S2",
                    "ref_id": null
                }
            ],
            "section": "Asymptotic amino-acid sequence identity"
        },
        {
            "text": "For each model, we calculated the expected amino-acid sequence identity for two sequences separated by a branch length of t as X a X x2a p r;x X y2a \u00bde tPr xy (9) where a ranges over all twenty amino acids, x 2 a indicates that x ranges over all codons that encode amino-acid a, p r;x is the stationary state of the model at site r and codon x (given by Equation 2 for GY94-family models, and Equation 6 for ExpCMfamily models), and \u00bde tPr xy is the value in row x and column y of the matrix obtained by exponentiating the product of t and the substitution matrix P r for site r (defined by Equation 1 for GY94family models and Equation 3 for ExpCM-family models).",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Asymptotic amino-acid sequence identity"
        },
        {
            "text": "For Fig. 3 , we simulated sequences using pyvolve (Spielman and Wilke 2015a) along the full HA tree using an ExpCM defined by parameters fit to the 'low divergence' H1 subtree (Supplementary Table S2 ). We performed 10 replicate simulations and estimated the branch lengths for each replicate using phydms_comprehensive (Hilton, Doud, and Bloom 2017) .",
            "cite_spans": [
                {
                    "start": 320,
                    "end": 350,
                    "text": "(Hilton, Doud, and Bloom 2017)",
                    "ref_id": "BIBREF25"
                }
            ],
            "ref_spans": [
                {
                    "start": 4,
                    "end": 10,
                    "text": "Fig. 3",
                    "ref_id": "FIGREF0"
                },
                {
                    "start": 176,
                    "end": 199,
                    "text": "(Supplementary Table S2",
                    "ref_id": null
                }
            ],
            "section": "Simulations"
        },
        {
            "text": "For Fig. 7 , we fit a pbMutSel model to the full HA tree. We ran one chain for 5,500 steps, saved every sample, and discarded the first 550 samples as a burn-in. We used PhyloBayes-MPI program readpb_mpi to compute the majority-rule consensus tree and the posterior average site-specific amino-acid preferences. Convergence was assessed visually using Tracer (Rambaut et al. 2018 ) and by the correlation of amino-acid preferences inferred by two independent chains (r \u00bc 0.996).",
            "cite_spans": [
                {
                    "start": 359,
                    "end": 379,
                    "text": "(Rambaut et al. 2018",
                    "ref_id": "BIBREF46"
                }
            ],
            "ref_spans": [
                {
                    "start": 4,
                    "end": 10,
                    "text": "Fig. 7",
                    "ref_id": null
                }
            ],
            "section": "pbMutSel inference with PhyloBayes-MPI"
        },
        {
            "text": "In order to make the branch lengths in Fig. 7 comparable between the pbMutSel tree returned by PhyloBayes-MPI and the other trees returned by phydms, we normalized the branch lengths on the pbMutSel consensus tree and the ExpCM(H1\u00feH3 avg)\u00feCx by dividing each branch by the length from A/South Carolina/1/1918 and A/Solomon Islands/3/2006. These two H1 sequences are early and late representatives of the longest known human influenza lineage, and are of sufficiently high identity that different ExpCM and GY94 substitution models all estimate nearly identical branch lengths separating them.",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 39,
                    "end": 45,
                    "text": "Fig. 7",
                    "ref_id": null
                }
            ],
            "section": "pbMutSel inference with PhyloBayes-MPI"
        },
        {
            "text": "All codes used for the analyzes in this article are available at https://github.com/jbloomlab/divergence_timing_manuscript. The external computer programs that we used were \u2022 phydms (Hilton, Doud, and Bloom 2017) ",
            "cite_spans": [
                {
                    "start": 182,
                    "end": 212,
                    "text": "(Hilton, Doud, and Bloom 2017)",
                    "ref_id": "BIBREF25"
                }
            ],
            "ref_spans": [],
            "section": "Software versions and computer codes"
        },
        {
            "text": "Supplementary data are available at Virus Evolution online.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Supplementary data"
        }
    ],
    "bib_entries": {
        "BIBREF0": {
            "ref_id": "b0",
            "title": "Time-Dependent Rate Phenomenon in Viruses",
            "authors": [
                {
                    "first": "P",
                    "middle": [],
                    "last": "Aiewsakun",
                    "suffix": ""
                },
                {
                    "first": "A",
                    "middle": [],
                    "last": "Katzourakis",
                    "suffix": ""
                }
            ],
            "year": 2016,
            "venue": "Journal of Virology",
            "volume": "90",
            "issn": "",
            "pages": "7184--95",
            "other_ids": {}
        },
        "BIBREF1": {
            "ref_id": "b1",
            "title": "Trends in Substitution Models of Molecular Evolution",
            "authors": [
                {
                    "first": "M",
                    "middle": [],
                    "last": "Arenas",
                    "suffix": ""
                }
            ],
            "year": 2015,
            "venue": "Frontiers in Genetics",
            "volume": "6",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF2": {
            "ref_id": "b2",
            "title": "The Influenza Virus Resource at the National Center for Biotechnology Information",
            "authors": [
                {
                    "first": "Y",
                    "middle": [],
                    "last": "Bao",
                    "suffix": ""
                }
            ],
            "year": 2008,
            "venue": "Journal of Virology",
            "volume": "82",
            "issn": "",
            "pages": "596--601",
            "other_ids": {}
        },
        "BIBREF3": {
            "ref_id": "b3",
            "title": "Changing Preferences: Deformation of Single Position Amino Acid Fitness Landscapes and Evolution of Proteins",
            "authors": [
                {
                    "first": "G",
                    "middle": [
                        "A"
                    ],
                    "last": "Bazykin",
                    "suffix": ""
                }
            ],
            "year": 2015,
            "venue": "Biology Letters",
            "volume": "11",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF4": {
            "ref_id": "b4",
            "title": "Integrating Influenza Antigenic Dynamics with Molecular Evolution",
            "authors": [
                {
                    "first": "T",
                    "middle": [],
                    "last": "Bedford",
                    "suffix": ""
                }
            ],
            "year": 2014,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF5": {
            "ref_id": "b5",
            "title": "Identification of Positive Selection in Genes Is Greatly Improved by Using Experimentally Informed Site-Specific Models",
            "authors": [
                {
                    "first": "J",
                    "middle": [
                        "D"
                    ],
                    "last": "Bloom",
                    "suffix": ""
                }
            ],
            "year": 2014,
            "venue": "Molecular Biology and Evolution",
            "volume": "31",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF6": {
            "ref_id": "b6",
            "title": "A New Formulation of Protein Evolutionary Models That account for Structural Constraints",
            "authors": [
                {
                    "first": "A",
                    "middle": [
                        "J"
                    ],
                    "last": "Bordner",
                    "suffix": ""
                },
                {
                    "first": "H",
                    "middle": [
                        "D"
                    ],
                    "last": "Mittelmann",
                    "suffix": ""
                }
            ],
            "year": 2014,
            "venue": "Molecular Biology and Evolution",
            "volume": "31",
            "issn": "",
            "pages": "736--785",
            "other_ids": {}
        },
        "BIBREF7": {
            "ref_id": "b7",
            "title": "Molecular Evolution of Viruses of the Family Filoviridae Based on 97 Whole-Genome Sequences",
            "authors": [
                {
                    "first": "S",
                    "middle": [
                        "A"
                    ],
                    "last": "Carroll",
                    "suffix": ""
                }
            ],
            "year": 2013,
            "venue": "Journal of Virology",
            "volume": "87",
            "issn": "",
            "pages": "2608--2624",
            "other_ids": {}
        },
        "BIBREF8": {
            "ref_id": "b8",
            "title": "Quantifying the Impact of Protein Tertiary Structure on Molecular Evolution",
            "authors": [
                {
                    "first": "S",
                    "middle": [
                        "C"
                    ],
                    "last": "Choi",
                    "suffix": ""
                }
            ],
            "year": 2007,
            "venue": "Molecular Biology and Evolution",
            "volume": "24",
            "issn": "",
            "pages": "1769--82",
            "other_ids": {}
        },
        "BIBREF9": {
            "ref_id": "b9",
            "title": "Site-Specific Amino Acid Preferences Are Mostly Conserved in Two Closely Related Protein Homologs",
            "authors": [
                {
                    "first": "M",
                    "middle": [
                        "B"
                    ],
                    "last": "Doud",
                    "suffix": ""
                },
                {
                    "first": "O",
                    "middle": [],
                    "last": "Ashenberg",
                    "suffix": ""
                },
                {
                    "first": "J",
                    "middle": [
                        "D"
                    ],
                    "last": "Bloom",
                    "suffix": ""
                }
            ],
            "year": 2015,
            "venue": "Molecular Biology and Evolution",
            "volume": "32",
            "issn": "8",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF10": {
            "ref_id": "b10",
            "title": "Relaxed Phylogenetics and Dating with Confidence",
            "authors": [
                {
                    "first": "A",
                    "middle": [
                        "J"
                    ],
                    "last": "Drummond",
                    "suffix": ""
                }
            ],
            "year": 2006,
            "venue": "PLoS Biology",
            "volume": "4",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF11": {
            "ref_id": "b11",
            "title": "Evaluating the Adequacy of Molecular Clock Models Using Posterior Predictive Simulations",
            "authors": [
                {
                    "first": "D",
                    "middle": [
                        "A"
                    ],
                    "last": "Duch\u00ea Ne",
                    "suffix": ""
                }
            ],
            "year": 2015,
            "venue": "Molecular Biology and Evolution",
            "volume": "32",
            "issn": "",
            "pages": "2986--95",
            "other_ids": {}
        },
        "BIBREF12": {
            "ref_id": "b12",
            "title": "Substitution Model Adequacy and Assessing the Reliability of Estimates of Virus Evolutionary Rates and Time Scales",
            "authors": [
                {
                    "first": "S",
                    "middle": [],
                    "last": "Duch\u00ea Ne",
                    "suffix": ""
                },
                {
                    "first": "F",
                    "middle": [],
                    "last": "Di Giallonardo",
                    "suffix": ""
                },
                {
                    "first": "E",
                    "middle": [
                        "C"
                    ],
                    "last": "Holmes",
                    "suffix": ""
                },
                {
                    "first": "E",
                    "middle": [
                        "C"
                    ],
                    "last": "Holmes",
                    "suffix": ""
                },
                {
                    "first": "S",
                    "middle": [
                        "Y"
                    ],
                    "last": "Ho",
                    "suffix": ""
                }
            ],
            "year": 2014,
            "venue": "Proceedings of the Royal Society of London B",
            "volume": "33",
            "issn": "",
            "pages": "255--67",
            "other_ids": {}
        },
        "BIBREF13": {
            "ref_id": "b13",
            "title": "Causes of Evolutionary Rate Variation among Protein Sites'",
            "authors": [
                {
                    "first": "J",
                    "middle": [],
                    "last": "Echave",
                    "suffix": ""
                },
                {
                    "first": "S",
                    "middle": [
                        "J"
                    ],
                    "last": "Spielman",
                    "suffix": ""
                },
                {
                    "first": "C",
                    "middle": [
                        "O"
                    ],
                    "last": "Wilke",
                    "suffix": ""
                }
            ],
            "year": 2016,
            "venue": "Nature Reviews Genetics",
            "volume": "17",
            "issn": "",
            "pages": "109--121",
            "other_ids": {}
        },
        "BIBREF14": {
            "ref_id": "b14",
            "title": "A Revised Evolutionary History of Hepatitis B Virus (HBV)",
            "authors": [
                {
                    "first": "M",
                    "middle": [
                        "A"
                    ],
                    "last": "Fares",
                    "suffix": ""
                },
                {
                    "first": "E",
                    "middle": [
                        "C"
                    ],
                    "last": "Holmes",
                    "suffix": ""
                }
            ],
            "year": 2002,
            "venue": "Journal of Molecular Evolution",
            "volume": "54",
            "issn": "",
            "pages": "807--821",
            "other_ids": {}
        },
        "BIBREF15": {
            "ref_id": "b15",
            "title": "Cases in Which Parsimony or Compatibility Methods Will Be Positively Misleading",
            "authors": [
                {
                    "first": "J",
                    "middle": [],
                    "last": "Felsenstein",
                    "suffix": ""
                }
            ],
            "year": 1978,
            "venue": "Journal of Molecular Evolution",
            "volume": "27",
            "issn": "",
            "pages": "368--76",
            "other_ids": {}
        },
        "BIBREF16": {
            "ref_id": "b16",
            "title": "Deep Mutational Scanning: A New Style of Protein Science",
            "authors": [
                {
                    "first": "D",
                    "middle": [
                        "M"
                    ],
                    "last": "Fowler",
                    "suffix": ""
                },
                {
                    "first": "S",
                    "middle": [],
                    "last": "Fields",
                    "suffix": ""
                }
            ],
            "year": 2014,
            "venue": "Nature Methods",
            "volume": "11",
            "issn": "",
            "pages": "801--808",
            "other_ids": {}
        },
        "BIBREF17": {
            "ref_id": "b17",
            "title": "Origin of Measles Virus: Divergence from Rinderpest Virus between the 11th and 12th Centuries",
            "authors": [
                {
                    "first": "Y",
                    "middle": [],
                    "last": "Furuse",
                    "suffix": ""
                },
                {
                    "first": "A",
                    "middle": [],
                    "last": "Suzuki",
                    "suffix": ""
                },
                {
                    "first": "H",
                    "middle": [],
                    "last": "Oshitani",
                    "suffix": ""
                }
            ],
            "year": 2010,
            "venue": "Virology Journal",
            "volume": "7",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF18": {
            "ref_id": "b18",
            "title": "A Codon-Based Model of Nucleotide Substitution for Protein-Coding DNA Sequences",
            "authors": [
                {
                    "first": "N",
                    "middle": [],
                    "last": "Goldman",
                    "suffix": ""
                },
                {
                    "first": "Yang",
                    "middle": [],
                    "last": "",
                    "suffix": ""
                },
                {
                    "first": "Z",
                    "middle": [],
                    "last": "",
                    "suffix": ""
                }
            ],
            "year": 1994,
            "venue": "Molecular Biology and Evolution",
            "volume": "11",
            "issn": "",
            "pages": "725--761",
            "other_ids": {}
        },
        "BIBREF19": {
            "ref_id": "b19",
            "title": "Sequence Entropy of Folding and the Absolute Rate of Amino Acid Substitutions",
            "authors": [
                {
                    "first": "R",
                    "middle": [
                        "A"
                    ],
                    "last": "Goldstein",
                    "suffix": ""
                },
                {
                    "first": "D",
                    "middle": [
                        "D"
                    ],
                    "last": "Pollock",
                    "suffix": ""
                },
                {
                    "first": "L",
                    "middle": [
                        "I"
                    ],
                    "last": "Gong",
                    "suffix": ""
                },
                {
                    "first": "M",
                    "middle": [
                        "A"
                    ],
                    "last": "Suchard",
                    "suffix": ""
                },
                {
                    "first": "J",
                    "middle": [
                        "D"
                    ],
                    "last": "Bloom",
                    "suffix": ""
                }
            ],
            "year": 1923,
            "venue": "Nature Ecology & Evolution",
            "volume": "1",
            "issn": "2",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF20": {
            "ref_id": "b20",
            "title": "H5 Avian and H9 Swine Influenza Virus Haemagglutinin Structures: Possible Origin of Influenza Subtypes",
            "authors": [
                {
                    "first": "Y",
                    "middle": [],
                    "last": "Ha",
                    "suffix": ""
                }
            ],
            "year": 2002,
            "venue": "The EMBO Journal",
            "volume": "21",
            "issn": "",
            "pages": "865--75",
            "other_ids": {}
        },
        "BIBREF21": {
            "ref_id": "b21",
            "title": "Mapping Mutational Effects along the Evolutionary Landscape of HIV Envelope",
            "authors": [
                {
                    "first": "H",
                    "middle": [
                        "K"
                    ],
                    "last": "Haddox",
                    "suffix": ""
                }
            ],
            "year": 2018,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF22": {
            "ref_id": "b22",
            "title": "Evolutionary Distances for Protein-Coding Sequences: Modeling Site-Specific Residue Frequencies",
            "authors": [
                {
                    "first": "A",
                    "middle": [
                        "L"
                    ],
                    "last": "Halpern",
                    "suffix": ""
                },
                {
                    "first": "W",
                    "middle": [
                        "J"
                    ],
                    "last": "Bruno",
                    "suffix": ""
                }
            ],
            "year": 1998,
            "venue": "Molecular Biology and Evolution",
            "volume": "15",
            "issn": "",
            "pages": "910--917",
            "other_ids": {}
        },
        "BIBREF23": {
            "ref_id": "b23",
            "title": "Historical Contingency and Its Biophysical Basis in Glucocorticoid Receptor Evolution",
            "authors": [
                {
                    "first": "M",
                    "middle": [
                        "J"
                    ],
                    "last": "Harms",
                    "suffix": ""
                },
                {
                    "first": "J",
                    "middle": [
                        "W"
                    ],
                    "last": "Thornton",
                    "suffix": ""
                }
            ],
            "year": 2014,
            "venue": "Nature",
            "volume": "512",
            "issn": "",
            "pages": "203--210",
            "other_ids": {}
        },
        "BIBREF24": {
            "ref_id": "b24",
            "title": "Dating of the Human-Ape Splitting by a Molecular Clock of Mitochondrial DNA",
            "authors": [
                {
                    "first": "M",
                    "middle": [],
                    "last": "Hasegawa",
                    "suffix": ""
                },
                {
                    "first": "H",
                    "middle": [],
                    "last": "Kishino",
                    "suffix": ""
                },
                {
                    "first": "T",
                    "middle": [],
                    "last": "Yano",
                    "suffix": ""
                }
            ],
            "year": 1985,
            "venue": "Journal of Molecular Evolution",
            "volume": "22",
            "issn": "",
            "pages": "160--74",
            "other_ids": {}
        },
        "BIBREF25": {
            "ref_id": "b25",
            "title": "Phydms: Software for Phylogenetic Analyses Informed by Deep Mutational Scanning",
            "authors": [
                {
                    "first": "S",
                    "middle": [
                        "K"
                    ],
                    "last": "Hilton",
                    "suffix": ""
                },
                {
                    "first": "M",
                    "middle": [
                        "B"
                    ],
                    "last": "Doud",
                    "suffix": ""
                },
                {
                    "first": "J",
                    "middle": [
                        "D"
                    ],
                    "last": "Bloom",
                    "suffix": ""
                }
            ],
            "year": 2017,
            "venue": "PeerJ",
            "volume": "",
            "issn": "5",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF26": {
            "ref_id": "b26",
            "title": "Time-Dependent Estimates of Molecular Evolutionary Rates: Evidence and Causes",
            "authors": [
                {
                    "first": "S",
                    "middle": [
                        "Y"
                    ],
                    "last": "Ho",
                    "suffix": ""
                }
            ],
            "year": 2015,
            "venue": "Molecular Ecology",
            "volume": "24",
            "issn": "",
            "pages": "6007--6019",
            "other_ids": {}
        },
        "BIBREF27": {
            "ref_id": "b27",
            "title": "Molecular Clocks and the Puzzle of RNA Virus Origins",
            "authors": [
                {
                    "first": "E",
                    "middle": [
                        "C"
                    ],
                    "last": "Holmes",
                    "suffix": ""
                }
            ],
            "year": 2003,
            "venue": "Journal of Virology",
            "volume": "77",
            "issn": "",
            "pages": "3893--3900",
            "other_ids": {}
        },
        "BIBREF28": {
            "ref_id": "b28",
            "title": "Snakemake -A Scalable Bioinformatics Workflow Engine",
            "authors": [
                {
                    "first": "J",
                    "middle": [],
                    "last": "K\u00f6 Ster",
                    "suffix": ""
                },
                {
                    "first": "S",
                    "middle": [],
                    "last": "Rahmann",
                    "suffix": ""
                }
            ],
            "year": 2012,
            "venue": "Bioinformatics",
            "volume": "28",
            "issn": "",
            "pages": "2520--2522",
            "other_ids": {}
        },
        "BIBREF29": {
            "ref_id": "b29",
            "title": "Suppression of Long-Branch Attraction Artefacts in the Animal Phylogeny Using a Site-Heterogeneous Model",
            "authors": [
                {
                    "first": "N",
                    "middle": [],
                    "last": "Lartillot",
                    "suffix": ""
                },
                {
                    "first": "H",
                    "middle": [],
                    "last": "Brinkmann",
                    "suffix": ""
                },
                {
                    "first": "Philippe",
                    "middle": [],
                    "last": "",
                    "suffix": ""
                },
                {
                    "first": "H",
                    "middle": [],
                    "last": "",
                    "suffix": ""
                }
            ],
            "year": 2004,
            "venue": "Molecular Biology and Evolution",
            "volume": "21",
            "issn": "",
            "pages": "1095--109",
            "other_ids": {}
        },
        "BIBREF30": {
            "ref_id": "b30",
            "title": "Phylogenetic Mixture Models for Proteins",
            "authors": [
                {
                    "first": "S",
                    "middle": [
                        "Q"
                    ],
                    "last": "Le",
                    "suffix": ""
                },
                {
                    "first": "N",
                    "middle": [],
                    "last": "Lartillot",
                    "suffix": ""
                },
                {
                    "first": "O",
                    "middle": [],
                    "last": "Gascuel",
                    "suffix": ""
                }
            ],
            "year": 2008,
            "venue": "Philosophical Transactions of the Royal Society of London. Series B, Biological Sciences",
            "volume": "363",
            "issn": "",
            "pages": "3965--76",
            "other_ids": {}
        },
        "BIBREF31": {
            "ref_id": "b31",
            "title": "Deep Mutational Scanning of Hemagglutinin Helps Predict Evolutionary Fates of Human H3N2 Influenza Variants",
            "authors": [
                {
                    "first": "J",
                    "middle": [
                        "M"
                    ],
                    "last": "Lee",
                    "suffix": ""
                }
            ],
            "year": 2018,
            "venue": "Proceedings of the National Academy of Sciences of the United States of America",
            "volume": "115",
            "issn": "",
            "pages": "8276--85",
            "other_ids": {}
        },
        "BIBREF32": {
            "ref_id": "b32",
            "title": "The Fitness Landscape of a Trna Gene",
            "authors": [
                {
                    "first": "C",
                    "middle": [],
                    "last": "Li",
                    "suffix": ""
                }
            ],
            "year": 2016,
            "venue": "Science",
            "volume": "352",
            "issn": "",
            "pages": "837--877",
            "other_ids": {}
        },
        "BIBREF33": {
            "ref_id": "b33",
            "title": "Modeling Evolution Using the Probability of Fixation: History and Implications",
            "authors": [
                {
                    "first": "D",
                    "middle": [
                        "M"
                    ],
                    "last": "Mccandlish",
                    "suffix": ""
                },
                {
                    "first": "A",
                    "middle": [],
                    "last": "Stoltzfus",
                    "suffix": ""
                }
            ],
            "year": 2014,
            "venue": "The Quarterly Review of Biology",
            "volume": "89",
            "issn": "",
            "pages": "225--52",
            "other_ids": {}
        },
        "BIBREF34": {
            "ref_id": "b34",
            "title": "Gene-Wide Identification of Episodic Selection",
            "authors": [
                {
                    "first": "B",
                    "middle": [],
                    "last": "Murrell",
                    "suffix": ""
                }
            ],
            "year": 2015,
            "venue": "Molecular Biology and Evolution",
            "volume": "32",
            "issn": "",
            "pages": "1365--71",
            "other_ids": {}
        },
        "BIBREF35": {
            "ref_id": "b35",
            "title": "Statistical Methods in Molecular Evolution",
            "authors": [
                {
                    "first": "R",
                    "middle": [],
                    "last": "Nielsen",
                    "suffix": ""
                }
            ],
            "year": 2006,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF36": {
            "ref_id": "b36",
            "title": "Comparison of Complete Amino Acid Sequences and Receptor-Binding Properties among 13",
            "authors": [
                {
                    "first": "E",
                    "middle": [],
                    "last": "Nobusawa",
                    "suffix": ""
                }
            ],
            "year": 1991,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF37": {
            "ref_id": "b37",
            "title": "Serotypes of Hemagglutinins of Influenza a Viruses",
            "authors": [],
            "year": null,
            "venue": "Virology",
            "volume": "182",
            "issn": "",
            "pages": "475--85",
            "other_ids": {}
        },
        "BIBREF38": {
            "ref_id": "b38",
            "title": "A Comprehensive Biophysical Description of Pairwise Epistasis throughout an Entire Protein Domain",
            "authors": [
                {
                    "first": "C",
                    "middle": [
                        "A"
                    ],
                    "last": "Olson",
                    "suffix": ""
                },
                {
                    "first": "N",
                    "middle": [
                        "C"
                    ],
                    "last": "Wu",
                    "suffix": ""
                },
                {
                    "first": "R",
                    "middle": [],
                    "last": "Sun",
                    "suffix": ""
                }
            ],
            "year": 2014,
            "venue": "Current Biology",
            "volume": "24",
            "issn": "",
            "pages": "2643--51",
            "other_ids": {}
        },
        "BIBREF39": {
            "ref_id": "b39",
            "title": "Crystal Structure of an Ancient Protein: Evolution by Conformational Epistasis",
            "authors": [
                {
                    "first": "E",
                    "middle": [
                        "A"
                    ],
                    "last": "Ortlund",
                    "suffix": ""
                }
            ],
            "year": 2007,
            "venue": "Science",
            "volume": "317",
            "issn": "",
            "pages": "1544--1552",
            "other_ids": {}
        },
        "BIBREF40": {
            "ref_id": "b40",
            "title": "Inferring the Shape of Global Epistasis",
            "authors": [
                {
                    "first": "J",
                    "middle": [],
                    "last": "Otwinowski",
                    "suffix": ""
                },
                {
                    "first": "D",
                    "middle": [
                        "M"
                    ],
                    "last": "Mccandlish",
                    "suffix": ""
                },
                {
                    "first": "J",
                    "middle": [
                        "B"
                    ],
                    "last": "Plotkin",
                    "suffix": ""
                }
            ],
            "year": 2018,
            "venue": "Proceedings of the National Academy of Sciences of the United States of America",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {
                "DOI": [
                    "10.1073/pnas.1804015115"
                ]
            }
        },
        "BIBREF41": {
            "ref_id": "b41",
            "title": "How Good Are Deep Phylogenetic Trees?', Current Opinion in Genetics & Development",
            "authors": [
                {
                    "first": "H",
                    "middle": [],
                    "last": "Philippe",
                    "suffix": ""
                },
                {
                    "first": "J",
                    "middle": [],
                    "last": "Laurent",
                    "suffix": ""
                }
            ],
            "year": 1998,
            "venue": "",
            "volume": "8",
            "issn": "",
            "pages": "616--639",
            "other_ids": {}
        },
        "BIBREF42": {
            "ref_id": "b42",
            "title": "Amino Acid Coevolution Induces an Evolutionary Stokes Shift",
            "authors": [
                {
                    "first": "D",
                    "middle": [
                        "D"
                    ],
                    "last": "Pollock",
                    "suffix": ""
                },
                {
                    "first": "G",
                    "middle": [],
                    "last": "Thiltgen",
                    "suffix": ""
                },
                {
                    "first": "R",
                    "middle": [
                        "A"
                    ],
                    "last": "Goldstein",
                    "suffix": ""
                }
            ],
            "year": 2012,
            "venue": "Proceedings of the National Academy of Sciences of the United States of America",
            "volume": "109",
            "issn": "",
            "pages": "1352--1361",
            "other_ids": {}
        },
        "BIBREF43": {
            "ref_id": "b43",
            "title": "Correcting the Bias of Empirical Frequency Parameter Estimators in Codon Models",
            "authors": [
                {
                    "first": "S",
                    "middle": [
                        "K"
                    ],
                    "last": "Pond",
                    "suffix": ""
                }
            ],
            "year": 2010,
            "venue": "PLoS One",
            "volume": "5",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF44": {
            "ref_id": "b44",
            "title": "Model Selection and Model Averaging in Phylogenetics: Advantages of Akaike Information Criterion and Bayesian Approaches over Likelihood Ratio Tests",
            "authors": [
                {
                    "first": "D",
                    "middle": [],
                    "last": "Posada",
                    "suffix": ""
                },
                {
                    "first": "T",
                    "middle": [
                        "R"
                    ],
                    "last": "Buckley",
                    "suffix": ""
                }
            ],
            "year": 2004,
            "venue": "Systematic Biology",
            "volume": "53",
            "issn": "",
            "pages": "793--808",
            "other_ids": {}
        },
        "BIBREF45": {
            "ref_id": "b45",
            "title": "Empirical Profile Mixture Models for Phylogenetic Reconstruction",
            "authors": [
                {
                    "first": "S",
                    "middle": [
                        "L"
                    ],
                    "last": "Quang",
                    "suffix": ""
                },
                {
                    "first": "O",
                    "middle": [],
                    "last": "Gascuel",
                    "suffix": ""
                },
                {
                    "first": "N",
                    "middle": [],
                    "last": "Lartillot",
                    "suffix": ""
                }
            ],
            "year": 2008,
            "venue": "Bioinformatics",
            "volume": "24",
            "issn": "",
            "pages": "2317--2340",
            "other_ids": {}
        },
        "BIBREF46": {
            "ref_id": "b46",
            "title": "Posterior Summarisation in Bayesian Phylogenetics Using Tracer 1",
            "authors": [
                {
                    "first": "A",
                    "middle": [],
                    "last": "Rambaut",
                    "suffix": ""
                }
            ],
            "year": 2018,
            "venue": "Systematic Biology",
            "volume": "7",
            "issn": "",
            "pages": "901--905",
            "other_ids": {}
        },
        "BIBREF47": {
            "ref_id": "b47",
            "title": "Detecting Adaptation in Protein-Coding Genes Using a Bayesian Site-Heterogeneous Mutation-Selection Codon Substitution Model",
            "authors": [
                {
                    "first": "N",
                    "middle": [],
                    "last": "Rodrigue",
                    "suffix": ""
                },
                {
                    "first": "N",
                    "middle": [],
                    "last": "Lartillot",
                    "suffix": ""
                }
            ],
            "year": 2005,
            "venue": "On the Statistical Interpretation of Site-Specific Variables in Phylogeny-Based Substitution Models",
            "volume": "193",
            "issn": "",
            "pages": "4629--4663",
            "other_ids": {}
        },
        "BIBREF48": {
            "ref_id": "b48",
            "title": "H1 and H7 Influenza Haemagglutinin Structures Extend a Structural Classification of Haemagglutinin Subtypes",
            "authors": [
                {
                    "first": "R",
                    "middle": [],
                    "last": "Russell",
                    "suffix": ""
                }
            ],
            "year": 2004,
            "venue": "Virology",
            "volume": "325",
            "issn": "",
            "pages": "287--96",
            "other_ids": {}
        },
        "BIBREF49": {
            "ref_id": "b49",
            "title": "Detecting High-Order Epistasis in Nonlinear Genotype-Phenotype Maps",
            "authors": [
                {
                    "first": "Z",
                    "middle": [
                        "R"
                    ],
                    "last": "Sailer",
                    "suffix": ""
                },
                {
                    "first": "M",
                    "middle": [
                        "J"
                    ],
                    "last": "Harms",
                    "suffix": ""
                }
            ],
            "year": 2017,
            "venue": "Genetics",
            "volume": "205",
            "issn": "",
            "pages": "1079--88",
            "other_ids": {}
        },
        "BIBREF50": {
            "ref_id": "b50",
            "title": "Contingency and Entrenchment in Protein Evolution under Purifying Selection",
            "authors": [
                {
                    "first": "P",
                    "middle": [],
                    "last": "Shah",
                    "suffix": ""
                },
                {
                    "first": "D",
                    "middle": [
                        "M"
                    ],
                    "last": "Mccandlish",
                    "suffix": ""
                },
                {
                    "first": "J",
                    "middle": [
                        "B"
                    ],
                    "last": "Plotkin",
                    "suffix": ""
                }
            ],
            "year": 2015,
            "venue": "Proceedings of the National Academy of Sciences of the United States of America",
            "volume": "112",
            "issn": "",
            "pages": "3226--3261",
            "other_ids": {}
        },
        "BIBREF51": {
            "ref_id": "b51",
            "title": "Pyvolve: A Flexible Python Module for Simulating Sequences along Phylogenies",
            "authors": [
                {
                    "first": "S",
                    "middle": [
                        "J"
                    ],
                    "last": "Spielman",
                    "suffix": ""
                },
                {
                    "first": "C",
                    "middle": [
                        "O"
                    ],
                    "last": "Wilke",
                    "suffix": ""
                }
            ],
            "year": 2015,
            "venue": "Molecular Biology and Evolution",
            "volume": "10",
            "issn": "",
            "pages": "1097--108",
            "other_ids": {}
        },
        "BIBREF52": {
            "ref_id": "b52",
            "title": "RAxML-VI-HPC: Maximum Likelihood-Based Phylogenetic Analyses with Thousands of Taxa and Mixed Models",
            "authors": [
                {
                    "first": "A",
                    "middle": [],
                    "last": "Stamatakis",
                    "suffix": ""
                }
            ],
            "year": 2006,
            "venue": "Bioinformatics",
            "volume": "22",
            "issn": "",
            "pages": "2688--90",
            "other_ids": {}
        },
        "BIBREF53": {
            "ref_id": "b53",
            "title": "Pervasive Contingency and Entrenchment in a Billion Years of Hsp90 Evolution",
            "authors": [
                {
                    "first": "T",
                    "middle": [
                        "N"
                    ],
                    "last": "Starr",
                    "suffix": ""
                }
            ],
            "year": 2018,
            "venue": "Proceedings of the National Academy of Sciences of the United States of America",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {
                "DOI": [
                    "10.1073/pnas.1718133115"
                ]
            }
        },
        "BIBREF55": {
            "ref_id": "b55",
            "title": "Shifting Fitness and Epistatic Landscapes Reflect Trade-Offs along an Evolutionary Pathway",
            "authors": [
                {
                    "first": "B",
                    "middle": [],
                    "last": "Steinberg",
                    "suffix": ""
                },
                {
                    "first": "M",
                    "middle": [],
                    "last": "Ostermeier",
                    "suffix": ""
                }
            ],
            "year": 2016,
            "venue": "Journal of Molecular Biology",
            "volume": "428",
            "issn": "",
            "pages": "2730--2773",
            "other_ids": {}
        },
        "BIBREF56": {
            "ref_id": "b56",
            "title": "Accelerated Estimation of Frequency Classes in Site-Heterogeneous Profile Mixture Models",
            "authors": [
                {
                    "first": "E",
                    "middle": [],
                    "last": "Susko",
                    "suffix": ""
                },
                {
                    "first": "L",
                    "middle": [],
                    "last": "Lincker",
                    "suffix": ""
                },
                {
                    "first": "A",
                    "middle": [
                        "J"
                    ],
                    "last": "Roger",
                    "suffix": ""
                }
            ],
            "year": 2018,
            "venue": "Molecular Biology and Evolution",
            "volume": "35",
            "issn": "",
            "pages": "1266--83",
            "other_ids": {}
        },
        "BIBREF57": {
            "ref_id": "b57",
            "title": "Estimating the Distribution of Selection Coefficients from Phylogenetic Data Using Sitewise Mutation-Selection Models",
            "authors": [
                {
                    "first": "A",
                    "middle": [
                        "U"
                    ],
                    "last": "Tamuri",
                    "suffix": ""
                },
                {
                    "first": "M",
                    "middle": [],
                    "last": "Reis",
                    "suffix": ""
                },
                {
                    "first": "R",
                    "middle": [
                        "A"
                    ],
                    "last": "Goldstein",
                    "suffix": ""
                },
                {
                    "first": "N",
                    "middle": [],
                    "last": "Goldman",
                    "suffix": ""
                },
                {
                    "first": "M",
                    "middle": [],
                    "last": "Reis",
                    "suffix": ""
                }
            ],
            "year": 2012,
            "venue": "Genetics",
            "volume": "190",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF58": {
            "ref_id": "b58",
            "title": "Evidence That Ebolaviruses and Cuevaviruses Have Been Diverging from Marburgviruses since the Miocene",
            "authors": [
                {
                    "first": "D",
                    "middle": [
                        "J"
                    ],
                    "last": "Taylor",
                    "suffix": ""
                }
            ],
            "year": 2014,
            "venue": "PeerJ",
            "volume": "",
            "issn": "2",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF59": {
            "ref_id": "b59",
            "title": "Epistasis Constrains Mutational Pathways of Hemoglobin Adaptation in High-Altitude Pikas",
            "authors": [
                {
                    "first": "D",
                    "middle": [
                        "M"
                    ],
                    "last": "Tufts",
                    "suffix": ""
                }
            ],
            "year": 2014,
            "venue": "Molecular Biology and Evolution",
            "volume": "32",
            "issn": "",
            "pages": "287--98",
            "other_ids": {}
        },
        "BIBREF60": {
            "ref_id": "b60",
            "title": "ggseqlogo: A Versatile R Package for Drawing Sequence Logos",
            "authors": [
                {
                    "first": "O",
                    "middle": [],
                    "last": "Wagih",
                    "suffix": ""
                }
            ],
            "year": 2017,
            "venue": "Bioinformatics",
            "volume": "33",
            "issn": "",
            "pages": "3645--3652",
            "other_ids": {}
        },
        "BIBREF61": {
            "ref_id": "b61",
            "title": "A Class Frequency Mixture Model That Adjusts for Site-Specific Amino Acid Frequencies and Improves Inference of Protein Phylogeny",
            "authors": [
                {
                    "first": "H",
                    "middle": [
                        "C"
                    ],
                    "last": "Wang",
                    "suffix": ""
                }
            ],
            "year": 2008,
            "venue": "BMC Evolutionary Biology",
            "volume": "8",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF62": {
            "ref_id": "b62",
            "title": "Dating the Age of the SIV Lineages That Gave Rise to HIV-1 and HIV-2",
            "authors": [
                {
                    "first": "J",
                    "middle": [
                        "O"
                    ],
                    "last": "Wertheim",
                    "suffix": ""
                },
                {
                    "first": "Kosakovsky",
                    "middle": [],
                    "last": "Pond",
                    "suffix": ""
                },
                {
                    "first": "S",
                    "middle": [
                        "L"
                    ],
                    "last": "",
                    "suffix": ""
                }
            ],
            "year": 2009,
            "venue": "Molecular Biology and Evolution",
            "volume": "28",
            "issn": "",
            "pages": "7039--7084",
            "other_ids": {}
        },
        "BIBREF63": {
            "ref_id": "b63",
            "title": "ggplot2: Elegant Graphics for Data Analysis",
            "authors": [
                {
                    "first": "H",
                    "middle": [],
                    "last": "Wickham",
                    "suffix": ""
                }
            ],
            "year": 2016,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF64": {
            "ref_id": "b64",
            "title": "A Synchronized Global Sweep of the Internal Genes of Modern Avian Influenza Virus",
            "authors": [
                {
                    "first": "M",
                    "middle": [],
                    "last": "Worobey",
                    "suffix": ""
                },
                {
                    "first": "G",
                    "middle": [
                        "Z"
                    ],
                    "last": "Han",
                    "suffix": ""
                },
                {
                    "first": "A",
                    "middle": [],
                    "last": "Rambaut",
                    "suffix": ""
                }
            ],
            "year": 2010,
            "venue": "Nature",
            "volume": "508",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF65": {
            "ref_id": "b65",
            "title": "Adaptation in Protein Fitness Landscapes Is Facilitated by Indirect Paths",
            "authors": [
                {
                    "first": "N",
                    "middle": [
                        "C"
                    ],
                    "last": "Wu",
                    "suffix": ""
                }
            ],
            "year": 2016,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF66": {
            "ref_id": "b66",
            "title": "Maximum Likelihood Phylogenetic Estimation from DNA Sequences with Variable Rates over Sites: Approximate Methods'",
            "authors": [
                {
                    "first": "Z",
                    "middle": [],
                    "last": "Yang",
                    "suffix": ""
                },
                {
                    "first": "R",
                    "middle": [],
                    "last": "Nielsen",
                    "suffix": ""
                }
            ],
            "year": 1994,
            "venue": "Molecular Biology and Evolution",
            "volume": "39",
            "issn": "",
            "pages": "431--480",
            "other_ids": {}
        },
        "BIBREF67": {
            "ref_id": "b67",
            "title": "ggtree: An R Package for Visualization and Annotation of Phylogenetic Trees with Their Covariates and Other Associated Data",
            "authors": [
                {
                    "first": "G",
                    "middle": [],
                    "last": "Yu",
                    "suffix": ""
                }
            ],
            "year": 2017,
            "venue": "Methods in Ecology and Evolution",
            "volume": "8",
            "issn": "",
            "pages": "28--36",
            "other_ids": {}
        },
        "BIBREF68": {
            "ref_id": "b68",
            "title": "Evolutionary Divergence and Convergence in Proteins",
            "authors": [
                {
                    "first": "E",
                    "middle": [],
                    "last": "Zuckerkandl",
                    "suffix": ""
                },
                {
                    "first": "L",
                    "middle": [],
                    "last": "Pauling",
                    "suffix": ""
                }
            ],
            "year": 1965,
            "venue": "Evolving Genes and Proteins",
            "volume": "",
            "issn": "",
            "pages": "97--166",
            "other_ids": {}
        }
    },
    "ref_entries": {
        "FIGREF0": {
            "text": "Branch lengths inferred on data simulated under a model with site-specific amino-acid preferences. We simulated alignments along a HA phylogenetic tree using an ExpCM parameterized by the actual site-specific amino-acid preferences for an H1 HA(Doud and Bloom 2016). We then inferred the branch lengths of this tree from the simulated alignments. The inferred branch lengths for various models are plotted on the x-axis, and the actual branch lengths used in the simulations are on the y-axis. We performed 10 simulations and inferences, and gray points show each inferred branch length from each simulation, and black points show the average of each branch length across simulations. The gray dashed line at y \u00bc x represents what would be seen if the inferred branch lengths exactly matched those used in the simulations.",
            "latex": null,
            "type": "figure"
        },
        "FIGREF1": {
            "text": "Effect of site-specific amino-acid preferences and Cx rate variation on HA branch length estimation. The branch lengths of the HA tree were optimized using the indicated ExpCM or GY94 model. The amino-acid preferences defining the model (ExpCM) or implied by the model (GY94) are shown as logo plots for 15 sites in HA; the full set of experimentally measured amino-acid preferences are inSupplementary Figs 1-3. The ExpCMs use amino-acid preferences measured in deep mutational scanning of an H1 HA(Doud and Bloom 2016), an H3 HA(Lee et al. 2018), or the average of the measurements for these two HAs. Circle denotes the H1 clade and triangle denotes the H3 clade. The root of each tree is placed where it would fall if the tree was midpoint rooted using the branch lengths inferred by RAxML using the GTRCAT model. This figure enables qualitative visualization of the trees; for a quantitative comparison of branch lengths optimized by different models, seeFig. 5.(Ortlund et al. 2007;Gong, Suchard, and Bloom 2013;Harms and Thornton 2014;Tufts et al. 2014;Starr et al. 2018). This epistasis can lead to shifts in a protein's amino-acid preferences over evolutionary time(Pollock, Thiltgen, and Goldstein 2012;Bazykin 2015;Doud, Ashenberg, and Bloom 2015;Shah, McCandlish, and Plotkin 2015;Haddox et al. 2018).",
            "latex": null,
            "type": "figure"
        },
        "FIGREF2": {
            "text": "Modeling site-specific amino-acid preferences using deep mutational scanning experiments extends branch lengths, especially for branches leading to the HA used in the experiment. The points indicate the total length of branches separating all pairs of tips on the HA phylogenetic tree when the tree is optimized under the indicated model. Blue and orange denote branches that lead to the H1 and H3 HAs used in the deep mutational scanning. The amino-acid preference set defining the ExpCM is labeled above each plot. (a) ExpCMs defined by amino-acid preferences from any of the deep mutational scanning experiments estimate generally longer branches than the GY94 model, with the increase particularly pronounced for branches leading to the HA used in the experiment. (b) The addition of Cx rate variation further extends branch lengths, without any apparent bias toward the HAs used in the experiment. Note that this figure shows the same data asFig. 4in a different form.",
            "latex": null,
            "type": "figure"
        },
        "FIGREF3": {
            "text": ". (a) The pbMutSel preferences are more correlated with the re-scaled average of the H1 and H3 deep mutational scanning preferences than the individual re-scaled H1 and H3 deep mutational scanning preferences are to each other (Pearson's r: 0.74 versus 0.52). (b) The ExpCM(H1\u00feH3 avg)\u00feCx and pbMutSel models estimated similar branch lengths when fit to the entire HA tree. Points denote branch lengths between all pairs of tips on the tree. Blue and orange denote branches that lead to the H1 and H3 deep mutational scanning reference sequences respectively. The phydms program implementing ExpCMs and the PhyloBayes-MPI program implementing pbMutSel models give branch lengths in different units, so to facilitate direct comparison between the models, we have normalized all branch lengths returned by each program by the length of the branches separating the earliest (A/South Carolina/1918) and latest (A/Solomon Islands/2006) seasonal human H1 sequences on the tree.",
            "latex": null,
            "type": "figure"
        },
        "TABREF0": {
            "text": "Fitting of substitution models to the HA phylogenetic tree.",
            "latex": null,
            "type": "table"
        },
        "TABREF1": {
            "text": "version 2.2.2 (available at https://github.com/jbloomlab/divergence_timing_manuscript) to fit the ExpCM and GY94 models. \u2022 pyvolve (Spielman and Wilke 2015a) version 0.8.7 (available at https://github.com/sjspielman/pyvolve) to simulate the sequences. \u2022 PhyloBayes-MPI (Rodrigue and Lartillot 2014) version 1.8 (available at https://github.com/bayesiancook/pbmpi) to fit the pb MutSel model. \u2022 RAxML (Stamatakis 2006) version 8.2.11 (available at https:// github.com/stamatak/standard-RAxML) to infer tree topology. \u2022 We used ggplot2 (Wickham 2016), ggtree (Yu et al. 2017), and ggseqlogo (Wagih 2017) for visualization of the results. \u2022 snakemake (K\u00f6 ster and Rahmann 2012) version 3.11.2 (available at https://snakemake.readthedocs.io/en/stable/) to run the pipelines.",
            "latex": null,
            "type": "table"
        }
    },
    "back_matter": [
        {
            "text": "We thank Erick Matsen and Trevor Bedford for helpful comments about the project and manuscript. S.K.H. is supported in part by training grant T32AI083203 from the NIAID of the National Institutes of Health. This work was supported by the NIAID and NIGMS of the NIH under grant numbers R01AI127893 and R35GM126911. J.D.B. is an Investigator of the Howard Hughes Medical Institute. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript. All code and data used for the analyses in this article are available at https://github. com/jbloomlab/divergence_timing_manuscript.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Acknowledgements"
        },
        {
            "text": "None declared.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Conflict of interest:"
        }
    ]
}