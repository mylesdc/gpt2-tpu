{
    "paper_id": "b386f0bbf59b80952e0320feacb36572c6c3b9ff",
    "metadata": {
        "title": "Supplementary Methods",
        "authors": []
    },
    "abstract": [],
    "body_text": [
        {
            "text": "For short, hybrid and long-read polished assemblies, nucleotide diversity was calculated as follows: High quality short reads from the Western English Channel were mapped back to viral contigs and reads mapping at <95% identity to any viral contig were removed to evaluate nucleotide diversity within established parameters for viral populations (Brum et al., 2015) . Contigs with >10-fold coverage across 70% of their whole genome were retained for robust calculation of the ratio of non-synonymous to synonymous polymorphism rates (Schloissnig et al., 2013; Brum et al., 2015) . Single nucleotide polymorphisms (SNPs) were identified using mpileup and BCFtools (https://samtools.github.io/bcftools/bcftools.html) and those with a quality score >=30, represented by at least 4 reads and comprising >1% of the base pair coverage for that position were considered true SNPs. SNP frequencies across all genomes were rarefied by subsampling to 10\u2a09 coverage proportionate to the frequency of different SNPs per site while maintaining SNPs linkages. Parameters were chosen for conservative estimates, in accordance with previously published work (Schloissnig et al., 2013) . Observed nucleotide diversity (\u2a09\u2a09) (Nei & Li, 1979) was estimated both per contig (median across the length of the contig) and at a per-base level.",
            "cite_spans": [
                {
                    "start": 346,
                    "end": 365,
                    "text": "(Brum et al., 2015)",
                    "ref_id": "BIBREF2"
                },
                {
                    "start": 533,
                    "end": 559,
                    "text": "(Schloissnig et al., 2013;",
                    "ref_id": "BIBREF8"
                },
                {
                    "start": 560,
                    "end": 578,
                    "text": "Brum et al., 2015)",
                    "ref_id": "BIBREF2"
                },
                {
                    "start": 1141,
                    "end": 1167,
                    "text": "(Schloissnig et al., 2013)",
                    "ref_id": "BIBREF8"
                },
                {
                    "start": 1205,
                    "end": 1221,
                    "text": "(Nei & Li, 1979)",
                    "ref_id": null
                }
            ],
            "ref_spans": [],
            "section": "Evaluating capture of more microdiverse viral genomes using long-read assembly"
        },
        {
            "text": "We identified genomic islands in viral contigs from short-read only assembly, hybrid assembly and polished long-read assembly of VirION reads, as described previously (Mizuno, Ghai & Rodriguez-Valera, 2014) , with parameter optimisation to account for increased error in long reads Short read data from the Western English Channel was mapped back against the viral contigs > 10kb using bowtie2 (Langmead & Salzberg, 2012) and samtools (Li et al., 2009) . BAM files were filtered using BamM (http://github.com/ecogenomics/BamM) to remove reads mapping at nucleotide identities ranging from 92-98%, to assess any impact of increased sequencing error in long-read assemblies. Contigs with a median per-base coverage of < 5 or those with a Reads per kb of genome per Gbp of reads mapped (RPKG) of < 1 were identified with BamM and removed from analysis. Genomic islands were defined as regions where the median coverage of a 500 bp sliding window was < 20% of the median coverage of the contig (Mizuno, Ghai & Rodriguez-Valera, 2014) . Putative genomic islands were excluded if they were within 500 bp of the end of a contig. If two genomic islands were found within 500 bp of each other, they were combined into a single genomic island. Lengths of genomic islands and density of genomic islands per contig were calculated for each assembly type. Effect size of different assembly types on genomic island length and density and associated 95% confidence intervals (CI) were calculated from bootstrapped medians (Cumming, 2014).",
            "cite_spans": [
                {
                    "start": 167,
                    "end": 206,
                    "text": "(Mizuno, Ghai & Rodriguez-Valera, 2014)",
                    "ref_id": null
                },
                {
                    "start": 435,
                    "end": 452,
                    "text": "(Li et al., 2009)",
                    "ref_id": null
                },
                {
                    "start": 990,
                    "end": 1029,
                    "text": "(Mizuno, Ghai & Rodriguez-Valera, 2014)",
                    "ref_id": null
                }
            ],
            "ref_spans": [],
            "section": "Evaluating the recovery of genomic islands by inclusion of long-reads in viral metagenomic assembly"
        },
        {
            "text": "As each long read is amplified from a single template strand, it is possible to investigate how conserved the protein content is within genomic islands across viral populations by identifying reads that have different protein content, but which span the same genomic island. First, individual long reads were error corrected with short reads as described previously. Corrected reads with a minimum of 5-fold average coverage for consensus basecalling were selected and mapped back against viral contigs > 10 kbp using minimap2 (https://github.com/lh3/minimap2). Genomic islands with at least 10 VirION reads spanning the full length of the island were selected for further study (137 genomic islands on 84 viral contigs). Median length of predicted proteins on these reads was 75 amino acids (74-76 aa, 95% CI) showing error correction had not been sufficient to correct for the enriched presence of stop codons resulting from indel errors. Therefore, an alternative approach to gene calling was developed. VirION reads spanning genomic islands were trimmed at the 5' and 3' end to leave only the read fragment mapping within the genomic island, and these fragments were used as a query in a BLASTx search against the NR database using diamond (Buchfink, Xie & Huson, 2015) , with the following settings:",
            "cite_spans": [
                {
                    "start": 1244,
                    "end": 1273,
                    "text": "(Buchfink, Xie & Huson, 2015)",
                    "ref_id": "BIBREF0"
                }
            ],
            "ref_spans": [],
            "section": "Evaluating gene content within viral genomic islands using long reads"
        },
        {
            "text": "'-k 500 -more-sensitive -frameshift 15 -subject-cover 20 -evalue 1e-5' Each read fragment had the potential to encode several proteins, along its length, with each putative gene aligning to several similar proteins in the NR database. This information was used to estimate the start and stop loci of each putative gene using an unsupervised learning approach. Identification of the start and stop loci for each putative gene was estimated by hierarchically clustering start and stop loci for each match to an NR protein using Euclidian distance and single linkage. A threshold of 200 bp was used to discriminate between clusters following evaluation of a subset of 100 randomly selected reads at 50, 100, 200 and 500 bp). Below is an example of this clustering performed on read 01360d0f-19c8-4725-9c0f-e28b7b0db8a0_Basecall_2D_2d that mapped to contig P_tig00000038_pilon across its genomic island at 63060-64955 bp. In this example, clustering identified three separate gene products. Minimum start and maximum end loci of each cluster were used to extract putative gene encoding fragments from the VirION reads.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Evaluating gene content within viral genomic islands using long reads"
        },
        {
            "text": "Extracted gene fragments were then used as a query against NR using diamond BLASTX as before, but this time returning only the top hit and requiring at least 20 % of the query matched the subject. In total, 6,445 fragments were extracted from 3,072 reads, of which 4,599 returned a hit to a subject within the NR database. Of these, 3,888 (85%) were assigned to proteins whose title included the words 'hypothetical', 'DUF' (domain of unknown function), 'unknown' or 'uncharacterized'. The remaining 711 hits were then used to calculate the total number of unique annotated reads spanning each GI, the predicted functions within each GI and the number of different taxa identified within each GI. To evaluate whether different VirION reads spanning the same GI encoded different functions, two further criteria were evaluated. Firstly, all proteins hits associated with a genomic island were compared in an all-vs-all BLASTP (expect threshold: 10; word size: 6; matrix: BLOSUM62; gap costs: existence 11; Extension: 1). Different function was assumed if proteins had an alignment score <40. Secondly, start coordinates of different functional genes within a GI were compared to evaluate if one function was adjacent to another in the same genome, rather than being encoded in the same locus, but in different viral genomes. Different functional genes were conservatively assumed to be adjacent if they had an overlap of <100 bp to account for inaccurate identification of the start and end loci on errorprone reads. Results are available in Table S5 .",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 1541,
                    "end": 1549,
                    "text": "Table S5",
                    "ref_id": null
                }
            ],
            "section": "Evaluating gene content within viral genomic islands using long reads"
        }
    ],
    "bib_entries": {
        "BIBREF0": {
            "ref_id": "b0",
            "title": "Fast and sensitive protein alignment using DIAMOND",
            "authors": [
                {
                    "first": "B",
                    "middle": [],
                    "last": "Buchfink",
                    "suffix": ""
                },
                {
                    "first": "C",
                    "middle": [],
                    "last": "Xie",
                    "suffix": ""
                },
                {
                    "first": "D",
                    "middle": [
                        "H"
                    ],
                    "last": "Huson",
                    "suffix": ""
                }
            ],
            "year": 2015,
            "venue": "Nature Methods",
            "volume": "12",
            "issn": "",
            "pages": "59--60",
            "other_ids": {}
        },
        "BIBREF1": {
            "ref_id": "b1",
            "title": "Trimmomatic: a flexible trimmer for Illumina sequence data",
            "authors": [
                {
                    "first": "A",
                    "middle": [
                        "M"
                    ],
                    "last": "Bolger",
                    "suffix": ""
                },
                {
                    "first": "M",
                    "middle": [],
                    "last": "Lohse",
                    "suffix": ""
                },
                {
                    "first": "B",
                    "middle": [],
                    "last": "Usadel",
                    "suffix": ""
                }
            ],
            "year": 2014,
            "venue": "Bioinformatics",
            "volume": "30",
            "issn": "",
            "pages": "2114--2120",
            "other_ids": {}
        },
        "BIBREF2": {
            "ref_id": "b2",
            "title": "Ocean plankton. Patterns and ecological drivers of ocean viral communities",
            "authors": [
                {
                    "first": "J",
                    "middle": [
                        "R"
                    ],
                    "last": "Brum",
                    "suffix": ""
                },
                {
                    "first": "J",
                    "middle": [
                        "C"
                    ],
                    "last": "Ignacio-Espinoza",
                    "suffix": ""
                },
                {
                    "first": "S",
                    "middle": [],
                    "last": "Roux",
                    "suffix": ""
                },
                {
                    "first": "G",
                    "middle": [],
                    "last": "Doulcier",
                    "suffix": ""
                },
                {
                    "first": "S",
                    "middle": [
                        "G"
                    ],
                    "last": "Acinas",
                    "suffix": ""
                },
                {
                    "first": "A",
                    "middle": [],
                    "last": "Alberti",
                    "suffix": ""
                },
                {
                    "first": "M",
                    "middle": [
                        "B"
                    ],
                    "last": "Sullivan",
                    "suffix": ""
                }
            ],
            "year": 2015,
            "venue": "Science",
            "volume": "348",
            "issn": "6237",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF3": {
            "ref_id": "b3",
            "title": "Mauve: multiple alignment of conserved genomic sequence with rearrangements",
            "authors": [
                {
                    "first": "Ace",
                    "middle": [],
                    "last": "Darling",
                    "suffix": ""
                },
                {
                    "first": "B",
                    "middle": [],
                    "last": "Mau",
                    "suffix": ""
                },
                {
                    "first": "F",
                    "middle": [
                        "R"
                    ],
                    "last": "Blattner",
                    "suffix": ""
                },
                {
                    "first": "N",
                    "middle": [
                        "T"
                    ],
                    "last": "Perna",
                    "suffix": ""
                }
            ],
            "year": 2004,
            "venue": "Genome Research",
            "volume": "14",
            "issn": "",
            "pages": "1394--1403",
            "other_ids": {}
        },
        "BIBREF4": {
            "ref_id": "b4",
            "title": "Geneious basic: an integrated and extendable desktop software platform for the organization and analysis of sequence data",
            "authors": [
                {
                    "first": "M",
                    "middle": [],
                    "last": "Kearse",
                    "suffix": ""
                },
                {
                    "first": "R",
                    "middle": [],
                    "last": "Moir",
                    "suffix": ""
                },
                {
                    "first": "A",
                    "middle": [],
                    "last": "Wilson",
                    "suffix": ""
                },
                {
                    "first": "S",
                    "middle": [],
                    "last": "Stones-Havas",
                    "suffix": ""
                },
                {
                    "first": "M",
                    "middle": [],
                    "last": "Cheung",
                    "suffix": ""
                },
                {
                    "first": "S",
                    "middle": [],
                    "last": "Sturrock",
                    "suffix": ""
                },
                {
                    "first": "S",
                    "middle": [],
                    "last": "Buxton",
                    "suffix": ""
                },
                {
                    "first": "A",
                    "middle": [],
                    "last": "Cooper",
                    "suffix": ""
                },
                {
                    "first": "S",
                    "middle": [],
                    "last": "Markowitz",
                    "suffix": ""
                },
                {
                    "first": "C",
                    "middle": [],
                    "last": "Duran",
                    "suffix": ""
                },
                {
                    "first": "T",
                    "middle": [],
                    "last": "Thierer",
                    "suffix": ""
                },
                {
                    "first": "B",
                    "middle": [],
                    "last": "Ashton",
                    "suffix": ""
                },
                {
                    "first": "P",
                    "middle": [],
                    "last": "Meintjes",
                    "suffix": ""
                },
                {
                    "first": "A",
                    "middle": [],
                    "last": "Drummond",
                    "suffix": ""
                }
            ],
            "year": 2012,
            "venue": "Bioinformatics",
            "volume": "28",
            "issn": "",
            "pages": "1647--1649",
            "other_ids": {}
        },
        "BIBREF6": {
            "ref_id": "b6",
            "title": "The sequence alignment/map format and SAMtools",
            "authors": [],
            "year": 2009,
            "venue": "Bioinformatics",
            "volume": "25",
            "issn": "",
            "pages": "2078--2079",
            "other_ids": {}
        },
        "BIBREF7": {
            "ref_id": "b7",
            "title": "MetaQUAST: evaluation of metagenome assemblies",
            "authors": [
                {
                    "first": "A",
                    "middle": [],
                    "last": "Mikheenko",
                    "suffix": ""
                },
                {
                    "first": "V",
                    "middle": [],
                    "last": "Saveliev",
                    "suffix": ""
                },
                {
                    "first": "A",
                    "middle": [],
                    "last": "Gurevich",
                    "suffix": ""
                }
            ],
            "year": 2016,
            "venue": "Bioinformatics",
            "volume": "32",
            "issn": "",
            "pages": "1088--1090",
            "other_ids": {}
        },
        "BIBREF8": {
            "ref_id": "b8",
            "title": "Genomic variation landscape of the human gut microbiome",
            "authors": [
                {
                    "first": "S",
                    "middle": [],
                    "last": "Schloissnig",
                    "suffix": ""
                },
                {
                    "first": "M",
                    "middle": [],
                    "last": "Arumugam",
                    "suffix": ""
                },
                {
                    "first": "S",
                    "middle": [],
                    "last": "Sunagawa",
                    "suffix": ""
                },
                {
                    "first": "M",
                    "middle": [],
                    "last": "Mitreva",
                    "suffix": ""
                },
                {
                    "first": "J",
                    "middle": [],
                    "last": "Tap",
                    "suffix": ""
                },
                {
                    "first": "A",
                    "middle": [],
                    "last": "Zhu",
                    "suffix": ""
                },
                {
                    "first": "A",
                    "middle": [],
                    "last": "Waller",
                    "suffix": ""
                },
                {
                    "first": "D",
                    "middle": [
                        "R"
                    ],
                    "last": "Mende",
                    "suffix": ""
                },
                {
                    "first": "J",
                    "middle": [
                        "R"
                    ],
                    "last": "Kultima",
                    "suffix": ""
                },
                {
                    "first": "J",
                    "middle": [],
                    "last": "Martin",
                    "suffix": ""
                },
                {
                    "first": "K",
                    "middle": [],
                    "last": "Kota",
                    "suffix": ""
                },
                {
                    "first": "S",
                    "middle": [
                        "R"
                    ],
                    "last": "Sunyaev",
                    "suffix": ""
                },
                {
                    "first": "G",
                    "middle": [
                        "M"
                    ],
                    "last": "Weinstock",
                    "suffix": ""
                },
                {
                    "first": "P",
                    "middle": [],
                    "last": "Bork",
                    "suffix": ""
                }
            ],
            "year": 2013,
            "venue": "Nature",
            "volume": "493",
            "issn": "7430",
            "pages": "45--50",
            "other_ids": {}
        }
    },
    "ref_entries": {},
    "back_matter": []
}