At each iteration, the following moves were performed: (a) resampling by blocks of the daily effective contact rates β t andβ t (t = 1, . . . , T , where T is the duration of the epidemic) ; (b) resampling of hyperparameters σ andσ ; (c) for four randomly chosen cases, resampling of the times of onset of infectivity and changing the times for the end of infectivity while keeping the durations of the infectious period constant; (d) resampling of the times for the end of each patient's infectious period ; (e) resampling of m and q (mean and standard deviation for the duration of the infectious period) ;
. For move (a), the 'blocking' strategy devised by Knorr-Held was applied [1] . For each block, proposed values were drawn from a multinormal distribution, taking into account temporal correlation. The block size (4 days) was selected to yield approximately 25% acceptance rate. For moves (b) to (h), random-walk Metropolis sampling was performed [2, 3] . Because of the complexity of the sampling, we first checked that, in the absence of data, the posterior joint distribution was not different from the prior distribution. Then 2.1 × 10 6 iterations of the MCMC were performed with the data, and the first 10 5 were discarded. The output was then sampled every 100 iterations and recorded as an independent sample of size 2 4 from the joint posterior distribution. The computational time was about a week on an IntelXeon X3360 2.8 GHz Linux machine. The convergence of the joint chain was assessed by running chains from various starting points and by visually inspecting the parameter quantiles. There was no indication of failure to converge, although convergence was slower for the first few days of β t andβ t than for other parameters (see Figure S2 .1).