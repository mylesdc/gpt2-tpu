Herbal formulas from traditional Chinese medicines (TCMs) have been extensively used in clinics as effective therapies, but it is still a great challenge to demonstrate the scientific basis for their therapeutic effects at the level of molecular biology. By taking a classic herbal formula (Yu Ping Feng decoction, YPF) as an example, this study developed a novel network pharmacology based method to identify its potential therapeutic targets. First, this study constructed a "targets-(pathways)-targets" (TPT) network in which targets of YPF were connected by relevant pathways; then, this network was decomposed into separate modules with strong internal connections; lastly, the propensity of each module toward different diseases was assessed by a contribution score. On the basis of a significant association between network modules and therapeutic diseases validated by chi-square test (p-value < 0.001), this study identified the network module with the strongest propensity toward therapeutic diseases of YPF. Further, the targets with the highest centrality in this module are recommended as YPF's potential therapeutic targets. By integrating the complicated "multi-targetsmulti-pathways-multi-diseases" relationship of herbal formulas, the method shows promise for identifying its potential therapeutic targets, which could contribute to the modern scientific illustration of TCMs' traditional clinical applications.
As a safe and effective formula, it has been reported to relieve idiopathic sweating and augment appetite in end-stage cancer patients 14 , prevent viral infections, such as severe acute respiratory syndrome 15, 16 , and have immunoregulatory or beneficial effects in asthma 17, 18 , hepatic-fibrosis 19 , pulmonary-fibrosis [20] [21] [22] , and dermatitis models 23 . Since explanations for the clinical application of YPF decoction have not yet been illustrated by the conventional method (such as the in vitro activity assays of selected compounds) due to difficulties in the experimental design of complex systems, its underlying mechanism remains to be explored.
Thus, this study aimed to develop an NP-based method for identifying potential therapeutic targets of traditional herbal formulas by taking YPF decoction as an example. This method gathered relevant bioinformatics information about YPF decoction to identify its underlying therapeutic targets and shed light on the NP-based mechanism of herbal formulas' traditional clinical applications. The workflow of the NP-based approach and its application in YPF decoction is shown in below (Fig. 1) .
In this study, first, the putative targets of compounds from YPF decoction were enriched to pathways to create the targets-pathways interaction, and the diseases related to these pathways were collected to create the pathways-diseases interactions. Next, the targets-pathways interactions were used to generate a "targets-(pathways)targets" (TPT) network with partitioned modules (clusters), in the TPT network, targets act as nodes, and they are connected by relevant pathways (edges). Based on the TPT network, we hypothesised that if a group of protein targets were gathered to form a module naturally, they might share a functional similarity. Herein, a contribution score (CS) was calculated to evaluate the contribution of each module to different diseases based on the network modules' partition and pathways-diseases interactions. Further, the module with the highest CS to relevant diseases of YPF as well as the notable targets within the module were identified to explore potential therapeutic targets of YPF. The detailed procedures are more fully described in the methods section.
The targets-pathways-diseases interaction profile of YPF decoction. YPF decoction consists of three herbs and a total of 352 compounds, which were collected with PubChem CID and they belonged to flavonoids, saponins, saccharides, and volatile components (including phenylpropanoids, monoterpenes, sesquiterpenes, diterpenes, and triterpenes). The rapid development of bioinformatics and computational sciences has provided a wide range of approaches for targets prediction of small molecules 24 . In this study, the putative targets of compounds were identified based on the similarity ensemble approach (SEA: http://sea.bkslab.org/) 25 . The potential targets of 250 compounds were successfully predicted by the SEA, with a total of 968 protein targets. (A worth-mentioning issue is about the high amount of 968 potential "targets" of YPF decoction, especially in terms of the relative small target pool of SEA. We tried to narrow the scope of potential "targets" of YPF decoction by setting up a pre-enrichment filter based on Tc threshold value. In this way, the number of "targets" for enrichment analysis sharply decreases from 968 to 304. However, the results of the most-important potential therapeutic targets and potential active compounds of YPF have no obvious changes. Thus, we still chose the post-enrichment filtering strategy, considering the advantage of this strategy with more informative reference to alternative targets. Throughout this paper, the term "targets" refers to the putative proteins to which the ingredients from YPF decoction directly bind, according to SEA predictions; however, it is not known whether targets are responsible for the therapeutic effect of YPF decoction. The term "therapeutic targets" refers to partial proteins from targets that have been identified to be responsible for the therapeutic effect of YPF decoction by our novel NP-based method.) Then, the target-pathway interactions were generated to elucidate the biological pathways that YPF decoction might impact; moreover, the overrepresented KEGG pathways of the predicted 968 protein targets of YPF were identified from enrichment analysis. A total of 132 highly related pathways with 549 relevant protein targets were obtained. Please refer to supplementary dataset for more detailed information about the compounds (Supplementary Table S1 ), putative targets (Supplementary Table S2 ) and relevant pathways (Supplementary  Table S3) .
To understand what role the enriched pathways might play from a therapeutic angle, the Kyoto Encyclopedia of Genes and Genomes 26 (KEGG; http://www.genome.jp/kegg/pathway.html) was used to identify the diseases with which each pathway might be involved. Since each pathway might participate in various bioprocesses in vivo, it is also possible that each pathway could be relevant to multi-diseases, and that each disease might be contributed to by multi-pathways. Next, a total of 43 diseases that the 132 pathways might impact were retrieved from the KEGG database to create the pathways-diseases interaction. Finally, the targets-pathways-diseases interaction profile of YPF decoction was generated. (Throughout this paper, the term "diseases" refers to the disease category of the diseases relevant to the pathways. Please refer to Supplementary Table S4 for detailed information about the pathways-diseases relationship.)
Network modules (clusters or communities) refer to subnetworks whose nodes are more strongly connected to one another than to the rest of the network. That is to say, modules are sets of highly interconnected nodes. The identification of these modules is of crucial importance as they might help to uncover the hidden structural information within a network. Network modules have been utilised in NP-based TCM studies to uncover the combinations rule of herbal medicines 27 , chemical modules with similar structures 28 , and proteins with similar functions [29] [30] [31] . Especially in the context of TCMs as a typical complex system of multi-components and multi-targets, network modularity based of the Law of Like Attracts Like was considered to be a powerful way to sketch the complexity of TCMs.
The complicated targets-pathways-diseases interaction of YPF in Fig. 2 (a) showed a preliminary NP-based bioinformatics profile of YPF decoction, by employing the most frequently used network analysis method in research on traditional remedies for therapeutic targets' prediction. The nodes represent putative targets of YPF (orange), relevant pathways (light blue), and diseases (deep purple). From Fig. 2(a) , it is difficult to determine which targets might be most relevant to the therapeutic effect that YPF exerts; therefore, the novel TPT network was established to realise the recognition of therapeutic-based targets of YPF decoction, as shown in Fig. 2 (b). Eight modules (modules 1-8) were detected and divided by the Louvain algorithm incorporated in the Gephi software at a resolution of 1.0 32, 33 . According to graph theory, the TPT network shown in Fig. 2 (b) suggests some significant structural information, especially when considering the relatively separated modules with dense internal connections. Then, the inner interactions (edges representing the common pathways between every two nodes) of each target module were further investigated.
The targets in module 1, module 2, and module 3 were connected by the "proteasome" (hsa03050), "lysine degradation" (hsa00310), and "aminoacyl-tRNA biosynthesis" (hsa00970) pathways, respectively; the inner connection of the targets in module 6 was "protein digestion and absorption" (hsa04974) and in module 8, it was the "insulin signaling pathway" (hsa04910).
Three major modules (module 4, module 5 and module 7) could be easily identified from the network in Fig. 2(b) . In addition, the inner connection of the targets in module 4 was the "neuroactive ligand-receptor interaction" (hsa04080) pathway. The connections between targets in module 5 were almost metabolism-related pathways, and the pathways in module 7 were pathways that immune-related, which was the most complicated. The results are shown in Table 1 . From the results, we inferred that the target modules in the TPT network might represent the module shares' different functional propensities. Thus, a contribution score (CS) was calculated from the newly established contribution-scoring algorithm to assess the relationship between each module and relevant diseases in the following study by integrating the modularity partition of the TPT network, target-pathway interactions, and pathway-disease interactions. The contribution-scoring algorithm is presented in the Method section in detail.
Contribution score (CS) of modules toward diseases. Following the partition of the modules, the CS was calculated to evaluate the contribution of each module to each disease by the contribution scoring algorithm, the results of which are shown in a heat map (Fig. 3) ; the modules are listed in a row and the diseases in a column. The gradually changing colours, from deep blue to white, represent the highest to the lowest CS, respectively.
The result which was presented in Fig. 3 implies that each module might contribute differently to the 43 diseases, while the statistical results of the chi-square (χ 2 ) test (p-value < 0.001) further indicate the significant association of modules 1-8 to these diseases. The contribution propensity of each module to diseases was further discussed as follows.
It could be found from Fig. 3 with the other modules. In addition, it has been mentioned above that the targets in module 2 were connected by the "lysine degradation" pathway (hsa00310). Herein, the targets in module 2 might interfere with autism through lysine degradation, which has been already implicated in autism by previous studies [34] [35] [36] .
Compared to other modules, the targets in module 4, which were connected by the neuro-relevant "neuroactive ligand-receptor interaction" pathway (hsa04080), contribute to hypopituitarism (CS = 1.000) and mental disorders (CS = 0.667) most. Though hypopituitarism is a chronic endocrine illness, it is still regulated by the nervous system 37, 38 . Thus, we inferred that the targets in module 4 would exert neuro-relevant function when affected by compounds.
The targets in module 5 were mainly connected by metabolism-relevant pathways, and they contribute to congenital developmental disorders (CS = 1.000), mental retardation (CS = 0.625), and inherited metabolic disease (CS = 0.503). Module 7 contributes to various diseases, including infectious disease (CS = 0.856), immune system disease (CS = 0.844), primary immunodeficiency (CS = 0.803), cancer (CS = 0.780), gastrointestinal disease (CS = 0.759), and autoimmune disease (CS = 0.750). Thus, it was inferred that the targets in module 7 would possess a higher possibility of exerting an immune-relevant function when affected by compounds, compared with other modules.
To ensure the reliability of the results, targets in the network that are associated with the drugs approved for the market are used to validate the association between diseases and network modules. The approved drug Figure 2 . (a) Targets-pathways-diseases network, and (b) Targets-(pathways)-targets network with modularity partition. Nodes in (a) represent targets of YPF decoction (orange), relevant pathways (light blue), and diseases (deep purple), while edges represent the interaction of targets-pathways-diseases. Nodes in (b) represent the targets of YPF decoction, while edges refer to relevant pathways of these targets. If two nodes are connected by an edge, this indicates that they have been enriched to participate in at least one of the same pathways. Eight modules (modules 1-8) presented in different colours were detected and partitioned by the Louvain algorithm incorporated in the Gephi software. information and drug-target interactions were extracted from the Drugbank database 39 and DrugCentral database 40 . The therapeutic area of the drugs was determined by the Anatomical Therapeutic Chemical Classification System code (ATC code), which is attributed to a drug by the WHO Collaborating Centre (WHOCC) for Drug Statistics Methodology 41 . The ATC code classifies drugs according to the following five levels: level 1, the organ or anatomical system on which they act; level 2, the pharmacological action; levels 3 and 4, the chemical, pharmacological, and therapeutic subgroups; and level 5, the specific single drug or drug combination. In this study, the ATC code of the approved drugs was abbreviated to level 1 to understand the organ or anatomical system on which they act. For example, the ABL1 (tyrosine-protein kinase ABL1) has been reported to be targeted by the drug "dasatinib", whose ATC code is L01XE06, and the connotation is shown as follows: The level 1 abbreviation of the ATC code for dasatinib is L, which denotes that the therapeutic area of the drug dasatinib is antineoplastic and immunomodulating. Then, it was further inferred that the target ABL1 might be bound to exert antineoplastic and immunomodulating functions.
The verification result showed that, in the TPT network, 40 targets were identified to be targeted by approved drugs to exert therapeutic effects on the nervous system, among which 30 targets (~75%) are located in module 4, seven in module 5, and only two in module 6 and module 7, respectively. This indicates that the targets in module 4 contribute most to the nervous system, which is consistent with the contribution-scoring result; in total, 54 targets were identified to be targeted by approved drugs to exert antineoplastic and immunomodulating activity. Among these, 34 targets (~65%) are located in module 7, 15 (~25%) in module 5, two in module 1 and module 4, respectively, and only one in module 8. This indicates that the targets in module 7 contribute most to the immune system, which is consistent with the contribution-scoring result.
The verification results can also be found in Fig. 4 . (Please refer to Supplementary Table S5 for detailed information of the targets with relevant approved drugs.) The chi-square (χ 2 ) test (p-value < 0.001) of the results further indicates the significant association between network modules and diseases in terms of the targets of marketed drugs and the consistency in the main modules between predicted functions and drug indications in the real world.
The module that contributes most to YPF-relevant diseases. To understand which network module contributes most to the therapeutic effects of YPF decoction, the CS of each module toward relevant diseases of YPF was selected for the following analysis. The relevant diseases of YPF decoction are immune system disease 16, [42] [43] [44] , autoimmune diseases 16, 45, 46 , infectious diseases 16, 45, 46 , respiratory diseases 20,46-48 , and cancer 49, 50 , according to the information retrieved from the publications, which is listed in Table 2 . (The term "relevant diseases" refers to the diseases that are affected by YPF, while the term "irrelevant diseases" denotes those diseases that are relevant to the enriched pathways of YPF targets but have not been reported to be affected by YPF). The ratio of the CS of modules 1-8 to relevant diseases of YPF is presented in Fig. 5 , which indicates that targets in module 7 contribute most to immune system diseases, infectious diseases, autoimmune diseases, and cancer; respiratory diseases are mainly contributed to by targets in module 6 and module 7. From a general perspective, YPF decoction might interfere with the targets in module 7 with a higher possibility of exerting therapeutic activity. YPF decoction is a classic formula with immune-regulatory effects, and module 7 showed the highest potential for curing its relevant disorders compared to other modules. Thus, the 199 targets (nodes) were considered to be the potential therapeutic targets of YPF decoction. Please refer to Supplementary Table S6 for more detailed information about the targets.
Although YPF decoction is less known to exhibit anti-neoplastic activity directly in traditional applications, modern research has shown its potential in the treatment of idiopathic sweating of unknown cause in end-stage cancer patients 14 and Lewis lung cancer in vitro 50 . There is extensive evidence showing a close relationship between inflammation and cancer [51] [52] [53] [54] ; that is, chronic inflammation contributes to cancer. Thus, the anti-neoplastic activity of YPF decoction might mainly occur via the regulation of the immune system.
Identification of potential therapeutic targets in module 7. The above identification and CS of modules combined with statistical analysis were carried out to determine the therapeutic targets module that was highly associated with the therapeutic activity of YPF decoction. The following centrality analysis was conducted to evaluate the importance of the targets (nodes) within the therapeutic targets module from the perspective of the topological analysis of the TPT network. Four centrality indicators, i.e., degree centrality, closeness centrality, betweenness centrality, and eigenvector centrality, were used to measure the importance of the targets (nodes) from the different perspectives [55] [56] [57] . Then, an integrated indicator, namely target importance (TI), was calculated accordingly. Next, the top 10% therapeutic targets by TI were selected and recommended for further pharmacology study in the context of the mechanism illustration of YPF decoction. From a holistic perspective, YPF might interfere with targets in module 7 in a synergistic way, some of which (with higher centrality), as illustrated in Table 3 , can be considered to be the most potential therapeutic targets of YPF. Moreover, the compounds relevant to these targets according to the SEA prediction can be recommended as potential active ingredients in YPF decoction in Table 3 .
Previous studies have shown that YPF potentially attenuates allergic inflammation via the regulation of NF-kappa B activation 42 . Thus, it was inferred that YPF might also be relevant to NFKB1 according to the results of this study. Moreover, the top 10% potential therapeutic targets have been reported as a pleiotropic locus that is associated with cancer and a critical factor for acute inflammation associated with asthma, such as PRKCA 58,59 , EGFR 60 , AKT1 61 , RAC1 62,63 , RHAO 64,65 , HDAC1 66 . In the activation by GC, NR3C1 can activate MAPK8 (a seed gene) and several MAPK family members, including MAPK3, which could trigger GAB1 to interfere with asthma disease 67 ; PRKACA shares a close relationship with cardiovascular disease and cancer 68 ; ADCY5 has been found to play a critical role in sensory neuropeptide release and neurogenic inflammation and it is critical in the inflammatory process 69,70 ; CAMK2A 71 is a calcium signaling molecule involved in cell growth and stress-signals Table 2 . Reported diseases that are associated with YPF decoction. integration, and it has been reported to play a tumor-supportive role in osteosarcomas; PLCG2 is an enzyme responsible for ligand-mediated signaling in cells of the hematopoietic system, and it plays a key role in the regulation of immune responses 72 , CREB1 73,74 and CAMK2B 75 are also important for the regulation of immune responses; HRAS and NRAS, which belong to the p21 RAS subfamily of small GTPases, regulates cell proliferation, cytoskeletal organization, and other signaling networks, and they are among the most frequent targets of activating mutations activations in cancer 76 . Moreover, six of these top-ranking targets have been reported to be targeted by approved drugs: EGFR, HDAC1, MAPK3, NFKB1, PRKCA, and RXRA; except for NFKB1, the others are targeted to exert antineoplastic or immunoregulating effects. The drugs cetuximab, gefitinib, afatinib, olmutinib, and brigatinib act on EGFR, and they have been used in cancer therapy; vorinostat and romidepsin act on HDA1, and they are used in primary cutaneous T-cell lymphoma; arsenic trioxide acts on MAPK3, and it has been used to treat acute promyelocytic leukemia; midostaurin acts on PRKCA to treat gastrointestinal stromal tumors; and RXRA is targeted by alitretinoin and bexarotene with the indication of Kaposi's sarcoma skin lesions and primary cutaneous T-cell lymphoma, respectively.
All these previous studies provided validation for our novel TPT network-based study to some extent when using YPF as an example. As a result, targets with the highest centrality in this module are recommended as potential therapeutic targets of YPF decoction. Moreover, among them, there are eight most-important potential therapeutic targets, i.e., PRKCA, EGFR, NFKB1, AKT, CALM1, HDAC1, CREB1, and CAMK2B, which are identified by the relevance to YPF's compounds with Tc value higher than the threshold of SEA method.
The compounds associated with the top ranking targets. The compounds that were predicted to bind to the top-ranking targets (potential therapeutic targets) by SEA are presented in Table 3 . Thus, these compounds were recommended as the potential active ingredients of YPF decoction. Among them, the compounds with a Tc value greater than the threshold of SEA are mainly flavonoids, including oroxylin A, psoralen, quercetin, tectochrysin, wogonin, chrysin, and isorhamnetin. This result is consistent with a previous report that the flavonoid in YPF shares immunomodulatory effects 9,42 .
Data acquisition and processing. YPF decoction is composed of Astragali Radix (Huang qi in Chinese, AR), Atractylodis Macrocephalae Rhizoma (Bai zhu in Chinese, AMR), and Saposhnikoviae Radix (Fang feng in Chinese, SR). First, the compound information of AR, AMR, and SR were collected from chemical databases, including the traditional Chinese medicines integrated database (TCMID, http://www.megabionet.org/ tcmid/, which contains information from the TCM@Taiwan, traditional Chinese medicine information database (TCM-ID), herbal ingredients' targets (HIT; accessed in May 2016) database, traditional Chinese medicine systems pharmacology (TCMSP; http://lsp.nwsuaf.edu.cn/tcmsp.php; accessed in May 2016) database, the cardiovascular disease herbal database (CVDHD, http://pkuxxj.pku.edu.cn/CVDHD/; accessed in May 2016), and the Chinese Academy of Sciences chemistry database (http://www.organchem.csdb.cn/scdb/; accessed in May 2016). Literature mining also supplemented the information from these databases. The common amino acids and compounds with high molecular weight, such as polysaccharides, were not included in this study. The names of compounds were standardised through SciFinder (https://scifinder.cas.org) according to the Chemical Abstracts Service (CAS) number. Additionally, these compounds' PubChem CIDs were obtained from PubChem (https:// pubchem.ncbi.nlm.nih.gov/) based on chemical names or structures. The protein targets of compounds from YPF decoction were predicted by similarity ensemble approach (SEA: http://sea.bkslab.org/) 25 , which is a chemical similarity searching-based prediction method recognised worldwide for its accuracy 77, 78 . Though the SEA method is capable of accounting only ~2,800 potential active proteins as alternative binding targets, the scale is consistent with the recent recognition of the druggable genome (~3000) [79] [80] [81] . In addition, the limitation of a chemical similarity searching-based prediction method, including the SEA, would be that the prediction is based on the two-dimensional (2D) structure (SMILE information) of compounds, which might produce the same potential targets of the isomeric compounds. Herein, it is not enough to predict solely using SEA or any other chemical similarity searching-based prediction method, when isomeric compound domains in the research. The NP-based study of YPF decoction involved 13 pairs of isomeric compounds in 352 compounds, which would interfere with the result slightly, from a holistic perspective.
Then, enrichment analysis is used to acquire target-pathway interactions which are essential for the further network construction and analysis. The targets were further enriched to KEGG pathways to create the targetspathways relationship using the online tool STRING 82 (http://string-db.org/). The enriched KEGG pathways with false rate discovery (FDR) < 0.01 were used in the subsequent research. The Kyoto Encyclopedia of Genes and Genomes 26 (KEGG; http://www.genome.jp/kegg/pathway.html) was used to identify the diseases with which each pathway might be involved, the disease category information was used to represent the disease.
The diseases that are affected by YPF decoction were retrieved from previous research. First, publications about the topic of YPF were extracted from the Web of Science, and the topic keywords were set as "yupingfeng", "Yu-Ping-Feng", or "gyokuheifusan" (the Japanese name of YPF decoction). Second, the relevant diseases' information was identified, where available. Then, the diseases were classified according to the KEGG database.
Network construction and module identification. From a perspective of topology, the pathway-based associations between targets by enrichment analysis may be described as a network. A familiar representation is obtained by letting N be a set of nodes representing targets, and E be a set of edges where elements of E are unordered pairs of distinct nodes n i , n j representing a pathway-based link between a target pair {n i , n j }. The two sets together are called a simple network G = (N, E). Specifically speaking, a TPT network was established on the one-mode targets-targets interaction, which was transferred by Pajek software 83 from the two-mode "targets-pathways" relationship; then, the TPT network was visualised and analysed by Gephi software 84 . In the TPT network, the nodes refer to protein targets, and each set of two nodes is connected by an edge, which indicates that they are both involved in at least one of the same pathways.
Next, the Louvain algorithm for module identification incorporated in Gephi 32 was adopted to explore the modularity structure of the TPT network. Since the targets in a module are connected by the same pathways or a functionally similar pathway, it was hypothesised that each module would exert a kind of specific function, and different modules would have effects on different diseases. Herein, an evaluation algorithm, named the contribution scoring algorithm, was established to weigh the contribution of each network module to various diseases and, further, to illustrate the TPT network.
Contribution scoring algorithm. On the basis of an existing algorithm for measuring the associated intensity of individual elements between interactive sets 85, 86 , an indicator measuring the intensity of associating a specific network module with a specific disease, named a "contribution score (CS)" was established in this study by integrating the modularity partition of the TPT network, the targets-pathways interactions, and the pathwaysdiseases interactions. In this algorithm, the higher the value (contribution score), the greater the contribution made by the investigated module for a particular disease. Then, the targets in the module with a significant high value toward relevant diseases affected by YPF were considered to be its potential therapeutic targets. The contribution scoring algorithm is defined as follows:
where X ij is a subset of P and refers to the pathways that are relevant to m i and d j simultaneously, and where C m d i j refers to the CS of m i to d j , which is the sum of the contribution of m i to d j through all its relevant p w in X ij . The value of C m d i j varies from 0 to 1: the higher the value, the greater the contribution m i might make to d j ; and all the modules contribute 1 to a particular disease.
Below, an example is given to demonstrate the application of the contribution scoring algorithm. The Fig. 7 (a) represents a TPT network with modules identified, and the Fig. 7 (b) represents a pipeline which was abstracted from Fig. 7(a) .
The TPT network was divided into three modules: module 1 (m 1 ), module 2 (m 2 ), and module 3 (m 3 ). Since p 1 and p 2 connected the protein targets from only one module, m 1 , the contribution of m 1 to p 1 or p 2 could be calculated as
As p 3 and p 4 were contributed to by the protein targets from m 1 and m 2 , and from m 2 and m 3 , separately, the contribution of m 1 or m 2 to m 3, and from m 1 or m 3 to m 4 , could be calculated as and since all three modules were related to p 5 , the contribution of m 1 , m 2 , or m 3 to p 5 could be calculated as could be calculated: C m d 1 1 shared the highest value, indicating that the targets in m 1 contributed the most to d 1 in the TPT network. That is, the targets in m 1 might exert the most potential therapeutic proclivity toward d 1 compared with the targets in other modules. Additionally, the total contribution of the three modules to d 1 was 1.
Statistical validation. The CS, which reflected the contribution of each target module to relevant diseases, could be calculated from the established contribution scoring algorithm. To validate the hypothesis that different modules would have effects on different diseases, the association between network modules and therapeutic diseases was examined by chi-square (χ 2 ) test. The verification of the contribution scoring algorithm based on the information of targets and approved drugs was also conducted by chi-square (χ 2 ) test. where TI i denotes the importance of target i, DC i , BC i , and CC i , and EC i denotes the degree, betweenness, closeness, and eigenvector centrality of target i, respectively; meanwhile, max (DC) , max (BC) , max (CC) , and max (EC) denote the maximum degree, betweenness, closeness, and eigenvector centrality in the therapeutic target module. The value of TI i varied from 0 to 1, and the higher the value shared by a target, the more important the target was in the network from the topological perspective. 
A novel NP-based method that could help discover the core mechanisms of herbal formulas from complicated information and interactive relationships was presented in this study. YPF decoction was investigated by using the NP-based method, which integrated the "multi-targets-multi-pathways-multi-diseases" relationship into a TPT network and a contribution scoring algorithm. The modules in the TPT network with a similar function, especially coinciding with the already known application of YPF decoction, were inferred from the finding that the protein targets in module 7 were highly associated with the underlying mechanism of YPF decoction, especially those with highest centrality as presented in Table 3 . Additionally, some of these targets have been reported to be relevant to the therapeutic activity that YPF might exert. Herein, the network-based method provided an easier and more reliable strategy for uncovering the potential therapeutic targets of YPF. In short, the proposed TPT network combined with the contribution scoring algorithm could be widely applied in the analysis of traditional medicines/formulas with robust effects in clinical care. And, importantly, the most therapeutically related modules coinciding with their clinical applications have a high chance of being associated with potential mechanisms worthy of further experimental investigation.