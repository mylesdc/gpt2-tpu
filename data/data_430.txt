o Spatial methodology 20 available on open street map. We also used several locality listing websites 5-9 to obtain and/or cross 64 check georeferences for caseríos. 65
Municipality (municipio) and district (distrito) were also provided, allowing cross checking for 66 duplicate neighbourhood names and ensure continuity. In addition, searches were made online for 67 local schools, churches, news stories and community groups to cross check locations. Many addresses 68 listed geographic features such as landmarks or road names. Where possible, Google satellite imagery 69 were examined for these features and/or evidence of dwellings. 70
Supplementary Note 2: Sensitivity analysis 71 We explored the sensitivity of our approach by varying the threshold likelihood for linking cases, , 72 and the threshold gain in marginal likelihood used to define the number of edges to create, K. We We assume cases were classified correctly from case investigation as imported or locally-acquired 85 based on recent travel history. Following this assumption, locally acquired cases could have both 86 infected others and been infected themselves. Imported cases could only infect others, as we assume 87 their infection was acquired outside of the country. We also assume a case showing symptoms at time 88 t has been infected by a case which began showing symptoms earlier in time, due to the short time 89 between symptom onset, presentation at health facilities and the beginning of treatment. 90
To infer the most likely pathway of transmission linking observed cases, we use a modified version of 91 10 based upon the independent cascade model 11 . Out data input consisted on a time series of 92 symptom (fever) onset ∈ { 1 , … , }, time ordered such that 1 < 2 , … , < . While the times of 93 symptom onset are known, what is not known is who infected whom. The goal of our model is to infer 94 the most probable network structure, , connecting these infections. We infer solely from the 95 symptom onset times , a serial interval distribution, and hyperprior probability distributions for the 96 serial interval distribution parameters. The serial interval is the time between a given case, , showing 97 symptoms and the appearance of symptoms in a case infected by the earlier case, such that < 98 12 . The serial interval distribution specifies a normalised pairwise transmission likelihood, or the 99 likelihood of case j infecting case i, given the time between symptom onsets, − . 100
We defined a range of priors for possible serial interval distributions to allow for possible variation in 101 transmission dynamics due, for example, to imported infections with P. falciparum. Six cases imported 102 to El Salvador were P. falciparum, however, the remainder of cases were P. vivax. The serial interval 103 distribution of treated, symptomatic P. falciparum malaria, previously characterised using empirical 104 and model-based evidence 13 was adapted to inform the prior distribution for the relationship 105 between time and likelihood of transmission between cases in El Salvador. As a result the prior 106 distribution was altered to better reflect the biology of P. vivax and the dominant vector species in El 107 Salvador, Anopheles albimanus, but was sufficiently uninformative to allow for possible variation in transmission dynamics. In addition, there is a possibility of a small number of asymptomatic or 109 undetected and therefore untreated infections contributing to ongoing transmission, which will take 110 on a longer serial interval. By defining a prior for the shape parameter of a serial interval distribution 111 we can account for some of this uncertainty. 112
The serial interval can be thought of as consisting of: a) time between symptom onset and 113 infectiousness onset 1 b) the time for humans to transmit malaria parasites to mosquito vectors 2 ( c) 114 the period of mosquito infectiousness, and d) the human incubation period. Following recent work in 115 a variety of contexts (currently under review) suggesting that the initial blood stage of infection for P. 116 vivax is shorter than P. falciparum (24 and 29 days compared to 33 and 136 days respectively for P. where governs the shape of the distribution and is the shifting parameter accounting for the 121 incubation period between receiving an infectious bite and the onset of symptoms (see Figure 1A) . 122
The hyperprior for the parameter determining the shape of the Rayleigh distribution was a uniform 123 prior, bounded between 0.001 and 0.01, giving an expected value of 0.005. This gives an expected 124 time between symptom onset of one case and symptom onset of the case it infects of 29 days (95%CI 125 = 16 -300 days, sd = +/-7 days (23-37)), with the lower bound of 25 days (95%CI =16 -299 days, sd = 126 +/-4 days(21-28)) and the upper 47 days (95%CI = 16-300 days sd= +/-18 days (30-66 )). By 127 comparison the expected values for treated P. falciparum from existing literature range between 33 128 days 14 and 49.1 days (95%CI = 33-69) 13 . The hyperprior for the shifting parameter was set between 129 10 and 15 days to account for the extrinsic incubation period within the mosquito and the time 130 between infection and suitable numbers of gametocytes in the blood to lead to symptom onset. 131
There were no confirmed relapse cases in the dataset and all cases were treated with Primaquine and 132
Chloroquine (radical cure) after being detected (treatment is initiated before cases are confirmed by 133 microscopy). Given this, we assume that a case can only be infected once by a case which has shown 134 symptoms earlier in time. the structure of ( | ), namely : 2 ⟶ ℝ power set mappings for a finite set to ℝ, is 163 submodular. Submodularity in the structure of ( | ) yields a natural property of diminishing returns. 164
That is, the incremental value that a single edge makes when added to decreases as the size of the 165 graph increases. Optimising submodular functions is possible using the greedy algorithm with 166 provable and near-optimal performance guarantees 20 11 . To implement the greedy algorithm we start 167 with an empty graph, , and then add edges sequentially such that the marginal gain from each 168 iteration is maximised. Formally, this means we start with = a and then each iteration ( ) 169 evaluate the edge ∈ { , } ∀ < that yields the best marginal gain, = max ∈ \ −1 ( −1 ∪ 170 { }) − ( −1 ), and add this edge to our graph = ∪ { } . We stop when we have reached = 171 { 1 , … , } edges. Due to submodularity, the solution quality on increases with each additional edge, 172 however, the marginal gain quickly asymptotes, thus ensuring sparse solutions. We stopped adding 173 additional edges when the marginal gain in likelihood of adding edges fell below 0.0001(see figure S1 ). 174
We make two modifications to the above optimisation algorithm. Firstly, to incorporate edges known 175 to be importations, we constrain child/infectee, , edges in ∈ { , }∀ < to be only non-imported 176
infections. This ensures that local infections infect imported infections, but imported infections can infect any node. Secondly, to account for variation in the serial interval distribution, we