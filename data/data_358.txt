Inhomogeneous percolation, for its closer relationship with real-life, can be more useful and reasonable than homogeneous percolation to illustrate the critical phenomena and dynamical behaviour of complex networks. However, due to its intricacy, the theoretical framework of inhomogeneous percolation is far from being complete and many challenging problems are still open. In this paper, we first investigate inhomogeneous site percolation on Bethe Lattices with two occupation probabilities, and then extend the result to percolation with m occupation probabilities. The critical behaviour of this inhomogeneous percolation is shown clearly by formulating the percolation probability P p ( ) ∞ with given occupation probability p, the critical occupation probability p p P p = sup{ ( ) = 0} c ∞ , and the average cluster size χ p ( ) where p is subject to P p ( ) = 0 ∞ . Moreover, using the above theory, we discuss in detail the diffusion behaviour of an infectious disease (SARS) and present specific disease-control strategies in consideration of groups with different infection probabilities.
Inhomogeneous percolation, for its closer relationship with real-life, can be more useful and reasonable than homogeneous percolation to illustrate the critical phenomena and dynamical behaviour of complex networks. However, due to its intricacy, the theoretical framework of inhomogeneous percolation is far from being complete and many challenging problems are still open. In this paper, we first investigate inhomogeneous site percolation on Bethe Lattices with two occupation probabilities, and then extend the result to percolation with m occupation probabilities. The critical behaviour of this inhomogeneous percolation is shown clearly by formulating the percolation probability P p ( ) ∞ with given occupation probability p, the critical occupation probability p p P p = sup{ ( ) = 0} c ∞ , and the average cluster size χ p ( ) where p is subject to P p ( ) = 0 ∞ . Moreover, using the above theory, we discuss in detail the diffusion behaviour of an infectious disease (SARS) and present specific disease-control strategies in consideration of groups with different infection probabilities.
Percolation (for reviews see Stauffer 1979 1 , Essam 1980 2 ) is the random occupation of sites or bonds on lattices or networks, named as site percolation or bond percolation, respectively. Site percolation is more general than bond percolation because every bond model may be reformulated as a site model (on a different graph) and the converse is in general not true 3 . The appeal of percolation is the occurrence of a critical phenomenon, which has attracted attention for a wide range of applications: liquid flows in porous media 4, 5 , epidemic spread [6] [7] [8] , granular and composite materials [9] [10] [11] [12] , forest fires [13] [14] [15] and fracture patterns and earthquakes in rocks 16 .
The research originated from homogeneous percolation, i.e., percolation with a single occupation probability. For example, Fisher and Essam (1961) solved homogeneous percolation problems on Bethe lattices 17 ; Sykes and Essam (1964) studied the exact critical occupation probabilities in two dimensions 18 ; Gerald (et al., 2001) derived the value of critical occupation probabilities for a four-dimensional percolation problem on hyper-cubic lattices 19 .
Building on those results, researchers began to study inhomogeneous percolation [20] [21] [22] [23] [24] [25] [26] , in which sites (or bonds) may have different occupation probabilities. In 1982, Kesten 20 obtained a critical surface of occupation probabilities for inhomogeneous percolation on square lattices. In 2013, Grimmett 21 extended the result of inhomogeneous bond percolation to triangular and hexagonal lattices utilizing Russo-Seymour-Welsh (RSW) theory of box-crossings. Recently, Radicchi 27 studied percolation on not necessarily infinite graphs and used graph decomposition methods to identify abrupt and continuous changes in percolation.
In the current paper, we focus on inhomogeneous percolation on Bethe lattices. The interest in a good understanding of this inhomogeneous percolation process is twofold. Firstly, Bethe lattices might hold fractal structures, which allow more complex behaviour than square or triangular lattices. The results of this inhomogeneous percolation on Bethe lattices have more extensive applications, e.g., the spreading problem of social networks or infectious diseases (see section III). Secondly, as is well known, most results on percolation are obtained using the heuristic approximation or numerical approaches [27] [28] [29] and it is difficult to get the exact solutions for average cluster sizes and the percolation probability even for homogeneous percolation. In this paper, we investigate inhomogeneous site percolation on Bethe lattices from two occupation probabilities to m occupation probabilities: for the case of two occupation probabilities, we present the explicit formula of the critical occupation probability and the exact solution of average cluster size χ p ( ); and for the case of m occupation probabilities, because of computational complexity, we formulate and obtain the numerical solutions of average cluster size and percolation probability, which might shed light on deriving the results of inhomogeneous percolation. Besides, we analyse in detail the spread of SARS (an infectious disease) using this inhomogeneous percolation on Bethe lattices with dynamically changing parameters. We present specific control strategies for SARS by comparing the critical infection probabilities, the average numbers of infected individuals for each day, and the probability of the large-scale outbreak of SARS.
In ref. 30 a Bethe lattices is defined to be a tree where each site has Z neighbours, Z is also named coordination number. For the sake of convenience, we denote it as BL Z ( ). On a Bethe lattices, if all sites are occupied randomly with the same probability p, independent of its neighbours, we call the percolation process as homogeneous site percolation and write it as PBL Z p ( ; ). If the sites of a Bethe lattices BL Z ( ) are occupied with different probabilities, then the percolation is inhomogeneous. To be concrete, without loss of generality, assume that Z neighbours of each site are occupied randomly with
, and then, we divide Z neighbours of each site into m different groups (m is the number of types of neighbours according to occupation probabilities), where, n 1 of Z neighbours are sites with occupation probability p 1 , n 2 are sites with occupation probability  p , , 2 and n m are sites with occupation probability p m . The inhomogeneous percolation is indicated with . See Fig. 1 for an illustration of . PBL p p (3; (1, ), (2, )) 1 2 In this paper, we first consider inhomogeneous percolation on a Bethe lattices with = m 2, that is PBL Z n p n p ( ; ( , ), ( , )) , inhomogeneous percolation will specialize to homogeneous percolation on BL(Z) 30 . In a second step, we generalize the results of PBL Z n p n p ( ; ( , ), ( , )) Critical surface of occupation probability. Occupation probability is the probability with which the sites of a network are occupied. For PBL Z n p n p ( ; ( , ), ( , )) 1 1 2 2 , assume that a grandparent site is a first type-site on an infinite lattice, then for the parent site, there are − n 1 1 sub-branches that begin with the first type-sites and n 2 sub-branches beginning with the second type-sites ( Fig. 1.) . According to the binomial distribution, only − + n p n p
2 2 branches are accessible on average. On the other hand, if the grandparent site is a second type-site, then for the parent site, there are n 1 sub-branches that begin with first type-sites and − n 1 2 sub-branches which begin with second type-sites. In this case, on average, only
2 branches are accessible. Recalling that the ratio of these two types of sites is n n / 1 2 , and according to expectation theory, on average, only − + + + − + n n p n p n n p n p n n
branches are accessible at each step. In order to get an infinite cluster, it is necessary that the quantity (1) is equal or greater than one. Therefore, the critical condition such that an infinite cluster (percolating cluster) first occurs is
from equation (2), we derive the critical surface of occupation probability is given by , if the grandparent site is an ith =  i m ( 1, , ) type-site, then for the parent site, there are − n 1 i sub-branches that begin with an ith type-site and n k = ≠  k mk i ( 1, 2, , , ) sub-branches beginning with kth type-sites ( Fig. 1 ). According to the multi-binomial distribution, in this case only ∑
branches are accessible on average. Recalling the occupation probabilities for all types of sites and according to expectation theory, overall, only
branches are accessible on average. In view that ϕ p ( ) is equal to one on the critical surfaces, we have equation (4), the critical surface of  PBL Z n p n p n p ( ; ( , ), ( , ), , ( , ))
; ∞ P p ( ) is the percolation probability (existing infinite clusters). The theory generalizes the concept of exact critical value p c in homogeneous percolation. For consistenc y, we also indicated the critical surface of . In this case p c is degenerated to a critical point, which is consistent with homogeneous percolation (in the supercritical phase, > p p c and in the subcritical phase, < p p ) c . The critical surface of occupation probabilities consists of those probabilities at which the percolation behaviour of the system changes essentially. We can control the percolation behaviour if we know the critical surface of occupation probabilities. ij be the contribution (to the average cluster size) from a sub-branch which begins with a jth type-site and whose parent site is an ith type-site (Fig. 1) . Then
where, the first term is the contribution from the centre site itself, the second term is the contribution from the first type branches, and the third term is the contribution of the second type branches. According to expectation theory, on average, the average cluster size is . PBL(3; (1, p 1 ), (2, p 2 ) ). The left-hand curve is a sketch of the average cluster size χ p ( ) and the right-hand curve is a sketch of the mean size of finite clusters of occupied sites when > p p c .
Scientific RepoRts | 6:22420 | DOI: 10.1038/srep22420
The average cluster size (of occupied sites) χ p p ( , ) 1 2 , which is a function of the occupation probability = p p p ( , ) 1 2 , can reveal the intensity of percolation. For < p p c , χ p ( ) increases rapidly with p (Fig. 3) , and diverges in a power law of the distance between p and p c , as p approaches p c from below. For > p p c , there exist infinite clusters of occupied sites and their number increases as → p 1. On the other hand, the numbers of finite clusters (of occupied sites) and their sizes are reducing. Therefore, for > p p c , the average sizes of finite clusters χ p p ( , ) 1 2 decrease with p increasing (Fig. 3) . Similarly, generalizing the result to  PBL Z n p n p n p ( ; ( , ), ( , ), , ( , ))
ij from equation (10), where the B ij have the same meaning as above Because the explicit expression of χ p ( ) is very complex, we provide only the derivation process.
Percolation probability. In this part, we mainly discuss the percolation probability, i.e., the probability that the origin site belongs to a percolating infinite cluster. Percolation probability is indicated as ∞ P p ( ) that can reveal the intensity of percolating, for > p p c (Fig. 4) . For PBL Z n p n p ( ; ( , ), ( , )) 1 , is the probability that a sub-branch does not connect to the percolating cluster and the sub-branch begins with a jth type-site, whose parent site is an ith type-site. Then, we have PBL (3; (1, p 1 ), (2, p 2 ) ).
Scientific RepoRts | 6:22420 | DOI: 10.1038/srep22420 for each equation of (14) , the first term is the probability that the root site of a sub-branch is not occupied and the second term is the probability that the root site of the sub-branch is occupied but no child sub-branch connects to the percolating cluster. If ≤ p p c , equation (14) has only the trivial solution Fig. 4) . If > p p c , there is a nontrivial solution for equation (14) and then equation (13) has a nonzero solution. In this case, it is not easy to get the exact nontrivial solution of equation (14) for it is a set of multivariable high-order equations. By employing fixed-point iteration, we get a numerical solution of equation (14) instead and then obtain the percolation probability from (13) . From the numerical solution (Fig. 4) , it can be seen that ∞ P p ( ) picks up abruptly at p c then increases rapidly with p increasing. We extend the result to At the beginning of emergence, because of the lack of understanding of SARS and the high mobility of the modern-social activities, SARS spread rapidly. Afterwards, when people found the high infectivity and death rate of SARS, they begun to limit social activity of the public and take strict isolated measure to prevent the spreading of disease then the disease was contained. Is this the proper infection control measure of SARS? Which kind of infectious diseases are suitable for this approach? In fact, the spreading of SARS is a percolation process. Considering the differences of physical resistibility or intimate contact with the infected individual, we divided people into two groups: the people with higher infection probability (e.g., infants and elderly or healthcare workers), named as susceptible persons; and the people with lower infection probability, named as common persons. Then this disease is modelled as inhomogeneous percolation on Bethe lattices with two occupied probabilities, i.e., − PBL Z S p Z S kp ( ; ( , ), ( , )). Here, Z is the average contact number of each person, S (of Z) denotes susceptible persons with infection probability p and Z-S (of Z) is common persons with infection probability kp ≤ ≤ k (0 1). The first case of SARS was confirmed on March 5 (in Beijing, 2003) and the government started reporting the cases from April 20. According to case-reporting data from April 20 to June 23 (in Beijing, 2003) (from the government bulletin) and the control activities of government, we find three other critical time points of SARS: May 1 (it is legal holidays from May 1 to May 7), May 14 (people generally panicked over SARS and limited their social activities), and May 30 (new cases of SARS considerably decreased). Correspondingly, the spreading process of SARS was divided into five stages. Then, by random simulation, we found that the spreading of SARS has a fifteen-day time delay. Therefore, we changed the five stages of the spreading process of SARS into: stage 1-from March 20 to May 4, stage 2-from May 5 to May 15, stage 3-from May 16 to May 28, stage 4-from May 29 to June 13, and stage 5-from June 14 to June 23.
In the initial stage, the average contact number of one infected patient was around fifteen = Z ( 15), in which two or three person had infected SARS (Gong et al. 31 ), so the infection probability was around . = . p 0 149( 0149). We take = S 4 according to the percentage of susceptible people in the population and we set = . k 0 4 by statistical investigation. It is worth noting that the infection probability p is the manifestation of the spreading intensity of the disease, which can only be slightly affected by the protective approach. Therefore, the infection probability was adjusted to 0.1425 in the second stage and third stage, and was adjusted to 0.141 in the fourth stage and fifth stage. The other parameters, i.e., Z and S would change with prevention (isolation of infected patient and restriction of travel) and k remains unchanged in different stages. By statistical investigation, we set Z = 13 and S = 4 in second stage, Z = 12 and S = 3 in third stage, Z = 11 and S = 3 in fourth stage, Z = 8 and S = 2 in fifth stage.
Obviously, the spreading model of SARS (in Beijing) is inhomogeneous percolation on a Bethe lattice with dynamically changing parameters. See Table 1 for the model division and the parameters. (3), equation (6) , and equation (13), we acquire the critical infection probabilities, average number of infected individuals, and the probability of large-scale outbreak for the SARS percolation model − PBL Z S p Z S kp ( ; ( , ), ( , )) in different spreading stages (Table 1) .
It can be concluded from Table 1 , that, if one is infected with SARS and would live as a normal person, then the disease would infect a massive crowd of healthy people except for ≤ Z 13 and ≤ S 3. That warns us, at the initial stage of SARS, humankind should try their best to find SARS patients as early as possible and isolate them from healthy people. Nevertheless, during the incubation period, it is inevitable that some infected persons, who cannot be found and live as the normal person around us that is quite dangerous. At this time, the most effective way is to reduce outdoor activities of public then cut down the average contact number.
For more accurate and meticulous disease-control strategies, we scrutinized the dynamic-dependent relationship between p p , c and the average number of infected cases with subtle parameters by a Monte-Carlo simulation. In the initial stage of the SARS process, from March 20 to April 8, according to the above analysis, = = = . Z S k 15, 4, 04, and = .
p 0 149, based on these, the average number of infected cases of each day was simulated. See Fig. 5(a) for an illustration. It is clear that the random variation of the infected number has an incremental trend and that implies that the disease would infect a large amount of persons. Then from April 9 to April 19, during the second stage of SARS, some protective measures were taken with the understanding of the disease, so parameters changed to = = = . Z S k 13, 4, 04, and = . p 0 1425. By simulation, we found that the infected number changes chaotically as in Fig. 5(b) . With the time going by, from April 20 to May 4, the severity of the disease gradually being known, more protective measures were taken and parameters reduced further to = = = . Z S k 12, 3, 04, and = . p 0 1425. In this stage, the simulation revealed that the average infected number of each day fluctuates with a trend of decline and it would be zero after a period, which predicates the infectious disease can be controlled without any additional measures (Fig. 5(c) ). In fact, by simulating the percolation, we acquire = . (4, 11) 13 (4, 9) 12 (3, 9) 11 (3, 8) critical point, slightly adjusting of the system parameters would cause a fundamental change of the trend of infectious diseases. Therefore, in order control the large-scale outbreak of the disease, we must try our best to make < p p c , even if the infection probability is only a little smaller than the critical infection probability. Actually, if < p p c , the probability of a large outbreak of SARS is zero; and if p reaches and crosses p c , the probability picks up as a power law with exponent one in terms of p-p c , and the disease will outbreak rapidly. of all-finite clusters of infected cases, the χ SI p p ( ( ), ) exhibits negative value when p is greater than p c . By a numerical approach, the sensitivity of the probability of large-scalar outbreak of SARS ∞ SI P p p ( ( ), ) is displayed in Fig. 7 (c). ∞ SI P p p ( ( ), ) has similar characteristics as χ SI p p ( ( ), ). They are both more sensitive near the p c .
In this paper, we present a theoretical framework for inhomogeneous site percolation on Bethe Lattices, and apply it to investigate a diffusion problem of an infectious disease. It is found that the inhomogeneous percolation on Bethe lattices serves as an appropriate model to describe the dynamic spreading behaviour of the infectious disease (SARS). The percolation model of SARS is not only in good agreement with the actual recorded data, but also can be used to predict the future trend of the disease and supply the missing data of the past. Moreover, it can provide quantitative results for government to make more proper disease-control strategies.