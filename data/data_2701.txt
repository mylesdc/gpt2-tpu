Single-molecule data analysis. For force-ramp data, unfolding traces were characterized and unfolding rupture force and extension changes of 1-step unfolding transitions were measured. An approach described by Dudko et al. was 
where ̇( ) is the force loading rate at force F, p(F) is the probability density of unfolding events at force F, ∫ ( ) ∞ is the probability of unfolding events above F, hk is the height of k th bin in the unfolding force distribution histogram that start at F0, ∆F is the bin size of the histogram, i and k are the bin numbers, and N is the total bin number of the histogram. Standard errors were estimated as described previously. 2 Bell's model (Eq. 2) was used to fit the force-dependent kinetics. 3 ln ( ) = ln 0 + ‡ (2) Here, k(F) is the force-dependent reaction rate, k0 (or k(0 pN)) is the reaction rate at zero force, X ‡ is the extension change from the initial state of the reaction to the transition state, β is equal to (kB•T) −1 , in which kB is the Boltzmann constant, and T is absolute temperature (295 K). More complex models 1 were also applied to fit the force-dependent kinetics data but did not yield reliable fitting parameters.
For constant-force data, the distributions of the extension values were fit with Gaussian model to get the extension change values upon (un)folding. 4 The extensible wormlike chain model (EWLC) (Eq. 3) was used to convert the extension change values to number of nucleotides
Here, kB is Boltzmann constant, T is absolute temperature (295 K), P is persistence length, L0 is contour length, and K is stretch modulus. For ssRNA, L0, P and K are 0.59 nm per nucleotide, 1 nm, and 1500 pN, respectively, [6] [7] [8] [9] [10] The lengths of the SRV-1 pseudoknot based on the NMR structure of SF206 (PDB 1E95) (4 nm) 11 and the diameter of a hairpin (2 nm) were taken into consideration.
Thermal unfolding of the SRV-1 RNA pseudoknot SF206 was simulated by REMD. 12, 13 Simulations were carried out using the Gromacs program with the AMBER-99SB force field. 14 The starting structure for the simulations was based on the NMR structure of the "wild-type" SRV-1 pseudoknot SF206 (PDB: 1E95) with residues 1-34 plus a 3' terminal residue A (see Fig.   1a ). 11 We chose the third structure (out of a total of 15 deposited structures) which has the smallest root mean squared deviation (RMSD) to the average structure. A total of 34 sodium counter ions were added to neutralize the pseudoknot. The system was solvated in a box of TIP3P water. The water box (containing 63946 water molecules) was made sufficiently large (10 nm × 8 nm × 8 nm) to prevent the unfolded RNA encountering its periodic image. Periodic boundary conditions were used and the Particle mesh Ewald method (PME) method 15 was implemented to calculate the electrostatic interactions. The energy of van der Waals non-bonded interactions was evaluated using a 10 Å cutoff. The LINCS algorithm was applied to the covalent bonds involving hydrogen atoms. The system was subjected to energy minimization to optimize the initial geometry. The standard molecular mechanics steepest decent algorithm was used. A short 100 ps equilibration with position restraints on all atom was conducted after the energy minimization.
The REMD simulations with the temperature ranging from 310 to 511.7 K were performed for the SRV-1 RNA pseudoknot SF206. The systems were equilibrated for 1 ns at the respective temperatures at the isothermal-isochoric condition with the modified Berendsen (V-rescale) thermostat 16 . Finally, the REMD simulations were at the isothermal-isobaric condition with the Parrinello-Rahman barostat 17, 18 
Mechanical unfolding of the SRV-1 RNA pseudoknot SF206 was simulated by Steered Molecular Dynamics (SMD). [20] [21] [22] All of the simulations were carried out using the Gromacs program with the AMBER-99SB force field. 14,23 Sodium ions and chloride ions with a final concentration of 200 mM were added using the Gromacs program tool. 24 The system was solvated in a box of TIP3P water. 25 To accommodate the completely stretched pseudoknot, the water box (containing 70,800 water molecules) is asymmetric with the dimensions of 60 nm × 6 nm × 6 nm. Periodic boundary conditions were used and the PME 15 was implemented to calculate electrostatic interactions. The energy of van der Waals non-bonded interactions were evaluated using a 14 Å cutoff. The LINCS algorithm was applied to the covalent bonds involving hydrogen atoms. 26 The starting structure for the SMD simulation was the same as in the REMD simulations. The system was equilibrated for 1 ns with only the position restraint on the O5' atom of the 5' terminal G residue at 295 K. The equilibrium and SMD simulation were all performed in an isothermal-isobaric ensemble with a fixed temperature of 295 K and a pressure of 1 atm.
A standard SMD protocol was used to stretch the pseudoknot, similar to the works of White et al. 28 The standard deviations are about 10% of the mean values. K (panel b) , the single distribution peak is close to the native structure with around 16 and 18 hydrogen bonds for stem 2 and stem 1, respectively. At 390 K (panel c), the major distribution peak is still around 16 and 18 H-bonds for stem 2 and stem 1, respectively. However, the minor populations of non-native structures of both stems appear at 390 K. Between 408 and 461 K (panels d-g) , the distribution at zero Hbond of stem 2 gradually becomes the major peak. At temperatures between 481 and 512 K (panels h-i), a new distribution peak with zero H-bond in stem 1 emerges and gradually becomes the major peak. Figure S3 . Free energy plots and structural snapshots obtained from the REMD simulations for SF206. The structural snapshots demonstrate that upon increasing the temperature, stem 2 melts before stem 1. The two-dimensional free energy plot is shown on the left side of each panel. The two reaction coordinates are the numbers of base-base H-bonds formed within stem 1 and stem 2, respectively. The color scheme illustrates the free energy values at 300 K obtained from Boltzmann inversion of the simulation population distributions of H-bonds. Shown on the right side of each panel is the structural snapshot from a selected region marked by a pink cycle in the corresponding free energy plot. Panel a shows the native state. The structural snapshots shown in panels b-e are the intermediate state with stem 2 completed disrupted and stem 1 intact, which becomes an energetically favourable and most populated state at 449 K (see panel e). Stem 1 starts to unfold upon further increasing temperature (panel f), and the state with both stems unfolded becomes dominant at 481 K (panel g). At 512 K, the structure is completely unfolded (panel h). Figure S4 . Representative force-ramp traces. The force (un)loading rate is at about 11 pN/s except for panels a (~ 5 pN/s) and c (~20 pN/s). The data acquisition rate is 100 Hz, except for panels i and j (1000 Hz). Typically a one-step unfolding transition is observed. A rarely observed two-step unfolding trace is shown in panel j. The vertical black arrow in panel j indicates the presence of an unfolding intermediate state. Figure S5 . Rupture force versus extension change of one-step unfolding transitions obtained from force-ramp experiment. The predicted EWLC curves are shown for the pseudoknot to single strand transition. The end-to-end distance of the pseudoknot (4 nm) is taken into consideration. The letters S, H and P represent ssRNA, hairpin and pseudoknot, respectively. At a relatively high force (18 pN), the hairpin structure has a rapid exchange with the singlestranded conformation. The pseudoknot structure is stabilized upon lowering the force to 16-17 pN, and unfolds into the dynamic ensemble of single-stranded and hairpin conformations. At a relatively low force (15 pN), the pseudoknot conformation is further stabilized, and rarely unfolds into the hairpin conformation. Consistently, in the force-ramp experiment, the two-step and one-step unfolding forces for SF217 are in the range of 15-20 pN and > 20 pN, respectively. Thus, the constant-force and force-ramp data of S217 suggest that the energy barrier of pseudoknot to hairpin transitions is higher and stiffer than that of hairpin to pseudoknot. 29 (b) Histograms of extensions in panel a. Extensions were binned to 1 nm. The histograms were fitted using Gaussian functions. Figure S7 . Representative constant-force traces observed for SF348. The 1000 Hz data (cyan) were subsampled to 20 Hz (blue). The letters S, H and P represent ssRNA, hairpin and pseudoknot, respectively. (a) Representative force-jump cycles for pseudoknot SF348 with a zoom-in view for the boxed regions shown in panels b and c. (b) A one-step unfolding transition at 25 pN. (c) As the extension change between intermediate state and pseudoknot sate is very small for SF348, we did not observe the transition directly. However, the refolding trace of SF348 shows similar folding dynamics as that of SF206 (Fig. 4d) and SF217 (Supplementary Fig.  S6 ), i.e., before the pseudoknot conformation forms stably, fast hopping between ssRNA and hairpin intermediate is observed for a few seconds as the force is dropped to 17.0 pN. Figure S8 . One-step rupture force distributions for pseudoknots from force-ramp experiment. The red lines are plotted using parameters from linear fitting in Supplementary Fig. S9 . Figure S9 . Force-dependent unfolding rates extracted from rupture force distributions obtained from force-ramp experiment using Dudko's method. 1 Errors for the unfolding rates are calculated based on Poisson noise. The Bell model was applied to extract the unfolding rates at zero force or other forces ( Fig. 7 and Supplementary Fig. S10 ) and unfolding transition state positions. Errors of lnk are reported as standard errors. Figure S10 . Previously measured in vitro frameshifting efficiency 28 versus unfolding rate, lnk, at varied forces obtained from force-ramp experiment. The plots for 0, 25, and 40 pN are shown in Fig. 7 . Linear fitting was applied for each plot. Error bars of frameshifting efficiency represent standard deviations. Errors of lnk are reported as standard errors.