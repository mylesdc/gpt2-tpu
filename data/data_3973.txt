Supplementary file 1: Metagenomics sample processing protocols consisting of reagents, equipment, reagent setup, and the procedure (steps 1-120, with options for RNA extractions from ticks or mosquitoes) with timing specifications. In addition, a troubleshooting table is given for selected steps as well as some examples for anticipated results with Figures A1, A2, and A3.
•Thermal block for 1.5-ml tubes •Dissection instruments (e.g., forceps, scissors, petri dishes) •Refrigerated centrifuge (for 1.5 -and 2-ml tubes) •Microcentrifuge (for 1.5-and 2-ml tubes) •Centrifuge for microtiter plates (e.g., Hettich, Rotina 380R) •M220 Focused-ultrasonicator with M220 microTUBE holder (Covaris. cat. no. 500301) and fragmentation tubes (MicroTube AFA Fiber Screw Cap 6 x 16 mm, 130 µl; Covaris, cat. no. 520096) •Thermal shaker (e.g., Eppendorf, Thermomixer Comfort) •Vortex mixer (e.g., Scientific Industries, Vortex Genie 2) •Thermal Cycler •Real-time cycler (e.g., Biorad, CFX96 Real-Time System) •Magnetic particle concentrator (MPC; e.g., DynaMag™-2, Life Technologies) •Pipettors: 2.5, 10, 20, 100, 200, 1,000 µl •Plastic lab ware (0.2-, 1.5-and 2-ml tubes and RNase-free pipette filter tips) •1.5-ml low-bind tubes (sterile, Nuclease-free) •96-well Microtiter plates, white, suitable for the used real-time PCR cycler, with suitable sealing film •Disposable gloves •Cotton gloves to handle liquid nitrogen •Personal protective clothing (protective goggles) •Soft laboratory wipes for cleaning
Calibration of AMPure beads (adapted from Refs 1, 2) Let the bead suspension equilibrate to room temperature; resuspend thoroughly via vortexing. Prepare a 900 µl aliquot of vigorously mixed Agencourt AMPure XP beads in a 1.5 µl tube. Using this aliquot, pipet AMPure XP beads into 1.5 ml tubes for the Bead:DNA ratios as given in the Table below (vortex the bead aliquot and change pipet tips between each sample; pipet and dispense slowly without aspirating any air and without having beads on the outside of the tip): Prepare sample and control DNA Ladder: Sample DNA Ladder: Pipet 48 µl of DNA Ladder to a new tube and dilute with 1152 µl Nuclease-free water; thoroughly mix by vortexing and spin down briefly. Control DNA Ladder: Dilute 4 µl DNA Ladder with 6 µl Nuclease-free water; thoroughly mix and spin down briefly. Pipet 100 µl of diluted sample DNA Ladder to each bead aliquot from step above; mix by pipetting 15 times and incubate 5 min at room temperature. Place the reaction tube onto the MPC for 5 min to separate the beads from supernatant (until the beads have concentrated on the tube wall). Slowly aspirate the cleared solution from the reaction tube without disturbing the beads and discard the solution; keep the reaction tube in the MPC while aspirating the solution. Dispense 500 µl 70% ethanol to each reaction tube and incubate 30 s at room temperature. Slowly aspirate the ethanol from the reaction tube and discard. Repeat the ethanol step. Air-dry the pellet for 10 min with the cap open (keeping on MPC). Take reaction tube from MPC, elute DNA with 10 μl Tris-HCl by careful pipette mixing and incubate for 2 min. Place the reaction tube onto the MPC, incubate for 2 min (until the beads have concentrated on the tube wall) and transfer the supernatant containing DNA Ladder into the respectively labelled clean reaction tube. Use 1 µl of supernatant of each sizeselected sample DNA Ladder and 1 µl of control DNA Ladder on a single Agilent DNA 7500 chip.
When the Bioanalyzer analysis is finished, choose the "All Samples" view from the current chip; in the right-hand global settings tab, open "Integrator" in "Sample Setpoints" and set "Height Threshold [FU]" to 5. Copy the DNA concentrations (in ng/µl) for the 200, 300, 400, 500, and 900 bp peaks from each sample's peak table to an Excel table and calculate the concentration ratios of the individual peaks and the 900 bp peak that serves for normalization. Make sure that the ratios for the control sample fit those given in the table below, if not repeat the experiment. Select the AMPure XP volume per sample volume that best fits the optimal values as per the Table below. at -80°C) (viii) Incubate at RT for 10 min and centrifuge for 3 min at 14,000 r.p.m. (i) Add the appropriate volume of PBS to the homogenization tubes according to the Table above. (ii) Add to the homogenization tube glass beads.
(iii) Rinse the mosquitoes with nuclease-free water. Discard carefully the water.
(iv) Add mosquitoes in the homogenization tube containing the culture medium and one 3-mm glass bead.
(v) Homogenize the tissue by centrifuging 3-4 times at full speed for 20 s each at FastPrep centrifuge. Wait 1 min between the centrifuge steps to avoid overheating of the samples.
(vi) Centrifuge homogenized tissue for 5 min at 14,000 r.p.m. and then transfer 100 μl of homogenized tissue in 250 μl RLT.
(vii) Transfer the remaining 300 μl or 400 μl or 500 μl, depending on the sample volume (see also 
Step 29. Typical results of the Bioanalyzer 2100 RNA pico assay are shown in Figure 3 . In lanes marked with C intact total RNA is evident from rRNA peaks. In lanes marked with T ( Fig. 3 , A+B) and M (Fig. 3, C) , rRNA peaks are partly or completely missing because of degradation of RNA. The Bacillus subtilis samples (spore) are also shown as electropherograms (Fig. A1 ). The cryoPrep sample shows the most intact RNA whereas the TissueLyser sample shows very degraded RNA. From the generated electropherogram, the software calculates an RNA Integrity Number (RIN) that can help in assessing RNA quality. According to our experience, however, there is no correlation between pathogen detection or sequence data output and the RIN value. In some cases, the extracted RNA had only a low concentration and needed to be concentrated (using steps 31-38 of the protocol) before cDNA synthesis. This was done for the bird feces, tap water and the pizza samples. Compare Fig. A3 for resulting libraries. Step 109. The size-selected library is composed of fragments ranging from 300 to 1,000 bp with a peak at about 500-550 bp. Ideally, the library should show a representative or weak peak (Fig. A3 , sheep pool ID 1454, containing an astrovirus 4 , or wild boar with trichina ID 1806, respectively). For the trichina-sample, we obtained 0.02% trichinellid reads (data set of 1,627,077 reads). But also in cases without a peak, virus reads can be detected depending on the viral load. This was for example the case in the meat loaf sample ID 1488 ( Fig. A3 ) that contained 319 reads (0.1%) of a pepper mild mottle virus 6.36 kb genome (99% identity, RNA virus) representing a plant pathogen (total data set 360,148 reads). Step 120. After completion of the run, check fluorescence intensity, amplification curves, melting curves for integrity and plausibility of the PCR results. The relative standard deviation of replicates should be < 10% and R 2 of the standard curve ≥ 0.95, PCR efficiency ≥ 0.95, efficiencies between 0.90 and 0.95 are acceptable if R 2 is ≥ 0.99. Check also the Cq values of different sample dilutions for plausibility.
Supplementary file 2: Extractions of the RIEMS result protocols graphically summarizing the 100 most abundant families found in the sequencing data sets of samples given in Tables 2   and 3 of the main document, ordered by library IDs. In order to represent all detected superkingdoms, the displayed families are selected from the complete result applying the HighestAverages algorithm from the R package SciencesPo. Families are sorted alphabetically, color-coded according to superkingdoms. Note that the graphs are in logscale. The original sample name created by the sequencing platform is included for each data set that refers to the Library IDs given in Table 2 Figure 3 : Graphical representation of read counts for the 100 most abundant families. In order to represent all detected superkingdoms, the displayed families are selected from the complete result applying the Highes-tAverages algorithm from the R package SciencesPo. Families are sorted alphabetically, color-coded according to superkingdoms. Note that the graph is in log-scale. Figure 3 : Graphical representation of read counts for the 100 most abundant families. In order to represent all detected superkingdoms, the displayed families are selected from the complete result applying the Highes-tAverages algorithm from the R package SciencesPo. Families are sorted alphabetically, color-coded according to superkingdoms. Note that the graph is in log-scale. Figure 3 : Graphical representation of read counts for the 100 most abundant families. In order to represent all detected superkingdoms, the displayed families are selected from the complete result applying the Highes-tAverages algorithm from the R package SciencesPo. Families are sorted alphabetically, color-coded according to superkingdoms. Note that the graph is in log-scale.
lib00648-S2-L001-R1-001-1M-resultprotocol.pdf Figure 3 : Graphical representation of read counts for the 100 most abundant families. In order to represent all detected superkingdoms, the displayed families are selected from the complete result applying the Highes-tAverages algorithm from the R package SciencesPo. Families are sorted alphabetically, color-coded according to superkingdoms. Note that the graph is in log-scale. Figure 3 : Graphical representation of read counts for the 100 most abundant families. In order to represent all detected superkingdoms, the displayed families are selected from the complete result applying the Highes-tAverages algorithm from the R package SciencesPo. Families are sorted alphabetically, color-coded according to superkingdoms. Note that the graph is in log-scale. Figure 3 : Graphical representation of read counts for the 100 most abundant families. In order to represent all detected superkingdoms, the displayed families are selected from the complete result applying the Highes-tAverages algorithm from the R package SciencesPo. Families are sorted alphabetically, color-coded according to superkingdoms. Note that the graph is in log-scale. Figure 3 : Graphical representation of read counts for the 100 most abundant families. In order to represent all detected superkingdoms, the displayed families are selected from the complete result applying the Highes-tAverages algorithm from the R package SciencesPo. Families are sorted alphabetically, color-coded according to superkingdoms. Note that the graph is in log-scale. Figure 3 : Graphical representation of read counts for the 100 most abundant families. In order to represent all detected superkingdoms, the displayed families are selected from the complete result applying the Highes-tAverages algorithm from the R package SciencesPo. Families are sorted alphabetically, color-coded according to superkingdoms. Note that the graph is in log-scale.