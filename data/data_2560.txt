Diseases that spread to humans from animals, zoonoses, pose major threats to human health. Identifying animal reservoirs of zoonoses and predicting future outbreaks are increasingly important to human health and well-being and economic stability, particularly where research and resources are limited. Here, we integrate complex networks and machine learning approaches to develop a new approach to identifying reservoirs. An exhaustive dataset of mammal-pathogen interactions was transformed into networks where hosts are linked via their shared pathogens. We present a methodology for identifying important and influential hosts in these networks. Ensemble models linking network characteristics with phylogeny and life-history traits are then employed to predict those key hosts and quantify the roles they undertake in pathogen transmission. Our models reveal drivers explaining host importance and demonstrate how these drivers vary by pathogen taxa. Host importance is further integrated into ensemble models to predict reservoirs of zoonoses of various pathogen taxa and quantify the extent of pathogen sharing between humans and mammals. We establish predictors of reservoirs of zoonoses, showcasing host influence to be a key factor in determining these reservoirs. Finally, we provide new insight into the determinants of zoonosis-sharing, and contrast these determinants across major pathogen taxa.
analytical techniques to explain sharing of these pathogens with humans. Many of these studies have focused on factors promoting pathogen sharing within specific taxonomic host groups (notably primates [9, 10] , bats [11, 12] , carnivores [13] and rodents [11, 12, 14] ), non-taxonomic groups (e.g. domestic animals [15] ) or have limited their scope to certain pathogens, or taxa of pathogens, particularly viruses [16] . Here, we present a comprehensive species-level analysis of pathogen sharing between all known non-human mammalian hosts and humans, contrasting the factors promoting sharing of various taxa of pathogens (e.g. bacteria versus viruses).
Networks of shared pathogens have been gaining popularity as useful tools to investigate pathogen sharing and transmission [9, 12, 15, 17, 18] . Here, we integrate networks of shared pathogens with predictive machine learning to answer three key questions in relation to the link between sharing of pathogens between mammals and mammalian reservoirs of zoonoses. Can we identify important host species and quantify their roles in sharing and transmitting different pathogen taxa? Can these roles be integrated with mammalian traits to predict reservoirs of zoonoses? And which host traits and roles best explain the number of pathogens shared between mammalian hosts and humans?
We extracted interactions between non-human mammals and their pathogens from the enhanced infectious diseases database (EID2) [19] . These interactions formed a bipartite network with nodes represented hosts and pathogens, and links indicated whether pathogens have been found in hosts. We further checked these interactions to ascertain whether the putative pathogens caused a disease or an opportunistic infection in at least one species of mammal (including humans). This resulted in 16 548 species-level host-pathogen interactions between 3986 pathogen species (bacteria = 885, fungi = 251, helminth = 1000, protozoa = 404 and virus = 1446) and 1560 non-human mammalian species. We projected this bipartite network into a unipartite network where nodes represented host species and edges quantified shared pathogens. The motivation behind this projection is twofold: (i) it enabled us to investigate dynamics of pathogen sharing via ecological network analysis tools [9, 11] , and (ii) it facilitated identification of important non-human mammalian species via centrality measures. In addition to the network encompassing all pathogen taxa (including fungi), we generated eight additional networks: bacteria (including Gram variable), Gram+ bacteria, Gram− bacteria, helminths, protozoa, viruses (including retro-transcribing), DNA viruses and RNA viruses. Prions were not included in this study (electronic supplementary material, note S1 lists further information).
We computed various network statistics to contrast key aspects of pathogen sharing across our selected taxa (table 1). These included: transitivity (if two nodes are connected, the probability that their neighbours are also connected); density (the proportion of potential connections in a network that are actual connections); and modularity (the number of edges falling within groups minus the expected number in an equivalent network with edges placed at random [20] ). We also calculated network-level E-I index based on species orders. Given a categorical node attribute describing mutually exclusive groups (in our case, order), the E-I index represents a ratio of external (with other orders) to internal (within order) edges. A positive network-level E-I index indicates a tendency of hosts to share pathogens with species outside their order (i.e. extrovert), whereas a negative E-I index indicates a tendency to share pathogens within orders (i.e. introvert).
Various metrics of node centrality have been explored as proxies to host importance in networks of shared pathogens [9, 12, 17, 21] . Each of these metrics reflects distinct characteristics of the roles host species play in shared-pathogen networks and tends to fall into wider categories including: degree and eigenvalue-derived measures, capturing direct sharing of pathogens among hosts; and distance-based measures, relating to indirect sharing of pathogens. However, due to the large number of available metrics in each category, determining which ones are best suited for identifying important hosts in networks is not straightforward. To address this, we use principal component analysis (PCA) to determine the efficacy of a wide range of well-established centrality measures and subsequently select the ones best suited to our networks [22] . To achieve this, we computed seven degree- [23] [24] [25] and eigenvalue-derived [28-30] centrality measures, and six distance-based measures [24, 29, 30] in each of our networks. Electronic supplementary material, note S2 lists details and definitions of selected measures. We then performed PCA analyses using the R package FactoMineR [31] to determine the influence of our selected measures within each network. We calculated the contributions of each centrality measure to the first and second principal components (explained 89.6% of variance on average; first = 76.3%, second = 13.3%) to determine those which explained most of the variation in these components.
Following this, Opsahl degree centrality (ODC) (mean contribution to first = 8.86% and second = 0.34%) and Opsahl betweenness centrality (OBC) (3.14%, 24.18%) emerged as the two measures with the greatest contribution on average to the first and second component, respectively, across our networks, and were therefore selected in our analyses. ODC can be thought of as a quantifier of the host reachability within the network, whereas OBC reflects the ability of the host to bridge various communities. Hosts with high OBC receive/transmit different types of pathogens from these communities without necessarily communicating these pathogens across communities. Electronic supplementary material, note S2 provides details of included measures and the PCA analyses.
(c) Novel metric of node influence: indirect influence Unipartite projection of host-pathogen bipartite networks results in inevitable loss of information [32] . Let us assume, for instance, that we have three mammalian species: A, B and C, and that A and B share 10 protozoan agents, whereas B and C share 5 protozoan agents. Here, we have two royalsocietypublishing.org/journal/rspb Proc. R. Soc. B 287: 20192882 Table 1 . Network statistics. Zoonoses here refer to the number of pathogens found in at least one mammalian host species and humans in each network. Fields in italic represent values unchanged in the permutation tests (details of permutation tests are listed in electronic supplementary material, note S1). Modularity ranges from −1 to +1, with higher values indicating strong community structure within the network. Order E-I index also ranges from −1 (fully introvert) to +1 (fully extrovert). royalsocietypublishing.org/journal/rspb Proc. R. Soc. B 287: 20192882 extreme scenarios, as follows. (i) The protozoans are all different; A and C do not share any protozoan pathogens, which in turn means that there is no flow of protozoan pathogens from A to C despite a path existing between the two (via B). (ii) The five protozoans shared by B and C are among the 10 shared by A and B and, therefore, half of A's protozoans are shared with C, and all of C's are shared with A. Both scenarios have implications on the traditional centralities analysed in the previous subsection. To address these issues, we developed a novel entropy-based metric, which we term indirect influence (II). II captures the influence each host species exercises within the unipartite network by measuring the number and frequency of pathogens this host spreads indirectly through its neighbouring species if it were to interact with each of them in isolation to the remainder of the network. Entropy enables us to capture uncertainties in the destination of pathogens as a function of the original host [33] at three levels: (i) a species which shares a few pathogens with many neighbours: entropy captures uncertainty in which neighbour it could influence indirectly; (ii) a species which shares many pathogens with few neighbours: entropy allows us to capture uncertainty in pathogens shared; and (iii) a species which shares many pathogens with many neighbours will have high centrality due to uncertainties in both pathogens shared and neighbours influenced. In addition, using entropy allows us to avoid assessing the many paths connecting all node pairs and instead, focus on the potential of the node (i.e. the host species) to diversify pathogen propagation [33, 34] .
II uses the above while taking into account the fact that in shared-pathogen networks, nodes share pathogens with their immediate neighbours only, which means that the distance between two not-directly connected nodes equals infinity regardless of whether a path exists between the two nodes or not. Formally, for each node i ∈ N, connected to n i neighbours with cardinality|n i |, indirect influence of node i (II i ) is as follows:
where II d i , II p i and II f i are the node's indirect degree influence, indirect pathogen influence and indirect frequency influence, respectively (equations (2.2)-(2.4)).
where n ij is the neighbours of i reachable through j, n ij , |n ij | is the cardinality of n ij .
where p ij ¼ p i > p j ; p i ,p j is the pathogens nodes i, j share with their neighbours.
where f ij is the frequency of sharing from i through j, and f i is the frequency by which i shares pathogens with all its neighbours.
Measuring II of a host is essential to capturing the intricacies of pathogen sharing not covered by the conventional measures analysed above, namely the range and speed by which host species propagate their pathogens to their neighbours. In this, our measure is similar to other entropy-based measures [34] , as well as to established influence measures such as Katz centrality [28, 29] , but it focuses on the species influence in its neighbour space rather than across the whole network. To further assess the relationship between II and established centrality metrics, we performed a correlation analysis of centrality measures in our networks which revealed that II correlated (on average across all networks) with closeness [29] (0.88) and Opsahl closeness [24] (0.82) centralities, and showed least correlation with OBC (0.16). Further details are listed in electronic supplementary material, note S2.
We compiled a set of predictors of importance of host species and roles they play in networks of shared pathogens as quantified by the centrality and influence measures discussed above as follows.
Host orders and domestication status: we extracted host orders from EID2 [19] . Orders have been found to affect sharing of pathogens among species [16] and therefore their position in our networks. We classified hosts into three non-taxonomic groups: domesticated, semi-domesticated and wild (electronic supplementary material, note S1 expands these definitions).
Research effort: we quantified research effort for each mammalian species to be the total count of the host (and any of its subspecies) genetic sequences and publications as indexed by EID2 [19] . This enabled us to control for research effort by including it as an independent variable in our models.
Pathogen diversity: we used two metrics of pathogen taxonomic specificity, namely: (i) taxonomic distinctness specificity index S TD [35, 36] and (ii) variance in taxonomic distinctiveness specificity index VarS TD [35] . We calculated these metrics based on NCBI taxonomy as used by EID2 [19] . A higher value of S TD indicated that on average the host has been exposed to pathogens that are not closely related. VarS TD captured higher-level asymmetries that might have been missed by the former metric.
Species traits: we compiled species traits from online databases and literature [16, [37] [38] [39] [40] . We included body mass and body length as they have been shown to affect the number of pathogens harboured by a host, or shared with other hosts, as well as acting as proxies, together with maximum longevity, indicative of host metabolism and adaptation to environment. We included reproductive traits (litters per year, litter size, weaning age, gestation period and age at sexual maturity) which could be viewed as proxies to within-host-pathogen dynamics and therefore may influence the pathogens harboured by the host and the host position within the network. We also calculated the proportional use of 10 diet categories as presented in EltonTraits [39] . We used these categories as independent variables to assess the effect of variations in each category on the position of hosts in our networks.
Geography and habitat: we included species geographical area range [40] (in km 2 ) as we assumed that hosts with wider range might come into contact with larger number of host species, than those confined to smaller areas, and may royalsocietypublishing.org/journal/rspb Proc. R. Soc. B 287: 20192882 therefore have higher centrality values. We incorporated habitat usage [40] as multiple binary indicators of whether a species uses one or more of 14 natural and artificial habitats. We hypothesized that habitat usage affects both the pathogens and hosts with which mammals come into contact and therefore influences centrality measures.
Phylogeny: we calculated pairwise phylogenetic distances between mammalian host species in each network using a recent mammalian supertree [41] . We used these distances to compute two hybrid network-phylogeny measures for each host: neighbours distinctness specificity index (S ND ) and variance in neighbours distinctiveness specificity index (VarS ND ). We based those measures on S TD [34] [35] [36] and VarS TD [35, 37] . Higher values of these measures indicated the hosts share pathogens with distant or varied mammalian species, whereas lower values indicated that sharing of pathogens is more localised, to genus or family level. Formally, we defined our measures as follows. For each host node in the network i with a set of neighbours n i ,
, ð2:5Þ j, k ∈ n i ; ω ij is the phylogenetic distance between j and k,
In addition, we calculated the evolutionary distinctiveness of each host species in our tree using fair proportions [42] , as implemented in the R package picante [43] .
We incorporated taxonomic orders, domestication status and geographical range of species described above in our models to predict reservoirs of zoonoses and predict the number of zoonoses shared with mammalian hosts. To account for research biases in zoonotic pathogens (which tend to be more studied in general), we supplemented host research effort by computing Shannon entropy of research effort (sum of publications and sequences) of pathogens of each host. Shannon entropy accounted for the proportion of research on each pathogen species. Larger values of Shannon entropy indicate larger research effort and a more even distribution of this effort among different pathogen species in the mammalian hosts. Position in network: we included the centrality measures discussed above: ODC, OBC and II as predictors in our zoonoses analyses. Each of these measures reflects a unique characteristic of the role hosts play in the network and therefore a different aspect of sharing of pathogens among mammals.
Relation to human: In addition to their domestication status, we categorized the nature of each mammal interaction with humans into four binary indicators [40] : food source, companion/pet, other usages (e.g. clothes, transportation) and hunted (for sport or food).
Distance to human: We used the mammalian supertree [41] from the previous subsection to compute the phylogenetic distance between each host species and humans. In addition, we quantified three separate ecological distances between these hosts and humans: (i) life traits distance (using all life traits listed above), (ii) habitat distance (including habitat binary indicators from the previous section), and (iii) diet distance (including the 10 proportional categories used above). We based these three distances on a generalized form of Gower's distance matrices [21, 44, 45] .
We developed ensembles to investigate if our chosen centrality measures can be explained by life traits of hosts, their phylogeny and relation to their neighbours in networks. Each of our ensembles comprised six learners: stochastic gradient boosting/boosted regression trees (gbm), support vector machines, elastic generalized linear models, nearest neighbours, decision trees and random forests. We tuned and trained these learners using the R packages Caret [31, 32] and caretEnsemble [33] for nine categories of pathogens corresponding to the nine networks we constructed above. We constructed our ensembles from these learners using linear greedy optimization (as implemented in care-tEnsemble [33] ) to minimize root mean square error (RMSE). We validated our ensembles and their constituents using 10-fold cross-validation. We repeated this process 100 times, to attend to uncertainties in the cross-validation processes, and to generate empirical confidence intervals. Predictions were generated using the median values of these repeats.
The relative contribution (importance) of predictors included in our ensembles (as discussed above) was computed by averaging the predictive power of variables across the base models with weights equal to the contribution of these models to the ensemble (as implemented in the R package caretEnsemble [33] ). This enabled us to assign a value between 0 and 100 to each predictor, with larger values indicating a larger relative influence on the ensemble.
Using similar methodology to the one outlined above, we constructed ensemble models to answer two questions: (i) which mammals are more likely to harbour zoonotic pathogens? (ii) Can the number of zoonoses be explained by centrality and/or host traits? Our ensembles to answer the first question (a classification problem) were optimized to maximize the area under the ROC curve (AUC). Our ensembles to answer the second question (regression problem) were constructed, tuned and assessed similarly to the above subsection.
We assessed the performance of our ensembles and their constituent learners via a comprehensive set of performance metrics (as detailed in electronic supplementary material, note S3).
Network statistics varied across the pathogen taxa studied, as illustrated in table 1. Viruses (all, DNA and RNA) and helminth networks were less dense than bacteria and protozoa networks (electronic supplementary material, figure S1 ). The protozoa network exhibited the highest level of transitivity, indicating higher probability that if two host species shared protozoan pathogens, their neighbours were also connected. Network-level order E-I index revealed that hosts of helminth and DNA viruses (and to lesser extent all viruses royalsocietypublishing.org/journal/rspb Proc. R. Soc. B 287: 20192882 and RNA viruses) tended to share pathogens in these taxa with members of their orders (table 1).
We calculated the relative contribution (importance) of each variable to the ensembles by averaging its predictive power of base learners with weights equal to their contribution to the greedy ensemble. The influence of predictors varied per centrality measure and pathogen type, as illustrated in figure 1 (and further explored in electronic supplementary material, note S4 The relative contribution of taxonomic orders, distances to human and domestication status to our models of reservoirs of zoonoses and number of pathogens shared with humans varied per pathogen taxa, electronic supplementary material, note S5 visualizes these differences.
We found that humans share pathogens with 1242 mammalian species; however, the number of species harbouring zoonoses differed per order and type of pathogen (figure 2b). More rodent species harboured zoonotic pathogens than any other order, except for DNA viruses, which were shared mainly with primates, and Gram+ bacteria, shared mainly with Artiodactyla and carnivores (81 species of each). Bats formed significant reservoirs of RNA viruses. Taking the total number of known extant species of species-rich orders into account [46] , we found that 52.46% of carnivores shared pathogens with humans, followed by 35.50% of known primates and 26.32% of known Artiodactyla. On the other hand, humans shared pathogens with only 15.44% and 13.91% of known bats and rodents, respectively. Figure 3b illustrates the results of our models to predict and explain number of zoonoses shared with mammalian hosts. These results highlight differences in zoonoses sharing per host order and pathogen taxa, as well as variations in frequency of pathogen sharing with domesticated and wild species. For instance, humans tend to share helminths with carnivores (both domestic and wild). Zoonotic viruses, on the other hand, showed differences by genome type. DNA viruses are mostly shared with primates, whereas RNA viruses are more variedly shared with wild species particularly with bats, rodents and primates.
We compiled a comprehensive set of performance metrics for all our models (electronic supplementary material, note S5). 
We presented a methodology integrating shared-pathogen networks and machine learning to answer three key questions: First, what makes a mammalian host species important in networks of shared pathogens? Second, which mammals are more likely to harbour zoonotic pathogens? Third, can the number zoonotic pathogens of a mammalian host be explained by its network centrality or host traits? Our models to explain centrality (question 1) highlighted differences in traits associated with key species in each of our networks, as well as overarching general characteristics. Host species capable of sharing pathogens with distantly related species, and which harboured taxonomically varied pathogens, were more central due to being well connected with their neighbours (II and Opsahl degree). On the other hand, Opsahl betweenness was explained mainly by research effort, domestication status and geographical range. This indicated that there remain unexplored factors explaining bridge species harbouring pathogens shared between otherwise loosely connected communities, for which research effort acted as a proxy.
Our models to predict and describe reservoirs of zoonoses (questions 2 and 3) confirmed that position in networks of shared pathogens is a key factor in determining the sharing of pathogens between mammals and humans; and extended this assumption to include all mammals rather than individual orders [9, 12] .
The work presented here builds on previous research [9, 12, 15, 16, 17, 21] to advance our understanding of sharing of pathogens among mammalian sources of zoonoses in five key aspects: (i) our novel measure of centrality, II, while resembling closeness, is designed specifically for networks of shared pathogens. This measure provided key insight into the probability of mammalian hosts sharing pathogens with humans (question 2). It suggested that, regardless of pathogen type, mammal species that can spread more of their pathogens indirectly through their neighbours are more likely to harbour zoonoses than other species. (ii) Our ensembles provided a flexible, robust, unbiased mechanism to address our questions. (iii) By investigating sharing of pathogens across multiple taxa and sub-taxa (e.g. DNA/RNA viruses, Gram+/Gram− bacteria), we were able to ascertain important differences in the mechanisms of sharing of different types of pathogens, and the effect this has on zoonoses. (iv) In addition, by integrating three measures of centrality, rather than focusing on a royalsocietypublishing.org/journal/rspb Proc. R. Soc. B 287: 20192882 single measure, we were able to differentiate key species in networks based on the unique characteristics of each network. This was highlighted where host species with higher betweenness carried more zoonotic viruses and bacteria, whereas hosts with higher Opsahl degree carried more zoonotic helminths and protozoa. (v) Finally, we were also able to differentiate the roles that host order and their domestication status play in different networks. We recognize several areas for future improvements of our models. First, our data were mined mainly from published research and deposited genetic sequences. While we made best effort to capture all interactions available within our resources [19] and to control for research effort as per previous studies [9, 12, 16] , we realize there are inherent biases in our data sources. Recent research has revealed that between 20 and 40% of pathogen host ranges are currently unknown [47] . An area of future improvement will therefore focus on closing this particular knowledge gap, furthering recent attempts to predict missing interactions in networks such as ours. Second, edges in our networks, which represent sharing of pathogens, may be interpreted in a variety of ways including: spillover; direct contact; indirect sharing through vectors, intermediate hosts or environment; and coevolution of specific host-pathogen lineages. To further improve our models, we will aim to distinguish between these various events, focusing in particular on the role of transmission routes as means to include direction of pathogen sharing into our undirected networks. Third, we have focused our analyses on host and pathogen species interactions with minimal geographical layering. Geography plays a key role in facilitating host interactions and affects the probability of contact between humans and wildlife, which in turn increases chances of zoonotic transmission [5, 48] . A future analysis will integrate geographical distribution of host species and will improve our ability to predict sources of zoonoses.
In summary, the work presented here highlighted differences in characteristics and centrality measures of networks of shared pathogens. It provided a methodology for selecting which centrality measure to include in analysis of similar networks. Our models revealed factors underlining centrality in these networks, and importantly how these factors vary across pathogen taxa. We established predictors of reservoirs of zoonoses and showcased centrality measures to be key in determining these reservoirs. Finally, we provided new insight into determinants of sharing of zoonoses between humans and mammalian hosts across major pathogen taxa.
Data accessibility. The data reported in this paper are accessible from the 