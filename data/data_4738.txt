Here we describe an algorithm for simulating epidemics from our proposed individual model. Consider the situation where there is one infectious individual at current time t (i.e. the time of this individual transits from class E to class I) among an entirely susceptible population. The simulation proceeds as follows:
1. Draw a waiting time t I in class I from a specified infectious period distribution, and set the time of recovery t R = t + t I .
2. Let t next be the earliest time in the union of t I and t R (those greater than t) of all currently infectious individuals.
3. The time of next infection t E is drawn as the first event in a non-homogeneous Poisson process with a time-varying rate β(t) (defined in the main text). There are a number of ways of simulating from a non-homogeneous Poisson process − for example, the thinning algorithm [1] which essentially samples the next event time t E from a homogeneous Poisson process with the baseline rate β and accepts that with probability β(t E )/β. Note that when there are n > 1 currently infectious individuals, the acceptance probability would become
5. If t E ≥ t next , set t = t next , and resimulate t E as described in Step 3.
After t E is sampled, select the source of this infection uniformly among currently infectious individuals. This new infection is then placed at distance r and angle ∆θ from the selected source according to the density g(G = (r, ∆θ); η,ŝ) specified in details in the main text.
7. Draw t I the time of becoming infectious and t R the recovery timefor this new infection using specified waiting time distributions.
8. Repeat the above steps until a stopping criterion (e.g. t > t max ) is reached.
In the main text, for mathematical clarity, we have discussed a general case where the population density along the circumference σ(l|r,ŝ) is assumed to be continuous. In practice, however, the data of population density over a study area is often provided in a discrete form, mostly on the grid level. This results in a piecewise constant density of the angle θ, with the precise location of change-points in this density depending on how the 'grids' and the 'circle' intersect (see Fig. ? ?). To derive this density, it is necessary to compute the probability masses of the arcs (which is proportional to the density of the corresponding angles) that comprise the whole circumference, where population density is homogeneous/constant on each arc (and in the grid it belongs). Here we describe an algorithm for computing σ(l|r,ŝ) given the grid-level population density. First of all, using basic plane and line geometry, we solve for the coordinates of the intersection points between the grid lines and the circle (Fig. ??) . Then, for each intersection point (x i , y i ) we solve for the angle θ i measured from the first quadrant by
where (x s , y s ) is the coordinate of the source of infection (the center of the circle). Let (θ (1) , θ (2) ....) be the vector of ordered angles, and let ∆θ i = θ (i+1) − θ (i) , for i = 1, 2, .... The probability mass of an arc segment with ∆θ i is then proportional to
where ∆l i is the arc length corresponding to ∆θ i , and σ ∆l i is the constant population density of the grid-cell in which the arc lies. It is worth noting that infected individuals emerge in continuous space regardless the form of the population density data.
We describe how we simulate epidemics from the individually-based SEIR model described in the main text section Comparison with Individual-based SEIR Model. For the sake of computational efficiency, we consider an initially susceptible population with population size N = 10000. The geographical locations of these N individuals were randomly assigned accordingly to a normalized population density across the study area similar to the Ebola dataset. An epidemic was assumed to be initiated by an index case and progressed according to the conventional spatial-temporal SEIR epidemic model [2] . In contrast to our proposed framework, the conventional SEIR model requires an explicit specification of the infectious challenge presented to each susceptible individual. Specifically, a susceptible individual j becomes exposed during [t, t + dt) with probability
where α represents a primary infection rate and β is the contact parameter. The term K(d ij , κ ) characterises the dependence of the infectious challenge from infective i to j as a function of distance d ij and is known as the spatial kernel function. We assume that K(d ij , κ ) = exp(−κ d ij ). It is noted that K(d ij , κ ) does not have to be a proper density function. Similar to our proposed model, an infected individual is assumed to spend random times in class E and I, modelled by Gamma(γ, λ) and Exponential(1/ϕ) distributions respectively. We focus on simulations that give rise to epidemics in which around 5% of a study population becomes infected (in 50 days). Specifically, we set α = 2.5 × 10 −5 , β = 1.8 × 10 −4 , κ = 0.3, γ = 3, λ = 1 and ϕ = 7. It is noted that, as the conventional SEIR model and our model have very distinct structures (and hence in general imply differing interpretations of their model parameters), they are therefore compared based on commonly agreed key 'model outcomes' (see main text).
We also fit the full individual-based SEIR model to one of the simulated datasets described in Simulating from Individual SEIR Model. It is noted that this will require an explicit consideration of each individual (among the population with N = 10000) in the model fitting and often require a large amount of recalculations of likelihood during the MCMC sampling − for example, at proposing a new value of κ , the spatial infectivity between all infectious-susceptible pairs must be recalculated. As the purpose here is to compare the computational efficiency, we only record and compare the run-time for 1000 MCMC iterations both in performing the full individual-based SEIR model inference and performing inference of our model. A comparison, in which both model fittings were conducted using similar C++ codes and data structures, shows a significant speed gain in fitting our model (3 vs 2340 seconds).
Ripley's K function [3, 4] is similar to Moran's I function but is able to characterize clustering/dispersion of point patterns at multiple distances. Theoretically it is defined as K(r) = λ −1 E[number of points within distance r of a randomly chosen point],
where λ is the density of points per unit area. We consider a common transformation of Ripley's K, Ripley's L function L(r) = K(r)/π. We compute the estimated L(r) using the function Linhom(·) provided in the R package spatstat [5] , on a range of distance [0, r max ]. This function also determines a sensible default of the maximum distance r max , by taking into account the increasing estimation uncertainty at larger distances. It is noted that the estimated L(r) are often compared to those computed from data generated from a null model (i.e. a Poisson point process), in which clustering/dispersion are characterized relative to the null model. In this paper, however, it is the comparison of values of L(r) computed from the model simulated data and the observed data is of interest.