Let G be a structure. For simplicity of notation, we write G = •G if the first position is unpaired, and G = (. . .) j G is the first base is paired to some position j, and G is the substructure of G starting from position j + 1. Alternatively, we may use the notation (i, j) ∈ G for the case where the position i and j are base paired in G.
The expected length E[d G (i, j)] can be calculated as: follows:
Now EL sg can be simplified as follows:
where P r[G = •G |ξ[i . . . j]] can be calculated as the probability of the first position to be single-stranded in the sequence ξ[i . . . j], i.e.,
We are also able to push the second term since
Now we know that for every G we have that the Boltzmann weighted energy of G is part of the partition function of Q i+1,j . Thus we get
Overall we get
For the term EL bp(k) , we have a similar reduction:
Now we can again simply extend by Q k+1,j , getting
Overall we get
and thus the second summand. 