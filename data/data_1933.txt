The 2014-2015 Ebola outbreak is the largest and most widespread to date. In order to estimate ongoing transmission in the affected countries, we estimated the weekly average number of secondary cases caused by one individual infected with Ebola throughout the infectious period for each affected West African country using a stochastic hidden Markov model fitted to case data from the World Health Organization. If the average number of infections caused by one Ebola infection is less than 1.0, the epidemic is subcritical and cannot sustain itself. The epidemics in Liberia and Sierra Leone have approached subcriticality at some point during the epidemic; the epidemic in Guinea is ongoing with no evidence that it is subcritical. Response efforts to control the epidemic should continue in order to eliminate Ebola cases in West Africa. Fig 4. Estimated Reproduction Number over calendar time for Liberia. The quantiles of the reproduction number are displayed on the last day for each week. From bottom to top, the quantiles are 0.025, 0.10, 0.25, 0.50 (black line), 0.75, 0.90, and 0.975. The black horizontal line shows the threshold for subcriticality, i.e., the reproduction number equal to 1.0. We analyzed data through June, 2015; we did not include 6 cases that were reported in the situation reports during the weeks ending on Fig 6. Estimated Reproduction Number over calendar time for Guinea. The quantiles of the reproduction number are displayed on the last day of each week. From bottom to top, the quantiles are 0.025, 0.10, 0.25, 0.50 (black line), 0.75, 0.90, and 0.975. The black horizontal line shows the threshold for subcriticality, i.e., the reproduction number equal to 1.0.
The 2014-2015 Ebola outbreak in West Africa is already the largest on record. Beginning with a case in Guinea in December 2013 [1] , the outbreak extended to Liberia, Sierra Leone, Nigeria, and Senegal [2] . Activities, such as early diagnosis, patient isolation and care, contact tracing, infection control practices, and safe burials, are recommended strategies to reduce transmission and control the epidemic [3] and have been implemented in the affected countries. Although there have been reports citing evidence for a decrease in transmission of Ebola virus after the implementation of prevention and response measures [4] [5] [6] , the precise time when control of an epidemic has been achieved is difficult to determine during the course of the epidemic. A degree of control has been achieved when, on average, one infectious case does not produce another infectious case. That is, the disease has become subcritical and can no longer sustain itself in the population [7] .
We examined international reported Ebola case data to determine if and when the Ebola epidemic became subcritical in Liberia, Sierra Leone, or Guinea. Using a stochastic hidden Markov model to simulate the epidemic through time, we estimated the weekly average number of infections caused by one Ebola infection within each of the three affected countries in West Africa using country and sub-country confirmed case counts available from the World Health Organization (WHO).
Weekly country-and subcountry-specific confirmed case count data were obtained from the WHO Global Health Observatory's patient database [8] . The number of confirmed cases using standard surveillance definitions [9] were given by week for Liberia, Sierra Leone, and Guinea from January 5, 2014 to July 29, 2015, if available. We used the data released by the World Health Organization on July 29, 2015 for the final analysis.
The basic reproduction number, R 0 , the average number of secondary cases caused by one infected individual throughout the infectious period in a completely susceptible population, has been used to monitor epidemics of infectious diseases [10] including Ebola, with particular interest in when it decreases below 1.0 [11] . Time-varying estimates of the reproduction number R for the epidemics in Liberia, Sierra Leone, and Guinea were calculated using a stochastic hidden Markov model. To assess the ongoing weekly transmission potential of Ebola in the three most intensely affected countries, we analyzed a simple mathematical transmission model based on previously published simple models [11] . The model consists of SEIR-type state spaces with two sequential exposure classes with progression rates chosen to provide a gamma-distributed incubation period of 10 days with a shape parameter of 2 (to be consistent with a previous WHO model [2] ). The model distinguishes diagnosed from undiagnosed (and unknown) infectious cases with undiagnosed cases becoming diagnosed at a given rate. The transmission rates for undiagnosed and diagnosed cases are assumed to be different with diagnosed cases having a lower transmission rate due to case recognition and implementation of control measures. The number of confirmed cases is a counting process and is represented by a component of the state vector. Specifically, the states of the model are (1) uninfected individuals, (2, 3) latent or exposed individuals (infected, but who have not shown symptoms yet), (4) undiagnosed cases, (5) diagnosed cases, (6) removed individuals (died or recovered), and (7) confirmed cases. A full specification of the model is given in the S1 Appendix.
The number of susceptible individuals, exposed individuals of different classes, undiagnosed cases, diagnosed cases, and removed individuals together determine the counting process for the number of confirmed cases, which is all that is assumed to be observed. The model is simulated as a continuous-time Markov chain. Based on the state of the system at the beginning of any given week (X (t) ), the model is projected forward with the SEIR model, yielding the state at the end of the week X (t+1) . The number of new confirmed cases predicted by the model is computed for that week (see S1 Appendix for details). This procedure is repeated n times, yielding a simulation-based estimate of the numberĈ t of new cases predicted, given the state and parameter values. We use a simple nonlinear particle filtering method to fit the simulated results to the WHO data (similar to the basic particle filter but using the resample/move method to prevent particle diversity depletion [12] ). A Monte Carlo likelihood of the observed data given parameter values is calculated according to a Poisson distribution withĈ t as the rate parameter. An alternate likelihood was derived by directly estimating the probability that the simulated number of confirmed cases exactly matched the observed number (the relative frequency of exact matches in the number of replications, listed as Bernoulli in the table in the S1 Appendix). This procedure, in turn, is repeated for each of P particles, consisting of state and parameter values. Each particle yields a Monte Carlo likelihood L j,t of the observed data given a set of parameters at time t. Importance resampling is then used, wherein the particles are resampled with weight w j;t ¼ L j;t = X j0 L j0;t [13, 14] to choose the parameter values that most likely fit the data. To prevent depletion of particle diversity over time due to successive resampling, the resample/move method [15] is used. After resampling, the parameter values for each particle are perturbed using a symmetric transition kernel. Then, the original values of X (t) for that particle are used and the projection recomputed with new particles, leading to a new value for the Monte Carlo likelihood, L'. The perturbed values are accepted with probability r = min (1,L 0 /L) (i.e., a single step of the Metropolis algorithm). The procedure is iteratively repeated at each time point. Once a fitted set of parameters are obtained, an estimated R can be calculated (see below).
Previous authors have observed the non-identifiability of specific parameter sets for the Ebola process [16, 17] , and our model is not identifiable either. We assign values for all parameters except for the transmission coefficient β, and conduct the fitting algorithm (see Shaman [18] ). Of particular importance is the fraction of unconfirmed cases since an arbitrarily changing pattern of incomplete reporting is indistinguishable from changes in transmission. Note that if transmission increases or decreases over time, the resample/move procedure introduces perturbations in the parameters and provides the ability to track changes dynamically. Given the parameter choices, we then compute the instantaneous reproduction number (R) implied by the model, which for our simple model, is given by
where κ is the relative infectivity of diagnosed cases, μ is the mortality rate, ρ is the recovery rate, σ is the diagnosis rate, and β is a transmission coefficient. More generally, we should estimate the effective reproductive number by multiplying this quantity by the fraction of the population who are susceptible. However, by assumption, in this model, all immune individuals are former cases, and yet the cumulative incidence is small compared to the total population of each country, and we assume the susceptible fraction is essentially 1. Thus, assessment of control using this estimated R is somewhat pessimistic, since it is quite possible for the effective reproduction number to be less than one while our estimated R >1.
For this study, we used weekly country-and subcountry-specific confirmed case count data that were obtained from the WHO Global Health Observatory's patient database available on the Internet [8] . Since the research only involved unidentifiable summary data (i.e., case counts by week), the research did not require review by the Committee on Human Research at the University of California, San Francisco.
There were 3,897 Ebola confirmed cases in Liberia as of July 26, 2015 (Fig 1) . The weekly number of incident confirmed cases ranged from 0 to 364; 364 incident cases were reported during the week of September 1 to September 7, 2014. Montserrado County had the largest number of cumulative confirmed cases in the country (1,978 cases). In Sierra Leone, there were 9,896 confirmed cases as of July 5, 2015 (Fig 2) . The weekly number of incident confirmed cases ranged from 3 to 578 with the largest number reported during the week of November 24 to November 30, 2014. The capital city of Freetown (Western Area Urban District) had the largest number of cumulative confirmed cases (2,508 cases). Guinea had 3,325 confirmed cases as of July 26, 2015 (Fig 3) . The weekly number of incident confirmed cases ranged from 1 to 171, with the largest number of reports occurred during the week of December 15 to December 21, 2014. The Macenta prefecture had the highest number of reported cumulative confirmed cases (713 cases).
To be conservative, we considered an epidemic to be subcritical when the upper bound of the 95% credible interval for R dropped below 1.0. In Liberia, the median R ranged from 0.9 to 4.6 between March 23, 2014 and October 5, 2014 (Fig 4) . The estimate of R was subcritical on October 26, 2014; although the median R estimates after November 30, 2014 are below 1.0, the upper bound is greater than 1.0. In Sierra Leone, the median R ranged from 0.6 to 5.9 between May 25, 2014 and January 18, 2015 (Fig 5) . The time-varying estimates of R reached subcriticality in Sierra Leone during the week ending on January 18, 2015 to February 1, 2015. These estimates are consistent with a previous report that the epidemic in Sierra Leone was subcritical as of January 18, 2015 [19] . In Guinea, the epidemic was not subcritical from March 2, 2014 through July 19, 2015 (Fig 6) .
This study suggests that the epidemics in Liberia and Sierra Leone may have reached subcriticality in October 2014 and late January and early February 2015 respectively. As the number of cases declined and the concerns of its implications for vaccine studies grew [20] , our results showed that the latest median estimate of R for Liberia was less than 1.0 with the last confirmed case reported during the week ending March 22, 2015 in the patient database. Similarly, the estimates of R for Sierra Leone may be declining as of late June 2015. Interventions and response efforts to control the disease must continue to make the epidemic subcritical in the two affected countries with reported cases, despite previous observations that transmission may be decreasing. However, we recognize that epidemic outcomes depend on individual behaviors as well as hospital capacities to care for sick, infectious, and dying individuals [21] ; a multi-faceted control approach is most certainly warranted [22] .
Other researchers have published estimated transmission characteristics at various time points in the epidemic. A three-month ensemble forecast produced estimates of the basic reproduction number between 1.5 and 2.0 using data from July 6, 2014 to August 9, 2014 and a stochastic, individual-based model that provided estimates for the local transmission of Ebola virus [23] . Using a set of ordinary differential equations, basic reproduction numbers were estimated to be 1.6 for Liberia, 2.5 for Sierra Leone, and 1.5 for Guinea using data as of August 20, 2014 [24] , which are consistent with other R 0 estimates between 1.6 and 2.0 for the same time period [25] . With control measures, the effective reproductive number dropped to around 1.0 in Guinea and Sierra Leone by the end of May and July 2014, respectively using different methods. In Liberia, the effective reproductive number remained unchanged suggesting that there was no evidence of outbreak control during the same period of time [24] . Subsequently, the WHO Ebola Response Team estimated the basic reproduction numbers as 1.8 for Liberia, 2.0 for Sierra Leone, and 1.7 for Guinea using data as of September 14, 2014 [2] . Using data from July to September, 2014, the average number of secondary infections per infected individual was estimated to be 1.73, with survivors having a different estimate in comparison with nonsurvivors (0.66 and 2.36 respectively) in Montserrado County, Liberia [26] . Additional effective R estimates for the same time period ranged from 1.3 to 2.7 among the three west African countries [27] .
By mid-October 2014, there were suggestions of a change in the growth of the epidemic in Liberia [17] ; one model showed that the exponential growth phase that was observed in Liberia previously was over, an observation that was consistent with epidemiologic data known at that time [17] . Using different methods, our results suggest that R became subcritical in Liberia in late October 2014. In Sierra Leone, R became subcritical in late January to early February 2015, confirming a previous R estimate [19] . Driving R to be less than 1.0 would certainly control the epidemic, but epidemics often fade out stochastically even when R is approximately 1.0 [28] . In order to control the epidemic, a combined approach involving different control strategies (i.e., case isolation, contact-tracing with quarantine, and safe funeral and burial practices) must be implemented [22] . It is not possible, however, to disentangle changes in reporting from changes in transmission. We also note that the wide credible limits on the reproduction number seen near the end of the time series may reflect, in part, low power resulting from small case counts. An R estimate below 1.0 for any of the three epidemics would suggest the possibility of elimination, but certainly would not imply that no further cases will occur [29] . In addition, our analyses incorporated data that were available on July 29, 2015. If the last few weeks of data change retrospectively due to reporting delays, i.e., more cases are added to the last few weeks of the closing date of the data, our estimates of R during this time period will change. An important limitation of the simple model we have chosen is that geographic heterogeneity has not been explicitly represented; ongoing transmission in specific regions or "hot spots" could be occurring even though the basic reproduction number estimated from a simple homogeneous model is less than 1.0. Further work is therefore needed to include the effects of geographic heterogeneity as has been published previously [30, 31] , including an assessment of the time to complete elimination. Also, our model also does not account for clustered transmission as has been noted to occur [32] or account for the effects of ring vaccination [33] .
In summary, subcriticality of an epidemic is an important indicator that a degree of control has been achieved before the absence of Ebola cases. The epidemics in Liberia and Sierra Leone have approached subcriticality at some point during the epidemic; the epidemic in Guinea is ongoing with no evidence that it is subcritical. In our view, this suggests that the national and international responses must continue if true elimination is to occur throughout West Africa.
Supporting Information S1 Appendix. Details of the Model. (DOCX)