Supplementary Table 1 . Official nomenclature ID and GenBank accession numbers of HA amino sequences of influenza viruses used in this study.
A/Moscow/ 10/1999 (+) means matched prediction while (-) means wrong prediction. Table 6 . Predicted results of 7 tested strains against Con H3 by AntigenCO 6 . *"I" means sequence identities of v-region and "P" means sequence positives of v-region in BLAST. For example, "I90" means under the condition of "True positive" defined as sequence similarity over 90% for identities in v-region. The threshold of ROC was set as the point most close to (0, 1) a AUC value means the area under the receiver operating characteristic curve, range from 0 to 1. host, we take the 28 complexes from mice for further examine. The correlation between epitope compositional difference and the V-region sequence similarity was increased to 0.8725 (antibody positive similarity) and 0.8666 (antibody identity similarity), as being shown in Supplementary   Fig. 10 . The high correlation above suggests the feasibility of using V-region sequence similarity of antibodies as a measurement of antigenicity similarity. However, we also noted that the same conformational epitope of lysozyme may induce quite different V-region antibodies from different immune host. For instance, the sequence identify score of V-region is only 75% between human antibody (2EIZ) and mice antibody (1XGP) to the same lysozyme epitope. This seems to indicate that it is more meaningful to adopt V-region sequence similarity of antibodies as a measurement of antigenicity similarity in the case of same immune host.
In that case, values of 100%, 98%, 95% and 90% of V-region identity/similarity were each tested as functional similarity cut-offs for the corresponding epitopes. A pair of epitopes is considered a true positive for similar antigenicity if the identity/similarity score of their corresponding V-regions is above the cut-off, and vice versa. Then, the AUC (Area Under the Curve) value of the ROC (Receiver Operating Characteristic) curve, true positive rate, accuracy, and balanced accuracy were calculated (Supplementary Table 9 ). Different resolutions of the spin-image and the searching granularity of neighbouring residues were also scanned to identify an optimized parameter combination to balance the computational time and the accuracy (Supplementary Table 10 Fig. 11) ,
suggesting that the unbalanced dataset is not likely to influence the performance of CE-BLAST.
As the first tailor-made program to align structural epitopes, the performance of CE-BLAST was compared with that of commonly used structural alignment tools: MultiProt 7 , MATT 8 , TMalign 9 and SPalign 10 . As most of these peer programs provide several scores under different parameters, the best result from each program on the total of 95,172 epitope pairs was plotted in Supplementary Fig. 12A with precision and recall rate. Further detailed results for the different cut-offs can be found in Supplementary Fig. 13 . According to the evaluation criteria, a good model would be able to maintain a consistently high precision as the recall rate increases 11 . As shown, CE-BLAST consistently maintains the highest precision level among all peer programs under different recall rates.
Because of the inherent sensitivity of the conformational epitopes, we tested CE-BLAST on mutant epitopes of protein antigens. All 309 unique epitopes were clustered according to the CE-BLAST similarity score as shown in Supplementary Fig. 12B . Further analyses revealed that lysozyme epitopes are the most abundant, with 40 structures, and that HIV gp120 epitopes are the second most abundant, with 23 structures. Interestingly, several sub-clusters were identified for both the lysozyme epitopes and the gp120 epitopes in Supplementary Fig. 12B , indicating mutated, overlapping or unique epitopes. Supplementary Fig. 12C illustrates the performance of CE-BLAST on the lysozyme family, with an AUC value above 0.92, an accuracy value above 0.85, and a balanced accuracy value above 0.92 under different V-region similarity cut-off values. The results for gp120 can be found in Supplementary Fig. 14 . According to background data from the PDB, a similarity score over 0.7 is empirically derived to select highly similar epitopes, a score below 0.6 indicates different epitopes, and a score in between these two values often indicates similar or partially overlapping epitopes.
We show more detailed results for lysozyme as an example. Using the lysozyme epitope 1J1O_Y (PDB id: 1J1O; Chain Y) as a random query, the similar epitopes are ranked according to similarity score in Supplementary Table 11 , together with their sequence similarity for the V-region of the corresponding antibodies. The top 8 epitope structures are actually the same epitope, followed by 6 highly similar epitopes with one or two residue deletions, then by 2 partially overlapping epitopes (Supplementary Table 12 ). Similar results were observed for the gp120 epitopes (Supplementary Table 13 ). As displayed, the CE-BLAST score agrees well with the sequence difference of the V region in the corresponding antibodies. The above results suggest the outstanding performance of CE-BLAST both in a large testing dataset across antigen class and in a specific class of antigen mutants. All of the 559 epitope structures derived from immune complexes in the PDB have been combined into a built-in epitope database for the user to search against in CE-BLAST. 