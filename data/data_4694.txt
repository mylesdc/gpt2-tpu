This section further develops the analytic results regarding the distribution of the delay between R 0 exceeding 1 and a disease emerging that was introduced in the main text. As described in the main text, our analytic approach is to suppose that each imported infection initiates a chain of infections which may be modelled as a branching process. The delay time is considered to be the time before the initiation of a branching process that does not go extinct. This time is a random variable that may be modelled like the time to death in a survival analysis. In the main text, we derived a survival function for this time and equations for the mean and median delay time for particular levels of heterogeneity in the distribution of secondary cases. The approximation with the error plotted in figure S1 was instrumental in those calculations. Here, we study the sensitivity of the mean and median survival time to changes in model parameters. We use the same notation as in the main text.
This section further develops the analytic results regarding the distribution of the delay between R 0 exceeding 1 and a disease emerging that was introduced in the main text. As described in the main text, our analytic approach is to suppose that each imported infection initiates a chain of infections which may be modelled as a branching process. The delay time is considered to be the time before the initiation of a branching process that does not go extinct. This time is a random variable that may be modelled like the time to death in a survival analysis. In the main text, we derived a survival function for this time and equations for the mean and median delay time for particular levels of heterogeneity in the distribution of secondary cases. The approximation with the error plotted in figure S1 was instrumental in those calculations. Here, we study the sensitivity of the mean and median survival time to changes in model parameters. We use the same notation as in the main text.
Although we do not have an explicit equation for the median for all levels of heterogeneity, we can still obtain a detailed understanding of how it responds to changes in model parameters. That is, we can describe in some detail the behaviour of the elasticities of the quantiles. The elasticity e y,x of a function's output y with respect to a parameter x is defined as ∂y ∂x x y . In words, it is the relative change in the function's value with respect to a relative change in one of its parameters. To derive e q,a we first note from the definition of S and λ that
Thus, e q,a = log
It is instructive to view that equation as, in light of the definitions given the main text, stating that e q,a is equal to minus the area under the hazard curve from 0 to q divided by the area of a rectangle with sides of length λ(q) and q. As a grows large, q grows small and the hazard function from 0 to q approaches a straight line. Therefore, as a → ∞, e q,a → −1/2, the area of a triangle divided by that of a rectangle. As a decreases, q grows large. The ratio of λ(q) to λ(q/x) for any positive x decreases. Stated differently, d dt λ(t) λ(tx) > 0. To prove this fact, note that the following statements are logically equivalent:
The function [(1 + bt) p − 1](1 + bt) is convex and passes through the origin. Therefore, the line passing through the origin and the function's value at t lies below the function at tx. That proves inequality (S6). Consequently, for all p the area under the hazard curve approaches qλ(q) as q increases. It follows that e q,a is an increasing function of a that asymptotically approaches -1 as a → 0. The parameter p controls the rate at which this happens by determining how quickly λ approaches its limit. In summary, the quantiles become more sensitive to the sparking rate as it decreases, and this happens more quickly when the level of overdispersion is low.
The elasticity e q,b of the quantiles with respect to the rate of increase of R 0 is closely related to e q,a . To see this, observe that the quantiles q are homogeneous functions of degree −1 of both a and b. That means that if a and b are both multiplied by a factor x then any quantile is multiplied by x −1 . This statement can be verified by observing that jointly adjusting a, b and q in that manner does not change the value of the survival probability. Euler's homogeneous function theorem [1] then tells us that
Consequently, from the definition of the elasticities e q,b = −1 − e q,a . Based on our knowledge of e q,b , we can then say that the lim a→∞ = −1/2 and that as a decreases, e q,b increases asymptotically toward 0. So far, we have only made statements about how the elasticities change with a, but it turns out that the elasticities depend only on the quotient a/b. In other words, they are homogeneous functions of degree 0 of a and b. This fact can be verified by determining from equation (S7) that the partial derivatives in the elasticities are homogeneous functions of degree -2. Thus our previous statements about how the elasticities change as a increases (while b is held constant) can be converted directly into statements about how the elasticities change as b decreases (while a is held constant).
The elasticities of the mean with respect to a behaves similarly to those of the quantiles. To show this, we first note that
Then
(S11)
As with e q,a , a geometric interpretation is instructive. e E(T ),a is the result of dividing one weighted average of areas by another. The weights are S(t) and are shared by the dividend and divisor. As with e q,a , the area in the dividend is the area under the hazard curve and the area in the divisor is that of a rectangle. As a grows large, S declines rapidly with t and thus only the areas with t near 0 make a substantial contribution to the averages. Since λ from 0 to t approaches a straight line as t → 0, e E(T ),a approaches the average area of triangles divided by the average areas of corresponding rectangles, which is 1/2. As t increases, as explained previously the areas under the hazard function becomes more rectangular with a rate of convergence determined by p. Thus e E(T ),a is an increasing function of a and asymptotically approaches −1 as a → 0. Recall that we found the same limits and monotonicity for e q,a . We can in fact go on to show that all of the limits and monotonicity results found for elasticities of the quantiles apply to elasticities of the mean. Recall that these results were consequences of the limits and monotonicity of e q,a as a function of a and that q(a, b) was a homogeneous function of degree -1. To see that E(T ) as a function of a and b is homogeneous of degree -1, consider that ∞ 0 S(t, ax, bx) dt = ∞ 0 S(t/x, ax, bx) dt/x = ∞ 0 S(t, a, b) dt/x = E(T )/x. The limits and monotonicity results for the quantiles thus carry over to the mean. These results are contingent on modelling R 0 as a linear function, however.
If R 0 is modelled with a step function, the elasticities can be quite different. For example, let
where 1 < R 0,1 < R 0,2 . The quantile function is given by
, otherwise.
(S13)
The elasticity of the quantiles with respect to a are then
(S14)
We can see from these equations that e q,a starts at -1 and stays there until the median is equal to t 1 . Then e q,a jumps away from -1 toward zero and relaxes back toward -1 as a further decreases. Note that the q(a, t −1 1 ) is a homogeneous function of degree -1, so e q,t −1 1 = −1 − e q,a . So the comparable transformation to multiplying b in the linear model by x is to divide t 1 in the step model by x. If that is done and a is multiplied by x, in both cases the quantiles will be divided by x. In summary, knowledge of the correct model for R 0 can be essential for predicting the effect of changes in parameters on delay times. In the main text, we explore the effects of other model violations such as finite population size.
The simulation results presented in the main text are based on the assumption that pathogen transmission increases with host population size (i.e. density-dependent transmission, as we also implicitly assume identical areas). With frequency-dependent transmission, typical of vector-borne diseases, STDs, and also some childhood illnesses, transmission rates are largely independent of host population density [2] . To compare bifurcation delay in simulations with each type of transmission, we created a frequency-dependent transmission model by having the rate of transmission events be equal to βXY /N instead of βXY and keeping the equations for all of the other rates identical to those of table 1 in the main text.
The frequency-dependent model has a different equation for R 0 , which must be considered when calculating the sweep rate. It has R 0 = β/(γ + µ) and thus the sweep rate is b = α/(γ + µ). Note that for the same α, γ, and µ; the sweep rate in the density-dependent model would be a factor of N larger, which could have a profound effect on the length of the delay.
We compared the transmission models by plotting the mean (+/-SE) of simulated bifurcation delay in each against each other (500 simulations for frequency-dependent, 1000 simulations for density-dependent transmission), conditioned on the range of life history parameters presented in table 2 of the main text. For the frequency-dependent model, the rate of change of the transmission rate, α, was set to be a factor of N 0 larger to make the sweep rate comparable to that of the density-dependent model with the same life-history parameters. Figure S2 shows that mean delay is generally similar over the range of sparking and sweep rates. However, it is apparent that for the shorter delays, the frequency-dependent transmission model produces, on average, less bifurcation delay than the density-dependent model. The degree of departure depends on the sparking (a) and sweep (b) rates of the system.
We used recursive partitioning to identify the life history parameters that contributed to the largest departures of our observed delay values from our expected delay values (i.e. the Kullback-Leibler divergence [3] ) (rpart package in R; [4] ). We created two partitioning schemes: the first used the life history parameters initial population size (N 0 ), infectious interval (reciprocal of the recovery rate, γ), linear rate of increase in the transmission rate (α), and the spontaneous rate of infection from outside the population (ξ). The second used the expected sparking rate, a = ξN 0 , and the expected sweep rate, b = αN 0 /(γ + µ), where µ is the host birth and death rate. Each partition tree was pruned by removing uninformative partitions, as identified by cross validation plots [4] . We present here the pruned partitioning trees for each approach, as well as an estimate of the explained variance. Figure S2 : Mean bifurcation delay (in years, +/-SE) in stochastic simulations assuming frequency-dependent disease transmission (y-axis) is similar to mean bifurcation delay in density-dependent transmission models (x-axis). Each point represents a unique, matched combination of life history parameters; thus, points on the solid, diagonal line 1:1 line indicate identical mean delay in simulations assuming each transmission model. Symbol colours represent levels of the sparking rate, a. The mean delay was < 10 years for most of the parameters tested, which fall into the gray shaded rectangle. The lower panel is the same data but with axes adjusted to zoom in on the shaded rectangle in the upper panel. Departures from the 1:1 line show that mean delay is generally lower with frequency-dependent than with density-dependent transmission. Figure S3 : Recursive partitioning of the Kullback-Leibler (KL) divergence, representing the amount of information lost (in bits) when approximating the analytic distribution of bifurcation delay with that of the stochastic simulations. Each node of the partition tree has a label identifying the split, or inequality, implemented at that level, the sample size of observations, and the mean KL divergence at that level; branches extending to the left of each node satisfy the inequality (i.e. "yes"), those to the right do not ("no"). Thus, the first node in panel a gives the mean KL divergence (0.085 bits) of all 7200 simulations. Further nodes and branches detail the life history parameter combinations that give rise to the greatest KL divergence. "interval" refers to the infectious period of the simulated pathogen (in days), and is the reciprocal of the recovery rate, gamma. "xi" is the spontaneous rate of infection from outside the population, and "N" is the initial population size. Panel a shows the recursive partitioning tree based on life history parameters N, gamma, alpha, and xi (denoted N 0 , γ, α, and ξ in-text), which explains 66.7% of variance in KL divergence. Panel b shows the tree based on the sparking and sweep rates, which explains 78% of variance in KL divergence.