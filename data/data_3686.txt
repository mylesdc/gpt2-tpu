This paper investigates the dynamics of infectious diseases with a nonexponentially distributed infectious period. This is achieved by considering a multistage infection model on networks. Using pairwise approximation with a standard closure, a number of important characteristics of disease dynamics are derived analytically, including the final size of an epidemic and a threshold for epidemic outbreaks, and it is shown how these quantities depend on disease characteristics, as well as the number of disease stages. Stochastic simulations of dynamics on networks are performed and compared to output of pairwise models for several realistic examples of infectious diseases to illustrate the role played by the number of stages in the disease dynamics. These results show that a higher number of disease stages results in faster epidemic outbreaks with a higher peak prevalence and a larger final size of the epidemic. The agreement between the pairwise and simulation models is excellent in the cases we consider.
Mathematical models of infectious diseases are known to provide an invaluable insight into the mechanisms driving disease invasion and spread. In many cases, to obtain the first approximation of the spread of a disease, it is sufficient to use a version of the classical SIR model (Kermack and McKendrick 1927) . However, major outbreaks of avian and swine influenza (Ferguson et al. 2006) , SARS and, more recently, Ebola (Chowell and Nishiura 2014) have highlighted the need for a more accurate description of the disease dynamics that would provide predictive power to be used for developing measures for disease control and prevention (Keeling and Rohani 2008) .
One of the major simplifying assumptions often used in mathematical models of disease dynamics is the exponential distribution of infectious periods. Effectively, this means that the chance of an individual recovering during any given time period does not depend on the duration of time that individual has already been infected. Whilst such an assumption may provide significant mathematical convenience and be reasonably realistic in some situations, most often it is violated, and this requires the inclusion of the precise distribution of infectious periods in the model (Bailey 1954; Hope-Simpson 1952) . There are several methods that can be employed to explicitly include a non-exponential distribution, including a multi-stage approach (Anderson and Watson 1980; Cox and Miller 1965) , an integro-differential formulation (Kermack and McKendrick 1927; Hethcote and Tudor 1980; Keeling and Grenfell 1997) and a PDE-based formulation akin to that for age-structured models (Anderson and May 1992) . In the multi-stage framework, it is assumed that the infectious stage of a disease is characterised by a number K of distinct stages (Cox and Miller 1965; Lloyd 2000 Lloyd , 2001 , with the duration of each stage being an independent exponentially distributed random number. Due to the fact that the sum of independent exponentially distributed random variables obeys a gamma distribution (Durrett 2010) , one can replace an exponential distribution with the mean infectious period 1/γ by a gamma distribution Γ (K , 1/(K γ )) that has the same mean infectious period 1/γ . The so-called linear chain trick (Cox and Miller 1965; MacDonald 1978) then consists in replacing a single infectious stage with K identical exponentially distributed sub-stages, each having a mean period 1/(K γ ). These multiple stages of infection can be used to represent periods of increased or decreased risk of transmitting the disease (Ma and Earn 2006) . The same approach can be extended to models with multiple classes (Keeling and Grenfell 2002; Nguyen and Rohani 2008) , as well as non-exponentially distributed latency and temporary immunity periods (Blyuss and Kyrychko 2010; Wearing et al. 2005) . Following the methodology of introducing multi-stage of infection to better represent the distribution of infectious periods, we proceed with dividing the infected population into K identical stages I 1 , I 2 , . . . , I K to create the so-called S I K R model (Lloyd 2000) , and we denote the total infected population by I = K i=1 I i . One should note that K γ is now used as the transition rate between successive infectious stages in order to keep the average duration of infection as 1/γ . With these notations, the S I K R model takes the form dS/dt = −β S I,
. . . Keeling and Rohani (2008) , Cauchemez et al. (2004) Smallpox 0.49 8.6 4 Ferguson et al. (2003) , Koplan et al. (1978) where S denotes the proportion of susceptible individuals, R is the proportion of recovered or removed individuals, β is the disease transmission rate taken to be the same for all stages of infection, and the disease is assumed to confer a lifelong immunity. The importance of including not just the mean infectious period, but the actual distribution of infectious periods, as achieved by the system (1) is further highlighted by the inspection of actual values of epidemiological parameters for several real diseases as presented in Table 1 . This table illustrates that whilst the transmission rate and the average infectious period may vary between different diseases, in all of these cases the number of stages that has to be included in order to correctly represent the disease dynamics may also be quite high, and this reinforces an earlier observation about the non-exponential nature of infectious period distribution. Whilst this method of introducing multiple stages of infection is clearly more realistic, the assumption of a homogeneous fully mixed population remains very important, having significant effects on the disease dynamics (Keeling and Rohani 2008) . Although this assumption often provides a good approximation that helps reduce complexity of the model, in many cases it is just not realistic and results in erroneous conclusions about the onset and development of epidemic outbreaks (Bansal et al. 2007; Burr and Chowell 2008) . To address this issue, networks have been and are being used successfully to model the contact structure of the population to a high degree of detail (Danon et al. 2011; Keeling and Eames 2005) . Typically, network models are parameterised with empirical data or synthetic models that can be either purely theoretical, e.g. homogeneous random networks or Erdős-Rényi random graphs, or obey some widely observed network characteristics, such as a particular degree distribution or clustering. However, with added model realism comes complexity, which in the case of epidemic network models can be handled via mean-field models, such as pairwise models (Keeling 1999; House and Keeling 2011) that are able to better account for the explicit nature of network links. As long as such mean-field models provide a good approximation to the explicit stochastic network models, they open up the possibility to analytically compute important quantities such as epidemic threshold and final epidemic size. Thus, the explicit stochastic network simulation model and the pairwise model combine favourably to provide a more accurate model with some degree of analytical tractability.
In this paper we are concurrently relaxing the assumptions of homogeneous random mixing and exponentially distributed infectious periods to generate a multi-stage pairwise model for the spread of epidemics on networks. The paper is organised as follows. The next section contains a brief summary and discussion of earlier results on the properties of the S I K R model (1). In Sect. 3, we employ the framework of pairwise approximations to derive a multi-stage infection pairwise model and use this to derive analytical expressions for the probability of transmission of infection along an infected edge in a network, a threshold parameter controlling the onset of epidemic outbreaks and the final size of an epidemic. In Sect. 4, numerical simulations of the pairwise and the full network models are performed using realistic parameter values from Table 1 to investigate the accuracy of pairwise approximation and to illustrate the role played by the number of stages in the multi-stage distribution in the disease dynamics. The paper concludes in Sect. 5 with discussion of results and future outlook.
As a first step, we consider the S I K R model (1), which has an implicit assumption that every member of the population has a sufficient level of contact so that the infection can be passed from any individual to any other. This is a natural extension of the basic SIR model (Kermack and McKendrick 1927) , and as such, it has been well studied in a number of papers (Lloyd 2000; Ma and Earn 2006; Driessche and Watmough 2002) .
Perhaps, one of the most important and commonly used parameters characterising the severity of epidemics and stability of the disease-free equilibrium is the basic reproduction number R 0 defined as the expected number of secondary infections caused by a single typical infectious individual in a wholly susceptible population. The value of R 0 is related to the stability of the disease-free equilibrium, and it is an important threshold parameter signifying that an epidemic will spread when R 0 > 1 and die out otherwise.
The basic reproduction number for the system (1) can be found as follows (Hyman et al. 1999; Ma and Earn 2006; Driessche and Watmough 2002) 
which depends on the average duration of infection 1/γ but is independent of the number of stages in the model. A practically important characteristic of an epidemic outbreak is the final epidemic size (Keeling and Rohani 2008) . Since the total population size is closed with no inflow or outflow of individuals, i.e. S(t) + I 1 (t) + I 2 (t) + · · · + I K (t) + R(t) = 1, at the end of an outbreak, we have a burnout of the epidemic, i.e. I 1 = I 2 = · · · = I K = 0, and hence S(∞) + R(∞) = 1 and R(∞) = 1 − S(∞). This results in the following implicit equation for the final size of an epidemic that determines the proportion of individuals not affected by the disease (Anderson and May 1992; Heesterbeek 2000)
which coincides with the final epidemic size in the original SIR model (Kermack and McKendrick 1927) . Ma and Earn (2006) have recently discussed various aspects related to the derivation and validity of formula (3), and Andreasen (2011) Fig. 1 A comparison of infection dynamics for a one-, three-and five-stage S I K R models with data from Keeling and Rohani (2008) . Each curve represents the sum of all I i in the model. Adding extra stages causes epidemics to occur earlier and result in a higher peak of epidemic, although R 0 and the final size are identical for each curve. The parameter values are N = 1000, β = 1.66/day, γ = 0.4545/day the effects of population heterogeneity on the size of epidemic. A major implication of the above results is the fact that inclusion of possibly more realistic gamma distribution of infectious periods does not alter the threshold of an epidemic outbreak, nor does it affect the final epidemic size. One should note, however, that when a stochastic version of the S I K R model is considered, the number of stages influences the distribution of final epidemic sizes, whilst the average final size remains the same (Black and Ross 2015; House et al. 2013) . We see that in Fig. 1 the three curves show that considering multi-stage infectious periods has a significant effect of the dynamics of the epidemic. In order to get a better understanding of the distinction in the dynamics of SIR and S I K R models, it is therefore instructive to look at the development of epidemics. In the standard SIR model, an outbreak can only take place if R 0 > 1, and at the initial stage, the number of infected individuals can be approximated as I (t) ≈ I (0) exp(λt), where the growth rate is λ = γ (R 0 − 1). In the case of a multi-stage S I K R model, however, the basic reproduction number R 0 does not depend on the number of stages; hence, it cannot by itself be used to determine the exponential growth rate during an early stage of an outbreak. For this model, Wearing et al. (2005) have derived the following relation between the basic reproduction number R 0 and the initial growth rate λ
(4) Figure 2 illustrates early dynamics of epidemic outbreaks for different numbers of stages; in each case, an exponential curve was fitted, which provides an accurate approximation for the initial growth rate of the infection as determined by Eq. (4). This figure shows the effects of the gamma distribution on the early growth rate, peak prevalence and overall time frame of the disease, and it also suggests that the largest effect of the gamma distribution on the disease dynamics occurs during intermediate stages of disease progression. Besides the basic reproduction number, final epidemic size and the initial growth rate of an epidemic, another practically important characteristic of epidemic outbreaks is the peak prevalence defined as the maximum number or proportion of infected individuals that can be achieved during an outbreak. In the case of an SIR model, the peak prevalence can be found as follows (Feng 2007; House and Keeling 2011 )
Feng (2007) has recently considered an SEIR model with gamma-distributed infectious period and derived an expression for the peak of a weighted average of infectious compartments. This result gives some intuition into how the number of stages affects peak prevalence, but it does not provide a closed form expression for the actual peak prevalence in an S I K R model. Numerical results in Fig. 2 suggest that for the same average infectious period, the overall peak prevalence increases with the number of stages included in the model.
Inclusion of multiple stages of infection in the S I K R model gives a more realistic representation of the infectious period, but the model still has certain limitations due to its underlying assumptions. In the model (1), it is assumed that the disease is not fatal and that transitions between different infected classes, or stages of infection, take place at exactly the same rate K γ . Another major assumption behind model (1) is that the population is well mixed, i.e. each individual has equal chances of encountering and transmitting a disease to any other individual in a population. Whilst this may be appropriate in the case of outbreaks in small closed communities, for a large number of communicable diseases, such as SARS, influenza and most sexually transmitted infections, this assumption is a gross simplification of the actual dynamics as it overlooks spatial variability, as well as the complexities of a network structure for infections that are transmitted through direct close contact between individuals (House and Keeling 2011; Keeling and Eames 2005) .
Modelling complex contact patterns explicitly via networks has had a profound effect on mathematical epidemiology. This new modelling framework has led to a myriad of models ranging from exact to mean-field and simulation models (Pastor-Satorras et al. 2014; Danon et al. 2011; Keeling and Eames 2005; Newman 2003; Boccaletti et al. 2006) . The many degrees of freedom in modelling offered by networks, however, often comes at the price of increasing levels of complexity, where models can be challenging to evaluate analytically and sometimes even numerically. Nevertheless, many valuable paradigm models have been developed which have furthered our understanding of the impact of contact heterogeneity, preferential mixing and clustering on the outbreak threshold and other epidemic descriptors. A particularly useful way of capturing epidemic dynamics on networks is by using the pairwise model (Keeling 1999) . This model is based around deriving in a hierarchical way evolution equations for the expected number of nodes, edges, triples and so on. A closure is then employed that curtails the dependence on ever higher-order moments. Its premise is simple and quite intuitive, although it can be also shown rigorously (Taylor et al. 2012 ) that pairwise models before closure are exact. The basic idea of the model is to recognise that changes at node level depend on the status of the neighbours and thus involves edges, e.g. the rate of change in the number of infectious nodes is proportional to the number of S−I links in the network. Similarly, the number of edges can change due to pair interactions and transitions but also due to interactions induced from outside the edge, e.g. the number of S−S links decrease proportionally to the number of S−S−I triples, where infection from the I node destroys the fully susceptible pair. This framework has been used and extended extensively, to asymmetric (Sharkey et al. 2006 ) and weighted networks (Rattana et al. 2013) for example, and has proved to be a valuable framework.
As a first step in the analysis of dynamics of multi-stage epidemics on networks, we reformulate the S I K R model using the framework of pairwise equations, which allows one to analyse the expected values for the number of nodes and links of each type as a function of time (Keeling 1999; House and Keeling 2011; Taylor et al. 2012) . The particular strength of pairwise models lies in their analytical tractability and the fact that they provide a more accurate description than well-mixed ODE models but do not go to the level of full individual-based stochastic simulations (House and Keeling 2011) . In this formalism of pairwise models, notations [X], [XY ] and [XYZ] are used to denote the expected numbers of individuals in state X , the expected number of links between nodes of type X and Y and the expected number of triples of the form X −Y −Z , respectively. More precisely, given a "frozen" network with nodes labels X , Y or Z and subscripts indicating nodes i, j and k, then j=1,2,.. .,N is the adjacency matrix of the network such that g ii = 0, g i j = g ji and g i j = g ji = 1 if nodes i and j are connected and zero otherwise. Moreover, X i returns one if node i is in state X and zero otherwise. The average degree of each node is denoted by n and the number of nodes in the network by N . The new pairwise S I K R model with a gamma-distributed infectious period can then be written as follows,
where τ = β/n is the transmission rate per link. Since we consider a closed population, this immediately implies (5) is not closed as additional equations describing the dynamics of triples are needed. To eliminate this dependence on higher moments and close the system, we will use the classical moment closure approximation which assumes that short loops and clusters are excluded from the network and that there is no correlation between nodes with a common neighbour (Keeling 1999) .
, for i = 1, . . . , K ,
, for i, j = 1, . . . , K .
Applying these closures to the system (5) makes it a self-consistent system of (2K +2) equations.
When one considers a stochastic network-based simulation, an important quantity characterising the disease dynamics is the probabilityτ of disease transmission across a given S−I link. In a simple one-stage model, where both infection and recovery are assumed to be distributed exponentially, the probability of no infection event occurring during time t is given by p 0 (t) = e −τ t ; hence, 1− p 0 (t) is the probability that infection does take place over the same time period. Averaging this via integration for all possible recovery times yields the probability that the susceptible node becomes infected. In a standard SIR model with exponentially distributed infectious and recovery period, this probability is therefore (Danon et al. 2011; Diekmann et al. 1998 )
In the case of an S I K R model, the duration of infection is described by the density function of the appropriate gamma distribution
The implication of this fact is the following result for the probability of transmission across an edge. (8), the probability of disease transmission across a given S−I link is given byτ
The proof of this lemma is given in "Appendix 1". By rewriting expression (9) in the form
and using the fact that e x = lim n→∞ (1 + x/n) n , it follows that the increasing number of stages K , it eventually saturates at a level determined by Eq. (10). In fact, this saturation at higher K is observed not only in the probability of transmission, but also in the peak prevalence rate, as well as in the early growth rate. When compared to an exponential distribution, it is these substantial changes inτ observed for smaller values of K that explain the changes in the profile of the infection curves. As will be shown later,τ is a very important quantity that controls various properties of epidemic dynamics, such as the threshold for an outbreak and the final size of an epidemic.
Unlike epidemic models in well-mixed populations, defining an appropriate R 0 for pairwise models is more challenging. This is in part due to the difficulty of identifying the typical infectious individual. In order to derive a value for R 0 , one needs to consider and correctly account for the correlation between susceptible and infected nodes and measure R 0 when this has stabilised, see Keeling (1999) and Eames (2008) . Intuitively, this means that the epidemic is allowed to spread in order to become established in the network. This allows for typical infectious individuals to develop and for R 0 to be measured. In large networks, this regime can still be considered to be close to or only a small perturbation away from the disease-free steady state.
We now proceed to derive an R 0 -like threshold parameter R which can be used to predict when the epidemics occur, by allowing outbreaks only when R > 1 (Rattana et al. 2013) . To this end, we linearise the model (5) with a classic closure (6) near the disease-free equilibrium which has the form [S] = N , [SS] = n N , and all other quantities being zero. As in the standard approach, the condition necessary for the initial growth of an epidemic is that the dominant eigenvalue λ max of the resulting characteristic polynomial is real and positive, and a threshold parameter is obtained as a condition on system parameters that ensure the stability change, i.e. λ max = 0. In the "Appendix 2" it is shown that the characteristic equation for eigenvalues λ of the linearised system near the disease-free steady state for a K -stage model (5) is given by
In "Appendix 2" we prove that the largest eigenvalue λ satisfying this equation goes through zero, i.e. λ max = 0, when
This defines a new R 0 -like threshold parameter withτ introduced in (9). A closer inspection shows that this parameter R describes the probability of spreading the disease across a given link multiplied by the likely number of susceptible contacts of the individual assuming that they are the earliest people being infected, which perfectly agrees with the standard definition of R 0 as the average number of secondary cases produced in a fully susceptible population by a single typical infectious individual. Whilst R does not quantify the early growth rate of an epidemic, through its dependence onτ and K , it allows one to better predict epidemic outbreaks in the case of a more realistic gamma distribution of infectious period, where in the case of an exponential distribution with the same mean infectious period. We also note that whilst in the implementation of the classic S I K R model there was no effect of changing the number of stages on R 0 , and this more sophisticated model results in a threshold which implicitly accounts for multi-stage infectious periods.
Since the pairwise model (5) is a network representation of an epidemic with lifelong immunity and fixed population size, eventually an epidemic will burn out, leaving some proportion of the population unaffected and still susceptible to the disease. Since (5) with the classical closure (6) is given by
where
andτ is defined in (9).
Proof To prove this statement, we extend the methodology developed by Keeling (1999) for one-stage epidemics. We first introduce some new variables and parameters
and
From (5) and the easily derived functioṅ
it follows that these new variables satisfy the following system of equationṡ
Since (15) gives
where in the last step we have used the fact that G(0) = 0 and the relation
derived in "Appendix 3" together with another relation
Substituting these two relations into Eq. (16) and using the fact that [S](0) = N yields
Introducing the fraction of susceptible individuals as S ∞ = [S] ∞ /N , the above equation can be rewritten as follows,
or alternatively, as another implicit equation for S ∞
Since [I ] i (∞) = 0, introducing R ∞ = [R] ∞ /N yields the desired expression for the final size of an epidemic
Using the fact that θ = S a ∞ , Eq. (19) can be rewritten in the form
where in the last step we have used the relation a = (n − 1)/n. This completes the proof.
We note that our result in Theorem 1 is functionally identical to the result achieved by Keeling (1999) , and it generalises the final size equation by replacing τ/(τ + γ ) with the parameterτ . In the case K = 1 these two values are equivalent, and thus, we have perfect agreement with the existing theory. Equivalent relations have also been derived by Newman (2002) using percolation theory. Those results were later corrected and shown to hold in all cases where the distribution of infectious periods is degenerative (Kenah and Robins 2007 ). An equivalent relation has been derived for a static configuration network model with an arbitrary degree distribution (Miller 2012) . Figure 4 illustrates Theorem 1 by showing how the final size of an epidemic on a network depends on the number of infectious stages and, hence, the shape of the distribution of infectious period, which makes it different from earlier analytical results for a well-mixed population (Ma and Earn 2006) . This suggests that inclusion of a more realistic population structure has effect not only on the intermediate disease dynamics, but also on the final proportion of the population that will be affected by the disease. Furthermore, this figure suggests that for the same mean infectious period, the final size of an epidemic is increasing with the increasing number of stages K . One should note that the number of stages K has the largest effect on the final size of an epidemic for sufficiently low values of K , and then, this dependence saturates. . Circles correspond to integer values of K on each curve. The case n = 2 is used solely for illustrative purposes, as the resulting networks would be disconnected and thus inappropriate for direct comparison to results from the pairwise model As expected, the average node degree n plays an important role, with the minimum value of τ or K required for an epidemic outbreak decreasing with increasing n in perfect agreement with an earlier result in Eq. (11). Stochastic simulations (not shown) demonstrate excellent agreement with the results in Fig. 4 , especially for denser networks. The conclusions of Theorem 1 highlight the importance of collecting accurate and reliable data about the infectivity profile of a disease for predicting the scale of an outbreak.
It is worth noting that whilst the final size depends on the distribution of the infectious period, this dependence is not necessarily unique. This means that two different distributions of infected periods can provide the same transmissibilityτ , resulting in the same final epidemic size in accordance with Theorem 1 but having different intermediate dynamics of infection, as illustrated in Fig. 5 . The consequence of this observation is that although the epidemic threshold and final epidemic size can both be accurately computed using an estimate for the transmissibility of the disease (Newman 2002) , it is not sufficient to correctly predict the dynamics of the infection spreading process over time, which can be done with our model. 
In order to test the accuracy of the pairwise model (5) and to illustrate the role played by the distribution of infectious period, we consider the examples of outbreaks of several diseases mentioned in Table 1 in a population that is initially fully susceptible. We concentrate on two common and fairly simple network structures, namely homogeneous and Erdős-Rényi networks (Newman 2010) , with stochastic simulations being performed using a Gillespie algorithm (Gillespie 1977; Chen and Bokka 2005) . We restrict our attention to these network types as we have a homogeneous pairwise model and we would not expect it to work well for other networks. Following the derivation of the pairwise model, the per-link transmission rate is taken to be τ = β/n, and we now perform the comparison of an average of 250 stochastic outcomes of serious epidemics on a homogeneous and Erdős-Rényi networks against the results of a pairwise model with gamma-distributed infectious period. To highlight the impact of including a realistic distribution for the infectious period, we compare the results of simulations with realistic values of parameters from Table 1 against those obtained using an exponentially distributed infectious period as assumed in many existing models.
Severe acute respiratory syndrome (SARS) is a viral disease characterised by flu-like symptoms which is primarily spread through close contacts with infected individuals that makes it a perfect candidate for deducing some basic parameters from epidemiological observations. Figure 6 illustrates the comparison of SARS dynamics on homogeneous and Erdős-Rényi networks with a pairwise approximation. One can observe that the effects of including more stages in the disease model on intermediate behaviour are similar to those seen earlier, namely that gamma distribution of infectious period shortens the overall duration of an epidemic and increases peak prevalence. It is also worth noting that, in accordance with Theorem 1, the final size of an epidemic also increases with K .
The second example we consider is smallpox, a viral disease that has been eradicated globally except for two stocks kept in the secure laboratories and being used for further research. Several papers have modelled the effectiveness of smallpox when used as a bio-weapon, as well strategies for its containment during possible outbreaks (Ferguson et al. 2003; Kaplan et al. 2002; Meltzer et al. 2001 ). Due to a profound impact smallpox has had on a human population over several centuries, an extensive and quite accurate data have been collected about its transmission. Smallpox is spread through a contact with the mucus of an infected individual, which implies that a close contact is essential for a successful disease transmission. In Fig. 7 , we show the simulations of smallpox outbreaks on homogeneous and Erdős-Rényi networks using parameter values from Table 1 compared to results of the numerical solution of the corresponding pairwise model (5). The first important observation that the higher severity of epidemics outbreaks as suggested by these data makes the pairwise which is consistent with an earlier observation that the effect of increasing the number of stages on the final epidemic size is less noticeable for higher K . Figure 8 illustrates the comparison of a pairwise model (5) with the closure (6) and a stochastic simulation on the example of influenza data with different number of stages of infection. Comparison of figures (a) and (b) shows that the heterogeneity introduced by the degree distribution makes the pairwise model less accurate due to the fact that this model only takes into account the mean degree n. This suggests that whilst our model is very helpful for understanding general features of multi-stage disease dynamics on networks, it has to be extended further to deal effectively with wider and more realistic node degree distributions. One should note that the effects of increasing the number of stages on peak prevalence and the duration of epidemics reduce for higher values of K , as can be observed by comparing the minor changes between temporal profiles of the three-and five-stage influenza epidemics presented as shown in Fig. 8 .
In this paper we have analysed the behaviour of multi-stage infections with particular emphasis on contact networks. Unlike the well-mixed models, for which the number of stages modifies the temporary profile of an outbreak but does not affect the final epidemic size or the condition for disease outbreak, in the case of disease spread on a network, the number of stages, i.e. the precise distribution of infectious period, plays a much more prominent role.
In order to make analytical progress with the analysis of disease dynamics on networks, we have employed the framework of pairwise approximation. This has allowed us to determine the probability of disease transmission across a network edge and to find an R 0 -like threshold that controls the onset of epidemics. We have also derived an analytical expression for the final size of an epidemic, which is in perfect agreement with the final size computed using percolation theory (Newman 2002; Kenah and Robins 2007) , and therefore, our findings can be considered exact in the limit of infinite population size. All of these quantities depend not only on the basic disease characteristics, such as the transmission rate and the average infectious period, but also on the distribution of the infectious period as represented by the number of stages in the model. The importance of this result lies in the fact that unlike earlier studies of multi-stage models in well-mixed populations (Anderson and Watson 1980; Ma and Earn 2006) , for the same average duration of the infection period, the final epidemic size is not constant but increasing with the number of stages. We also observe that the threshold at which point a major epidemic is expected depends on the number of infectious stages, with epidemics becoming more likely as the number of stages is increased. This dependence emerges due to the higher resolution of our model which allows us to identify new links between model ingredients and disease dynamics. Similar results have been noted in related studies, for example, in models concerned with contact tracing (Eames and Keeling 2003) and models of coupled disease and information transmission on networks (Funk et al. 2009 ).
Numerical simulations of epidemic outbreak for several different multi-stage infections demonstrate that whilst the pairwise model provides a reasonably good approximation of the network dynamics, the agreement with stochastic simulations is affected by clustering and local network structure that can induce correlations in the dynamics of different nodes, as well as the inhomogeneity in the node degree distribution, as should be expected from the fact that the pairwise closure only depends on the average node degree.
There are several directions in which the approach presented in this paper could be extended. These include the analysis of SIS and SEIR models, as well as inclusion of multiple stages for both the latent and infected classes (Nguyen and Rohani 2008) . Whilst inclusion of latent classes may have no effect on the basic reproduction number or the final size distribution in a homogeneous model (Black and Ross 2015; House et al. 2013) , whether the same would be true in a network model remains to be seen. Another interesting and important problem would be the consideration of network dynamics for epidemic models with temporary immunity (Blyuss and Kyrychko 2010) . Allowing the level of infectiousness of different nodes to vary depending on the stage of infection they belong to would result in even more realistic models of multi-stage diseases on networks. One of the challenging but practically important generalisations of the present framework would be an extension of a pairwise model that would account for heterogeneity in node degree distribution (House and Keeling 2011) . This would provide deterministic models potentially amenable to analytical treatment that would more accurately represent stochastic disease dynamics.
Linearisation of the pairwise model (5) with the closure (6) at the disease-free equilibrium yields the stability condition for eigenvalues λ as a (2K + 2) × (2K + 2) matrix. It is useful to first consider it in a block form as follows,
where C is a zero (K + 1) × (K + 1) matrix, and the matrix A is lower diagonal, and therefore, its determinant is the product of the diagonal terms. Hence, the characteristic equation can be written as
This matrix can now be reduced to a series of lower diagonal matrices to give the following general form of the characteristic equation
It immediately follows that the above equation has roots of λ = 0, λ = −K γ , and the other K roots are determined by the roots of the expression in curly brackets. Since an epidemic outbreak occurs when the disease-free equilibrium becomes unstable, one has to identify conditions on parameters when the stability of the disease-free steady state changes, i.e. where λ = 0. Substituting λ = 0 into the expression in curly brackets yields
This relation can be recast as 1 = (n − 1) 1 − (K γ ) K (τ + K γ ) K = (n − 1)τ , which gives the desired expression of R = (n − 1)τ in Eq. (11).
To prove relation (17), we consider the time derivatives of the functions P i = [S I i ] [S] a for i = 1, 2, . . . , K , which can be found from the pairwise model (5):
[S] F, P i = −(τ + K γ )P i + K γ P i−1 , i = 2, 3, . . . , K .
We also remind the reader of the functions G and L and equations for their dynamics 
In a similar way, integrating the equation for P 2 yields 0 = ∞ 0Ṗ 2 dt = −(τ + K γ )
which can be rewritten as
Proceeding the same way, one obtains ∞ 0 P i dt = τ + K γ K γ ∞ 0 P i+1 dt, i = 2, 3, . . . , K − 1.
Going through all stages of infections, we find
On the other hand, integrating equation for G and using G(0) = 0 gives
Combining the last two expressions, we obtain
and substituting this result into Eq. (21) gives the final relation (17):
In order to prove relation (18) 
Rather than computing the integral in the right-hand side of the above equation, we use the first equation of the pairwise model (5), which can be written as
Using this expression to replace an integral in (23) 