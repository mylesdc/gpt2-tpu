Within the ABC-SMC approach [1], particles are first generated from the prior distribution. Particles are then resampled from the obtained sample, and slightly perturbed. From these resampled particles, a new sample is formed, from which again particles are resampled, etc.
Within the ABC-SMC approach [1] , particles are first generated from the prior distribution. Particles are then resampled from the obtained sample, and slightly perturbed. From these resampled particles, a new sample is formed, from which again particles are resampled, etc.
The threshold value for the summary statistic -below which new particles are accepted -is lowered with every newly obtained sample. As a result, the acceptance rate decreases and the acceptance threshold approaches zero with an increase in the number of iterations (resamplings).
Initial -values were estimated as follows. We generated 100 trees and we calculated the summary statistics (indices) and used the standard deviation of this distribution as the initial values. The -values were decreased in an exponential fashion as the sequential ABC scheme progresses.
• Set the population indicator t = 1
• Set the particle indicator i = 1
Sample θ from the previous population {θ(m ) t−1 } with weights w t−1 . Perturb the particle, θ ∼ KP t,m (θ|θ ) where KP t,m is the particle perturbation kernel. If π(m , θ ) = 0, repeat this step. Simulate a candidate dataset x ∼ f (x|m , θ ) If ρ(x , y) > repeat this step.
• Normalize the weights. Obtain the marginal model probabilities given by
The algorithm was implemented in R [2] using the parallel package. The code is available by the authors under request. In the main manuscript ("ABC inference on transmission network type" in the Results section) we report the performance of the ABC-SMC algorithm on 100 simulated viral genealogies for each network type of size 1000. Here, in order to illustrate the scalability of the ABC-SMC algorithm and its computational cost, we repeated the same simulation study on 100 simulated viral genealogies for each network type of size 2000 and 3000.
The same parameters, prior distributions and tolerance levels were chosen for comparability. We record the number of times that the true model has the highest posterior model probability P (M |D) among the three models for the 100 simulated datasets. The obtained posterior model probabilities were consistent with the case of networks of size 1000. Results are shown in Table 1 and Table 2 for networks of sizes 2000 and 3000, respectively.
We also report the computational time required on a parallel implementation on an IntelCore i7-4770S 3.10 GHZ 8-core processors (Table 3) . 